System.register("chunks:///_virtual/AD_SDK.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalFun.ts"],(function(t){var n,e,o,r,i,a;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator,r=t.Component},function(t){i=t.em},function(t){a=t.glf}],execute:function(){var c;e._RF.push({},"7b3a5gFIv9F5YMt4WSduB3t","AD_SDK",void 0);var s=o.ccclass;o.property,t("AD_SDK",s("AD_SDK")(c=function(t){function e(){return t.apply(this,arguments)||this}n(e,t);var o=e.prototype;return o.onDestroy=function(){i.remove("createPlayADEvent"),i.remove("directPlayAD")},o.onLoad=function(){i.add("createPlayADEvent",this.createPlayADEvent.bind(this)),i.add("directPlayAD",this.directPlayAD.bind(this))},o.createPlayADEvent=function(t,n){a.createButton(this.node,t,"AD_SDK","onBtnShowADs"+n)},o.onBtnShowADsGameMonetize=function(){"undefined"!=typeof sdk&&"undefined"!==sdk.showBanner&&sdk.showBanner()},o.directPlayAD=function(t){this["onBtnShowADs"+t]()},e}(r))||c);e._RF.pop()}}}));

System.register("chunks:///_virtual/AudioManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts"],(function(e){var i,t,a,n,o,r,u,s,l,c,d;return{setters:[function(e){i=e.applyDecoratedDescriptor,t=e.inheritsLoose,a=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){o=e.cclegacy,r=e._decorator,u=e.AudioClip,s=e.AudioSource,l=e.game,c=e.Component},function(e){d=e.em}],execute:function(){var h,m,f,p,y,g,b,A,P;o._RF.push({},"35f94alQIRIZaEOuFj6CMh/","AudioManager",void 0);var v=r.ccclass,M=r.property;e("AudioManager",(h=v("AudioManager"),m=M(u),f=M(s),p=M(s),h((b=i((g=function(e){function i(){for(var i,t=arguments.length,o=new Array(t),r=0;r<t;r++)o[r]=arguments[r];return i=e.call.apply(e,[this].concat(o))||this,a(i,"mainBGM",b,n(i)),a(i,"bgmPlayer",A,n(i)),a(i,"effectPlayer",P,n(i)),i}t(i,e);var o=i.prototype;return o.onDestroy=function(){d.remove("switchMainBgm"),d.remove("playOneShot"),d.remove("muteAudio"),d.remove("resumeAudio")},o.onLoad=function(){d.add("switchMainBgm",this.switchMainBgm.bind(this)),d.add("playOneShot",this.playOneShot.bind(this)),d.add("muteAudio",this.muteAudio.bind(this)),d.add("resumeAudio",this.resumeAudio.bind(this)),l.addPersistRootNode(this.node)},o.start=function(){this.switchMainBgm("/audio/music/刀剑如梦")},o.switchMainBgm=function(e){var i=this;this.bgmPlayer.stop(),d.dispatch("loadTheDirResources",e,(function(e){i.bgmPlayer.clip=e,i.bgmPlayer.play()}))},o.playOneShot=function(e){var i=this;d.dispatch("loadTheDirResources","/audio/effect/"+e,(function(e){i.effectPlayer.playOneShot(e)}))},o.muteAudio=function(){this.effectPlayer.mute=!1,this.bgmPlayer.mute=!1},o.resumeAudio=function(){this.effectPlayer.mute=!0,this.bgmPlayer.mute=!0},i}(c)).prototype,"mainBGM",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=i(g.prototype,"bgmPlayer",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=i(g.prototype,"effectPlayer",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=g))||y));o._RF.pop()}}}));

System.register("chunks:///_virtual/BlackHole.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalData.ts","./EnemySkill.ts"],(function(t){var o,e,n,a,i,l,c,r;return{setters:[function(t){o=t.inheritsLoose},function(t){e=t.cclegacy,n=t._decorator,a=t.CircleCollider2D,i=t.Contact2DType},function(t){l=t.em},function(t){c=t.tagData},function(t){r=t.EnemySkill}],execute:function(){var s;e._RF.push({},"983ef2TfytMIbhvzd5+h4RV","BlackHole",void 0);var h=n.ccclass;n.property,t("BlackHole",h("BlackHole")(s=function(t){function e(){for(var o,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(o=t.call.apply(t,[this].concat(n))||this)._touchHero=!1,o._attackInterval=.05,o._gravitationSpeed=100,o}o(e,t);var n=e.prototype;return n.init=function(){this._damage=1,this._skillName="blackHole",this._duration=15,this.initCircleCollider(),this.node.getComponent(a).on(i.END_CONTACT,this.onEndContact,this)},n.onBeginContact=function(t,o){var e=this;console.log("onBeginContact black hole"),o.tag===c.hero&&(this._touchHero=!0,this.scheduleOnce((function(){e.heroInBlackHole(o)}),this._attackInterval),console.log("进入黑洞"))},n.onEndContact=function(t,o){console.log("离开黑洞"),this._touchHero=!1},n.heroInBlackHole=function(t){var o=this;if(console.log("heroInBlackHole"),this._touchHero){var e=this.node.getWorldPosition(),n=l.dispatch("getHeroWorldPos"),a=e.x-n.x,i=e.y-n.y,c=Math.sqrt(a*a+i*i),r=0==a?0:this._attackInterval/(c/this._gravitationSpeed)*a,s=0==i?0:this._attackInterval/(c/this._gravitationSpeed)*i;t.node.parent.setWorldPosition(n.x+r,n.y+s,n.z),l.dispatch("usingHeroControlFun","updateBloodProgress",-this._damage),this.scheduleOnce((function(){o.heroInBlackHole(t)}),this._attackInterval)}},e}(r))||s);e._RF.pop()}}}));

System.register("chunks:///_virtual/Boss.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalData.ts","./MonsterData.ts"],(function(t){var o,e,i,s,n,r,a,l,c,d,h,u,p,_,g,f;return{setters:[function(t){o=t.inheritsLoose},function(t){e=t.cclegacy,i=t._decorator,s=t.Sprite,n=t.Animation,r=t.BoxCollider2D,a=t.UITransform,l=t.Size,c=t.Contact2DType,d=t.Component},function(t){h=t.em},function(t){u=t.tagData,p=t.groupIndex,_=t.ggd,g=t.attackInterval},function(t){f=t.monsterData}],execute:function(){var m;e._RF.push({},"ef2f9haQTxL5Jy9QffrqzGj","Boss",void 0);var B=i.ccclass;i.property,t("Boss",B("Boss")(m=function(t){function e(){for(var o,e=arguments.length,i=new Array(e),s=0;s<e;s++)i[s]=arguments[s];return(o=t.call.apply(t,[this].concat(i))||this)._isTouchHero=!1,o._isTouchFriend1Skill1=!1,o._isTouchSpell=!1,o._normalDamage=99,o._sprite=void 0,o._bloodSprite=void 0,o._bossId=void 0,o._rawSpeed=void 0,o._curSpeed=void 0,o._canMove=!0,o._isInitData=!1,o._maxBlood=0,o._curBlood=0,o}o(e,t);var i=e.prototype;return i.initBossInfo=function(t){this._sprite=this.node.getChildByName("sprite"),this._bloodSprite=this.node.getChildByName("bloodProgressBg").getChildByName("bloodProgress").getComponent(s),this._bossId=t.id,this._rawSpeed=t.moveSpeed,this._curSpeed=t.moveSpeed,this._canMove=t.canMove,this._maxBlood=t.maxBlood,this._curBlood=t.maxBlood,this._normalDamage=t.normalDamage,this.initBossMoveAnim(t.id),this.updateBlood(0),this.initCollider(),this._isInitData=!0},i.initBossMoveAnim=function(t){var o=this;h.dispatch("loadTheDirResources","/anim/enemy/boss/boss_"+t+"_move",(function(t){o._sprite.getComponent(n).defaultClip=t,o._sprite.getComponent(n).play()}))},i.initCollider=function(){var t=this._sprite.addComponent(r),o=this._sprite.getComponent(a),e=new l(o.contentSize.x,o.contentSize.y);t.tag=u.boss,t.size=e,t.group=p.enemy,t.on(c.BEGIN_CONTACT,this.onBeginContact,this),t.on(c.END_CONTACT,this.onEndContact,this)},i.start=function(){this.checkupIsInitData()},i.checkupIsInitData=function(){if(!this._isInitData)throw"未初始化boss信息";console.log("初始化boss信息")},i.update=function(t){_.stopAll||(this.updateSpriteDirection(),this.moveToHero(t))},i.moveToHero=function(t){if(this._canMove){var o=h.dispatch("getHeroWorldPos"),e=this.node.getWorldPosition(),i=o.x-e.x,s=o.y-e.y,n=Math.sqrt(i*i+s*s);if(n>=f.minGapWithHero2){var r=n/this._curSpeed,a=t/r*i,l=t/r*s;this.node.setWorldPosition(e.x+a,e.y+l,0)}}},i.updateSpriteDirection=function(){var t=h.dispatch("getHeroWorldPos").x-this.node.getChildByName("sprite").getWorldPosition().x,o=this.node.getChildByName("sprite").getScale();t>0?this.node.getChildByName("sprite").setScale(-Math.abs(o.x),o.y,o.z):t<0&&this.node.getChildByName("sprite").setScale(Math.abs(o.x),o.y,o.z)},i.accelerateToHero=function(t){var o=this;this.scheduleOnce((function(){o._curSpeed=o._rawSpeed}),t)},i.onBeginContact=function(t,o){if(!_.stopAll)switch(o.tag){case u.hero:this._isTouchHero=!0,this.bossAttackHeroByCollider(t,o);break;case u.friend1Skill1:this._isTouchFriend1Skill1=!0,this.friendAttackBossByFriend1Skill1(t,o);break;case u.darts:this.heroAttackBossByDarts()}},i.onEndContact=function(t,o){switch(o.tag){case u.hero:this._isTouchHero=!1;break;case u.spell:this._isTouchSpell=!1;break;case u.friend1Skill1:this._isTouchFriend1Skill1=!1}},i.bossAttackHeroByCollider=function(t,o){var e=this;if(!_.stopAll&&this._isTouchHero){var i=this._normalDamage;h.dispatch("usingHeroControlFun","createBossDamageTex",-i);var s=g["boss"+this._bossId];this.scheduleOnce((function(){e.bossAttackHeroByCollider(t,o)}),s)}},i.friendAttackBossByFriend1Skill1=function(t,o){var e=this;if(!_.stopAll&&this._isTouchFriend1Skill1){h.dispatch("createDamageTex",t.node,5,{x:0,y:20}),this.updateBlood(-5,!1),this.collectToTarget(t,o),this.scheduleOnce((function(){e.friendAttackBossByFriend1Skill1(t,o)}),g.f1s1)}},i.heroAttackBossByDarts=function(){console.log("boss被飞镖攻击 还没写")},i.updateBlood=function(t,o){void 0===o&&(o=!1),this._curBlood+=t,this._curBlood<=0?(this.unscheduleAllCallbacks(),this.node.destroy(),_.stopAll=!0,h.dispatch("passStage")):o&&this.bossIsRepelled(),this._curBlood>this._maxBlood&&(this._curBlood=this._maxBlood),this._bloodSprite.fillRange=this._curBlood/this._maxBlood},i.getBloodPercentage=function(){return this._curBlood/this._maxBlood},i.bossIsRepelled=function(){var t=h.dispatch("getHeroWorldPos"),o=this.node.getWorldPosition();o.subtract3f(t.x,t.y,t.z).normalize();var e=this.node.getPosition();this.node.setPosition(e.x+20*o.x,e.y+20*o.y,0)},i.collectToTarget=function(t,o){if(o){var e=o.node.getWorldPosition(),i=t.node.getWorldPosition();e.subtract3f(i.x,i.y,i.z).normalize();var s=this.node.getPosition();this.node.setPosition(s.x+20*e.x,s.y+20*e.y,0)}},i.getDistanceToHero=function(){var t=h.dispatch("getHeroWorldPos"),o=this.node.getWorldPosition(),e=t.x-o.x,i=t.y-o.y;return Math.sqrt(e*e+i*i)},i.pauseAnim=function(){this._sprite.getComponent(n).pause()},i.resumeAnim=function(){this._sprite.getComponent(n).resume()},e}(d))||m);e._RF.pop()}}}));

System.register("chunks:///_virtual/Boss1.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalData.ts","./PoolManager.ts","./Boss.ts"],(function(e){var t,s,i,o,n,l,r,a,h,c,u,d,g,y;return{setters:[function(e){t=e.applyDecoratedDescriptor,s=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){n=e.cclegacy,l=e._decorator,r=e.Prefab,a=e.NodePool,h=e.find,c=e.Animation},function(e){u=e.em},function(e){d=e.ggd},function(e){g=e.plm},function(e){y=e.Boss}],execute:function(){var f,p,v,P,k;n._RF.push({},"128f5xC/PJCIZMOXP3duFW3","Boss1",void 0);var m=l.ccclass,B=l.property;e("Boss1",(f=m("Boss1"),p=B(r),f((k=t((P=function(e){function t(){for(var t,s=arguments.length,n=new Array(s),l=0;l<s;l++)n[l]=arguments[l];return t=e.call.apply(e,[this].concat(n))||this,i(t,"skillPrefab",k,o(t)),t._skillData={1:888,2:500,3:5e3,4:1500},t}s(t,e);var n=t.prototype;return n.onLoad=function(){g.addPoolToPools("greenThunder",new a,this.skillPrefab),this.initBossInfo({id:1,moveSpeed:200,canMove:!0,maxBlood:5e4,normalDamage:1500}),this.setBossStrategy()},n.usingSkillGreenThunder=function(){var e=g.getFromPool("greenThunder");e.getComponent("GreenThunder").init(this._skillData[1]);var t=u.dispatch("getHeroWorldPos");e.parent=h("Canvas/bulletLayer"),e.setWorldPosition(t.x,t.y+100,t.y)},n.usingSkillPhotosynthesis=function(e){var t=this;console.log("开启光合作用"),this.node.getChildByName("photosynthesis").active=!0,this.unschedule(this.recoveryHealthy),this.schedule(this.recoveryHealthy,1,e),this.scheduleOnce((function(){t.node.getChildByName("photosynthesis").active=!1}),e)},n.recoveryHealthy=function(){this.updateBlood(this._skillData[3])},n.bossAttackHeroByCollider=function(e,t){var s=this;if(!d.stopAll&&this._isTouchHero){u.dispatch("usingHeroControlFun","createBossDamageTex",-this._skillData[4]),this.usingNormalAttack();this.scheduleOnce((function(){s.bossAttackHeroByCollider(e,t)}),2)}},n.usingNormalAttack=function(){this._curSpeed=this._rawSpeed;var e=u.dispatch("getHeroWorldPos"),t=this.node.getWorldPosition(),s=e.x-t.x,i=e.y-t.y,o=0,n={x:50,y:0},l=1;Math.abs(s)>Math.abs(i)?s<0&&(o=180,n.x=-50,l=-1):i>0?(o=90,n.x=0,n.y=50):(o=270,n.x=0,n.y=-50);var r=this.node.getChildByName("attack");r.angle=o,r.setPosition(n.x,n.y),r.setScale(1,l),r.getComponent(c).play()},n.usingSkillGreenThunderAllTheTime=function(e){var t=this;this.schedule((function(){t.usingSkillGreenThunder()}),e)},n.setBossStrategy=function(){this.usingSkillGreenThunderAllTheTime(5),this.schedule(this.isUsingSkillPhotosynthesis,1),this.schedule(this.isAccelerateToHero,1)},n.isUsingSkillPhotosynthesis=function(){var e=this;this.getBloodPercentage()<.33&&(this.usingSkillPhotosynthesis(15),this.unschedule(this.isUsingSkillPhotosynthesis),this.scheduleOnce((function(){e.schedule(e.isUsingSkillPhotosynthesis,1)}),30))},n.isAccelerateToHero=function(){var e=this.getDistanceToHero();if(e>2e3){this._curSpeed=this._skillData[2];var t=e/this._curSpeed;this.accelerateToHero(t)}},t}(y)).prototype,"skillPrefab",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=P))||v));n._RF.pop()}}}));

System.register("chunks:///_virtual/Boss2.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalData.ts","./PoolManager.ts","./Queue.ts","./Boss1.ts"],(function(e){var o,t,s,n,i,r,l,a,u,c;return{setters:[function(e){o=e.inheritsLoose},function(e){t=e.cclegacy,s=e._decorator,n=e.NodePool,i=e.find},function(e){r=e.em},function(e){l=e.ggd},function(e){a=e.plm},function(e){u=e.Queue},function(e){c=e.Boss1}],execute:function(){var h;t._RF.push({},"38559Ai7QdNXJgmM17rYiRi","Boss2",void 0);var d=s.ccclass;s.property,e("Boss2",d("Boss2")(h=function(e){function t(){for(var o,t=arguments.length,s=new Array(t),n=0;n<t;n++)s[n]=arguments[n];return(o=e.call.apply(e,[this].concat(s))||this)._skillData={1:4444,2:600,3:2e4,4:5e3},o}o(t,e);var s=t.prototype;return s.onLoad=function(){a.addPoolToPools("greenThunder",new n,this.skillPrefab),this.initBossInfo({id:2,moveSpeed:250,canMove:!0,maxBlood:2e5,normalDamage:5e3}),this.setBossStrategy()},s.setBossStrategy=function(){this.usingSkillGreenThunderAllTheTime(2),this.schedule(this.isUsingSkillPhotosynthesis,1),this.schedule(this.isAccelerateToHero,1),this.schedule(this.usingSkillCollectionGT,10)},s.usingSkillCollectionGT=function(){var e=this;if(!l.stopAll){var o=20;if(o<=0)throw new Error("error");for(var t=new u;o>0;){var s=a.getFromPool("greenThunder");t.enqueue(s),o--}this.schedule((function o(){if(!l.stopAll){var s=t.dequeue();if(s){s.getComponent("EnemySkill").init(e._skillData[1]);var n=r.dispatch("getHeroWorldPos");s.parent=i("Canvas/bulletLayer"),s.setWorldPosition(n.x,n.y+100,n.y)}else e.unschedule(o)}}),.3)}},t}(c))||h);t._RF.pop()}}}));

System.register("chunks:///_virtual/Boss3.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalData.ts","./globalFun.ts","./PoolManager.ts","./Queue.ts","./Boss.ts"],(function(e){var t,o,a,r,i,s,n,l,c,u,d,h,g,f;return{setters:[function(e){t=e.inheritsLoose,o=e.createForOfIteratorHelperLoose},function(e){a=e.cclegacy,r=e._decorator,i=e.find,s=e.NodePool,n=e.Vec2,l=e.instantiate},function(e){c=e.em},function(e){u=e.ggd},function(e){d=e.glf},function(e){h=e.plm},function(e){g=e.Queue},function(e){f=e.Boss}],execute:function(){var P;a._RF.push({},"b6663v4MkRCBoa0Uv+wET6C","Boss3",void 0);var k=r.ccclass;r.property,e("Boss3",k("Boss3")(P=function(e){function a(){for(var t,o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))||this)._skillData={darkParticle:{name:"darkParticle",damage:9999,duration:3,moveSpeed:500},maxMS:800},t._darkParticlePrefab=void 0,t._darkMaskPrefab=void 0,t._blackHolePrefab=void 0,t}t(a,e);var r=a.prototype;return r.onLoad=function(){this.initBossInfo({id:3,moveSpeed:250,canMove:!1,maxBlood:2e6,normalDamage:8888}),this._darkParticlePrefab=i("/atom",this.node),this._darkMaskPrefab=i("/darkMask",this.node),this._blackHolePrefab=i("/blackHole",this.node),h.addPoolToPools("darkParticle",new s,this._darkParticlePrefab),h.addPoolToPools("blackHole",new s,this._blackHolePrefab),this.setBossStrategy()},r.setBossStrategy=function(){this.schedule(this.usingDarkParticleCircle,4),this.schedule(this.usingDarkMask,5),this.schedule(this.usingBlackHole,10),this.schedule(this.usingDarkParticleTriangle,3)},r.usingDarkParticleCircle=function(){console.log("释放黑暗粒子");for(var e=d.getCirclePos(100,20),t=0;t<20;t++){var o=h.getFromPool("darkParticle");o.active=!0,o.setPosition(0,0,0);var a=i("Canvas/bulletLayer");o.parent=a;var r=e[t],s={x:r[0]/100,y:r[1]/100},n=this.getFlyDir(s),l=this.node.getWorldPosition();l.x+=r[0],l.y+=r[1],o.setWorldPosition(l),o.getComponent("EnemySkill").init(this._skillData.darkParticle,n,.3)}},r.usingDarkParticleTriangle=function(){for(var e=this,t=this.getTriangleRow(5),a=new g,r=t.length-1;r>=0;r--){for(var s=t[r],n=[],l=0;l<s.length;l++){var c=s[l],d=h.getFromPool("darkParticle");d.active=!0,d.setPosition(0,0,0),d.initPos=c,n.push(d)}a.enqueue(n)}this.schedule((function t(){if(!u.stopAll){var r=a.dequeue();if(r)for(var s,n=i("Canvas/bulletLayer"),l=o(r);!(s=l()).done;){var c=s.value;c.parent=n;var d=e.getDirToHero(),h=e.getFlyDir(d),g=e.node.getWorldPosition();g.x+=c.initPos[0],g.y+=c.initPos[1],c.setWorldPosition(g),c.getComponent("EnemySkill").init(e._skillData.darkParticle,h,.3)}else e.unschedule(t)}}),.2)},r.getDirToHero=function(){var e=this.node.getWorldPosition(),t=c.dispatch("getHeroWorldPos"),o={x:0,y:0},a={x:t.x-e.x,y:t.y-e.y};if(0==a.x)o.x=0,o.y=Math.abs(a.y)/a.y;else if(0==a.y)o.x=Math.abs(a.x)/a.x,o.y=0;else{var r=Math.abs(a.x/a.y);r>=1?(o.x=Math.abs(a.x)/a.x,o.y=1/r*Math.abs(a.y)/a.y):(o.x=r*Math.abs(a.x)/a.x,o.y=Math.abs(a.y)/a.y)}return o},r.getTriangleRow=function(e){for(var t=0,o=0,a=[],r=0;r<e;r++){var i=r+1;a[r]=[];for(var s=0;s<i;s++)i%2==0?a[r].push([t+50*s-50*Math.floor(i/2)+25,o]):a[r].push([t+50*s-50*Math.floor(i/2),o])}return console.log("getTriangleRow2223333333333333332",a),a},r.getFlyDir=function(e){return new n(e.x,e.y)},r.usingDarkMask=function(){var e=l(this._darkMaskPrefab),t=c.dispatch("getHeroWorldPos");e.parent=i("Canvas/bulletLayer"),e.setWorldPosition(t.x,t.y,t.y),e.getComponent("DarkMask").init(),e.active=!0},r.usingBlackHole=function(){var e=h.getFromPool("blackHole"),t=c.dispatch("getHeroWorldPos");e.parent=i("Canvas/bulletLayer"),e.setWorldPosition(t.x,t.y,t.y),e.getComponent("BlackHole").init(),e.active=!0},r.isAccelerateToHero=function(){var e=this.getDistanceToHero();if(e>2e3){this._curSpeed=this._skillData.maxMS;var t=e/this._curSpeed;this.accelerateToHero(t)}},a}(f))||P);a._RF.pop()}}}));

System.register("chunks:///_virtual/Boss4.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PoolManager.ts","./Boss3.ts"],(function(o){var e,a,t,s,r,n,i;return{setters:[function(o){e=o.inheritsLoose},function(o){a=o.cclegacy,t=o._decorator,s=o.find,r=o.NodePool},function(o){n=o.plm},function(o){i=o.Boss3}],execute:function(){var l;a._RF.push({},"c4f9cQ1j5tAZrp9+Xp6yWpD","Boss4",void 0);var c=t.ccclass;t.property,o("Boss4",c("Boss4")(l=function(o){function a(){for(var e,a=arguments.length,t=new Array(a),s=0;s<a;s++)t[s]=arguments[s];return(e=o.call.apply(o,[this].concat(t))||this)._skillData={darkParticle:{name:"darkParticle",damage:22222,duration:4,moveSpeed:600},maxMS:1e3},e}return e(a,o),a.prototype.onLoad=function(){this.initBossInfo({id:4,moveSpeed:300,canMove:!0,maxBlood:4e6,normalDamage:11111}),this._darkParticlePrefab=s("/atom",this.node),this._darkMaskPrefab=s("/darkMask",this.node),this._blackHolePrefab=s("/blackHole",this.node),n.addPoolToPools("darkParticle",new r,this._darkParticlePrefab),n.addPoolToPools("blackHole",new r,this._blackHolePrefab),this.setBossStrategy()},a}(i))||l);a._RF.pop()}}}));

System.register("chunks:///_virtual/BossN.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalData.ts","./Boss.ts"],(function(e){var t,n,i,o,r,a,l,s,c,u,p,f,g,d,m,B,h,v,y,b,z;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,a=e._decorator,l=e.Prefab,s=e.Material,c=e.UITransform,u=e.Size,p=e.BoxCollider2D,f=e.instantiate,g=e.find,d=e.Vec3,m=e.tween,B=e.Sprite,h=e.Animation},function(e){v=e.em},function(e){y=e.tagData,b=e.groupIndex},function(e){z=e.Boss}],execute:function(){var C,M,x,D,S,w,F,P,I;r._RF.push({},"b92c4+RU/xDHIkDN0zTFqvV","BossN",void 0);var N=a.ccclass,k=a.property;e("BossN",(C=N("BossN"),M=k(l),x=k(s),D=k(s),C((F=t((w=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,i(t,"fireBall",F,o(t)),i(t,"defaultMaterial",P,o(t)),i(t,"fireBallMaterial",I,o(t)),t}n(t,e);var r=t.prototype;return r.onLoad=function(){var e=this,t=this.node.getComponent(c),n={size:new u(t.contentSize.x,t.contentSize.y),tag:y.boss,group:b.enemy};this.initBossInfo({id:1,moveSpeed:200,canMove:!1,maxBlood:1e4},n),this.schedule((function(){e.usingSkillFireBall()}),2),console.log("BoxCollider2D",this.node.getComponent(p))},r.usingSkillFireBall=function(){var e=this,t=f(this.fireBall);t.parent=this.node,t.active=!0,t.getComponent(p).tag=y.fireBall,t.parent=g("Canvas/bulletLayer");var n=this.node.getWorldPosition(),i=v.dispatch("getHeroWorldPos");t.setWorldPosition(n);var o=i.subtract3f(n.x,n.y,n.z).normalize(),r=new d(1e3*o.x,1e3*o.y,0);m(t).by(1,{position:r}).call((function(){t.getComponent(B).spriteFrame=null,t.setScale(2,2,1),t.getComponent(h).play(),t.getComponent(B).customMaterial=e.defaultMaterial,t.getComponent(p).tag=y.fireBallFire,e.scheduleOnce((function(){t.active=!1}),5)})).start()},t}(z)).prototype,"fireBall",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=t(w.prototype,"defaultMaterial",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=t(w.prototype,"fireBallMaterial",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=w))||S));r._RF.pop()}}}));

System.register("chunks:///_virtual/Canvas.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PoolManager.ts"],(function(e){var t,i,n,o,r,a,c,l,s;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,a=e._decorator,c=e.Node,l=e.Component},function(e){s=e.plm}],execute:function(){var u,d,v,p,f,h,y;r._RF.push({},"b39cal86yhCGYNmdUqX6+Oi","Canvas",void 0);var N=a.ccclass,g=a.property;e("Canvas",(u=N("Canvas"),d=g(c),v=g(c),u((h=t((f=function(e){function t(){for(var t,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(t,"childNode",h,o(t)),n(t,"needActiveNode",y,o(t)),t}i(t,e);var r=t.prototype;return r.onLoad=function(){this.activeChildNodeFirst(),this.activeScriptByActiveNode()},r.onDestroy=function(){s.clearAllNodePool()},r.start=function(){},r.activeChildNodeFirst=function(){for(var e=this.childNode,t=0;t<e.length;t++){var i=e[t];i&&(i.active=!0)}},r.activeScriptByActiveNode=function(){for(var e=this.needActiveNode,t=0;t<e.length;t++){var i=e[t];i&&(i.active=!0,i.active=!1)}},t}(l)).prototype,"childNode",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),y=t(f.prototype,"needActiveNode",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),p=f))||p));r._RF.pop()}}}));

System.register("chunks:///_virtual/CommonCallback.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PoolManager.ts"],(function(o){var n,t,e,r,c;return{setters:[function(o){n=o.inheritsLoose},function(o){t=o.cclegacy,e=o._decorator,r=o.Component},function(o){c=o.plm}],execute:function(){var l;t._RF.push({},"3b59fGhdkFB26GOmbz41Qg5","CommonCallback",void 0);var i=e.ccclass;e.property,o("CommonCallback",i("CommonCallback")(l=function(o){function t(){return o.apply(this,arguments)||this}n(t,o);var e=t.prototype;return e.destroyAnim=function(){this.node.destroy(),console.log("销毁节点")},e.recoveryAnim=function(o){c.putToPool(o,this.node,!0)},t}(r))||l);t._RF.pop()}}}));

System.register("chunks:///_virtual/CurrentRoundMessage.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts"],(function(e){var n,s,t,o,r,a,i,u,c;return{setters:[function(e){n=e.inheritsLoose},function(e){s=e.cclegacy,t=e._decorator,o=e.find,r=e.instantiate,a=e.Label,i=e.ScrollView,u=e.Component},function(e){c=e.em}],execute:function(){var d;s._RF.push({},"6a7ee8nKmNDa4S5L9g+V0KD","CurrentRoundMessage",void 0);var g=t.ccclass;t.property,e("CurrentRoundMessage",g("CurrentRoundMessage")(d=function(e){function s(){for(var n,s=arguments.length,t=new Array(s),o=0;o<s;o++)t[o]=arguments[o];return(n=e.call.apply(e,[this].concat(t))||this)._messagePrefab=void 0,n._messagePar=void 0,n}n(s,e);var t=s.prototype;return t.onDestroy=function(){c.remove("sendRoundMessage")},t.onLoad=function(){c.add("sendRoundMessage",this.sendRoundMessage.bind(this)),this._messagePrefab=o("Label",this.node),this._messagePar=o("ScrollView/view/content",this.node)},t.sendRoundMessage=function(e){var n=r(this._messagePrefab);n.parent=this._messagePar,n.getComponent(a).string=e,this._messagePar.parent.parent.getComponent(i).scrollToBottom(1),n.active=!0},s}(u))||d);s._RF.pop()}}}));

System.register("chunks:///_virtual/DarkMask.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalData.ts","./EnemySkill.ts"],(function(t){var n,e,o,a,i,r;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator},function(t){a=t.em},function(t){i=t.tagData},function(t){r=t.EnemySkill}],execute:function(){var s;e._RF.push({},"5651evCO91NHb+szJiF4jVe","DarkMask",void 0);var c=o.ccclass;o.property,t("DarkMask",c("DarkMask")(s=function(t){function e(){return t.apply(this,arguments)||this}n(e,t);var o=e.prototype;return o.init=function(){this.initCollider()},o.onBeginContact=function(t,n){n.tag===i.hero&&a.dispatch("usingHeroControlFun","addDebuffBanMove",2)},e}(r))||s);e._RF.pop()}}}));

System.register("chunks:///_virtual/Darts.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalData.ts","./PoolManager.ts","./Weapon.ts"],(function(t){var i,n,s,a,o,e,r,l,c;return{setters:[function(t){i=t.inheritsLoose},function(t){n=t.cclegacy,s=t._decorator,a=t.find},function(t){o=t.em},function(t){e=t.tagData,r=t.ggd},function(t){l=t.plm},function(t){c=t.Weapon}],execute:function(){var h;n._RF.push({},"b4b92Q5gQxCeLttrvjhA8P8","Darts",void 0);var u=s.ccclass;t("Darts",u("Darts")(h=function(t){function n(){for(var i,n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return(i=t.call.apply(t,[this].concat(s))||this)._isCanSplit=!1,i._isCanSplitTimes=0,i}i(n,t);var s=n.prototype;return s.init=function(t,i,n,s,a){void 0===s&&(s=!1),this.initWeaponInfo(i,t,n);var r=t.name;this.initBoxCollider(e[r]),this._isCanSplit=s,o.dispatch("playOneShot","battle/bullet"),this.schedule(this.startRotation,1/60)},s.startRotation=function(){r.stopAll||(this.node.angle+=30)},s.colliderMonster=function(t){this.isStopRun(t)||(this.updateMonsterBlood(t),this._canAttackTimes--,this._canAttackTimes<=0?this.recoveryToPool():this.changeFlyDir())},s.colliderBoss=function(t){this.isStopRun(t)||(this.updateBossBlood(t),this._canAttackTimes<=0?this.recoveryToPool():this.changeFlyDir())},s.changeFlyDir=function(){var t=Math.sin(30*Math.random());this._flyDir.x=-this._flyDir.x,this._flyDir.y=-this._flyDir.y;var i=this.getRotationDir(this._flyDir,t),n=this.getRotationDir(this._flyDir,-t);this._flyDir=i,this._isCanSplit&&(this.createSplitDarts(n),this._canAttackTimes--,this._canAttackTimes<=0&&(this._isCanSplit=!1))},s.getRotationDir=function(t,i){var n=t.x,s=t.y;return{x:n*Math.cos(i)-s*Math.sin(i),y:n*Math.sin(i)+s*Math.cos(i)}},s.createSplitDarts=function(t){var i=o.dispatch("getWeaponDataByIdOrName","darts"),n=l.getFromPool("darts"),s=a("Canvas/bulletLayer");n.parent=s;var e=this.node.getWorldPosition();n.setWorldPosition(e),n.getComponent("Darts").init(i,i.maxLevel,t)},n}(c))||h);n._RF.pop()}}}));

System.register("chunks:///_virtual/debug-view-runtime-control.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,o,i,n,s,l,r,a,g,h,p,c,C,d,m,u,L;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.inheritsLoose,i=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){s=t.cclegacy,l=t._decorator,r=t.Node,a=t.Color,g=t.Canvas,h=t.UITransform,p=t.instantiate,c=t.Label,C=t.RichText,d=t.Toggle,m=t.Button,u=t.director,L=t.Component}],execute:function(){var f,M,b,v,T,S,x,E,I;s._RF.push({},"b2bd1+njXxJxaFY3ymm06WU","debug-view-runtime-control",void 0);var A=l.ccclass,y=l.property;t("DebugViewRuntimeControl",(f=A("internal.DebugViewRuntimeControl"),M=y(r),b=y(r),v=y(r),f((x=e((S=function(t){function e(){for(var e,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return e=t.call.apply(t,[this].concat(s))||this,i(e,"compositeModeToggle",x,n(e)),i(e,"singleModeToggle",E,n(e)),i(e,"EnableAllCompositeModeButton",I,n(e)),e._single=0,e.strSingle=["No Single Debug","Vertex Color","Vertex Normal","Vertex Tangent","World Position","Vertex Mirror","Face Side","UV0","UV1","UV Lightmap","Project Depth","Linear Depth","Fragment Normal","Fragment Tangent","Fragment Binormal","Base Color","Diffuse Color","Specular Color","Transparency","Metallic","Roughness","Specular Intensity","IOR","Direct Diffuse","Direct Specular","Direct All","Env Diffuse","Env Specular","Env All","Emissive","Light Map","Shadow","AO","Fresnel","Direct Transmit Diffuse","Direct Transmit Specular","Env Transmit Diffuse","Env Transmit Specular","Transmit All","Direct Internal Specular","Env Internal Specular","Internal All","Fog"],e.strComposite=["Direct Diffuse","Direct Specular","Env Diffuse","Env Specular","Emissive","Light Map","Shadow","AO","Normal Map","Fog","Tone Mapping","Gamma Correction","Fresnel","Transmit Diffuse","Transmit Specular","Internal Specular","TT"],e.strMisc=["CSM Layer Coloration","Lighting With Albedo"],e.compositeModeToggleList=[],e.singleModeToggleList=[],e.miscModeToggleList=[],e.textComponentList=[],e.labelComponentList=[],e.textContentList=[],e.hideButtonLabel=void 0,e._currentColorIndex=0,e.strColor=["<color=#ffffff>","<color=#000000>","<color=#ff0000>","<color=#00ff00>","<color=#0000ff>"],e.color=[a.WHITE,a.BLACK,a.RED,a.GREEN,a.BLUE],e}o(e,t);var s=e.prototype;return s.start=function(){if(this.node.parent.getComponent(g)){var t=this.node.parent.getComponent(h),e=.5*t.width,o=.5*t.height,i=.1*e-e,n=o-.1*o,s=this.node.getChildByName("MiscMode"),l=p(s);l.parent=this.node,l.name="Buttons";var r=p(s);r.parent=this.node,r.name="Titles";for(var u=0;u<2;u++){var L=p(this.EnableAllCompositeModeButton.getChildByName("Label"));L.setPosition(i+(u>0?450:150),n,0),L.setScale(.75,.75,.75),L.parent=r;var f=L.getComponent(c);f.string=u?"----------Composite Mode----------":"----------Single Mode----------",f.color=a.WHITE,f.overflow=0,this.labelComponentList[this.labelComponentList.length]=f}n-=20;for(var M=0,b=0;b<this.strSingle.length;b++,M++){b===this.strSingle.length>>1&&(i+=200,M=0);var v=b?p(this.singleModeToggle):this.singleModeToggle;v.setPosition(i,n-20*M,0),v.setScale(.5,.5,.5),v.parent=this.singleModeToggle.parent;var T=v.getComponentInChildren(C);T.string=this.strSingle[b],this.textComponentList[this.textComponentList.length]=T,this.textContentList[this.textContentList.length]=T.string,v.on(d.EventType.TOGGLE,this.toggleSingleMode,this),this.singleModeToggleList[b]=v}i+=200,this.EnableAllCompositeModeButton.setPosition(i+15,n,0),this.EnableAllCompositeModeButton.setScale(.5,.5,.5),this.EnableAllCompositeModeButton.on(m.EventType.CLICK,this.enableAllCompositeMode,this),this.EnableAllCompositeModeButton.parent=l;var S=this.EnableAllCompositeModeButton.getComponentInChildren(c);this.labelComponentList[this.labelComponentList.length]=S;var x=p(this.EnableAllCompositeModeButton);x.setPosition(i+90,n,0),x.setScale(.5,.5,.5),x.on(m.EventType.CLICK,this.changeTextColor,this),x.parent=l,(S=x.getComponentInChildren(c)).string="TextColor",this.labelComponentList[this.labelComponentList.length]=S;var E=p(this.EnableAllCompositeModeButton);E.setPosition(i+200,n,0),E.setScale(.5,.5,.5),E.on(m.EventType.CLICK,this.hideUI,this),E.parent=this.node.parent,(S=E.getComponentInChildren(c)).string="Hide UI",this.labelComponentList[this.labelComponentList.length]=S,this.hideButtonLabel=S,n-=40;for(var I=0;I<this.strMisc.length;I++){var A=p(this.compositeModeToggle);A.setPosition(i,n-20*I,0),A.setScale(.5,.5,.5),A.parent=s;var y=A.getComponentInChildren(C);y.string=this.strMisc[I],this.textComponentList[this.textComponentList.length]=y,this.textContentList[this.textContentList.length]=y.string,A.getComponent(d).isChecked=!!I,A.on(d.EventType.TOGGLE,I?this.toggleLightingWithAlbedo:this.toggleCSMColoration,this),this.miscModeToggleList[I]=A}n-=150;for(var D=0;D<this.strComposite.length;D++){var B=D?p(this.compositeModeToggle):this.compositeModeToggle;B.setPosition(i,n-20*D,0),B.setScale(.5,.5,.5),B.parent=this.compositeModeToggle.parent;var w=B.getComponentInChildren(C);w.string=this.strComposite[D],this.textComponentList[this.textComponentList.length]=w,this.textContentList[this.textContentList.length]=w.string,B.on(d.EventType.TOGGLE,this.toggleCompositeMode,this),this.compositeModeToggleList[D]=B}}else console.error("debug-view-runtime-control should be child of Canvas")},s.isTextMatched=function(t,e){var o=new String(t),i=o.search(">");return-1===i?t===e:(o=(o=o.substr(i+1)).substr(0,o.search("<")))===e},s.toggleSingleMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strSingle.length;i++)this.isTextMatched(o.string,this.strSingle[i])&&(e.singleMode=i)},s.toggleCompositeMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strComposite.length;i++)this.isTextMatched(o.string,this.strComposite[i])&&e.enableCompositeMode(i,t.isChecked)},s.toggleLightingWithAlbedo=function(t){u.root.debugView.lightingWithAlbedo=t.isChecked},s.toggleCSMColoration=function(t){u.root.debugView.csmLayerColoration=t.isChecked},s.enableAllCompositeMode=function(t){var e=u.root.debugView;e.enableAllCompositeMode(!0);for(var o=0;o<this.compositeModeToggleList.length;o++){this.compositeModeToggleList[o].getComponent(d).isChecked=!0}var i=this.miscModeToggleList[0].getComponent(d);i.isChecked=!1,e.csmLayerColoration=!1,(i=this.miscModeToggleList[1].getComponent(d)).isChecked=!0,e.lightingWithAlbedo=!0},s.hideUI=function(t){var e=this.node.getChildByName("Titles"),o=!e.active;this.singleModeToggleList[0].parent.active=o,this.miscModeToggleList[0].parent.active=o,this.compositeModeToggleList[0].parent.active=o,this.EnableAllCompositeModeButton.parent.active=o,e.active=o,this.hideButtonLabel.string=o?"Hide UI":"Show UI"},s.changeTextColor=function(t){this._currentColorIndex++,this._currentColorIndex>=this.strColor.length&&(this._currentColorIndex=0);for(var e=0;e<this.textComponentList.length;e++)this.textComponentList[e].string=this.strColor[this._currentColorIndex]+this.textContentList[e]+"</color>";for(var o=0;o<this.labelComponentList.length;o++)this.labelComponentList[o].color=this.color[this._currentColorIndex]},s.onLoad=function(){},s.update=function(t){},e}(L)).prototype,"compositeModeToggle",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=e(S.prototype,"singleModeToggle",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=e(S.prototype,"EnableAllCompositeModeButton",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=S))||T));s._RF.pop()}}}));

System.register("chunks:///_virtual/DynamicLoading.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./PreLoad.ts"],(function(o){var e,i,n,r,t,a,c,s,d,l,u;return{setters:[function(o){e=o.applyDecoratedDescriptor,i=o.inheritsLoose,n=o.initializerDefineProperty,r=o.assertThisInitialized},function(o){t=o.cclegacy,a=o._decorator,c=o.game,s=o.resources,d=o.Component},function(o){l=o.em},function(o){u=o.PreLoad}],execute:function(){var p,h,f,D,L;t._RF.push({},"16d7eG5vo9IBLdWMm1q6dEM","DynamicLoading",void 0);var g=a.ccclass,v=a.property;o("DynamicLoading",(p=g("DynamicLoading"),h=v(u),p((L=e((D=function(o){function e(){for(var e,i=arguments.length,t=new Array(i),a=0;a<i;a++)t[a]=arguments[a];return e=o.call.apply(o,[this].concat(t))||this,n(e,"preLoadScript",L,r(e)),e}i(e,o);var t=e.prototype;return t.onDestroy=function(){l.remove("loadTheDirResources"),l.remove("loadTheDir")},t.onLoad=function(){l.add("loadTheDirResources",this.loadTheDirResources.bind(this)),l.add("loadTheDir",this.loadTheDir.bind(this)),this.preLoadAllResources(),c.addPersistRootNode(this.node)},t.preLoadAllResources=function(){var o=this;s.loadDir("",(function(e,i,n){o.preLoadScript.updateLoadingProgress(e/i)}),(function(e,i){e?console.log(e):o.preLoadScript.enterMainMenuScene()}))},t.loadTheDir=function(o,e){void 0===e&&(e=null),s.loadDir(o,(function(o,i){o?console.log(o):e&&e(i)}))},t.loadTheDirResources=function(o,e){void 0===e&&(e=null),s.load(o,(function(o,i){o?console.log(o):e&&e(i)}))},e}(d)).prototype,"preLoadScript",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=D))||f));t._RF.pop()}}}));

System.register("chunks:///_virtual/EnemySkill.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalData.ts","./PoolManager.ts"],(function(t){var e,o,n,i,a,r,s,l,d,c,u,h,p,m;return{setters:[function(t){e=t.inheritsLoose},function(t){o=t.cclegacy,n=t._decorator,i=t.BoxCollider2D,a=t.UITransform,r=t.Size,s=t.Contact2DType,l=t.CircleCollider2D,d=t.Component},function(t){c=t.em},function(t){u=t.tagData,h=t.groupIndex,p=t.ggd},function(t){m=t.plm}],execute:function(){var g;o._RF.push({},"ad080WTW8JAq6c5uR79Xh4x","EnemySkill",void 0);var f=n.ccclass;n.property,t("EnemySkill",f("EnemySkill")(g=function(t){function o(){for(var e,o=arguments.length,n=new Array(o),i=0;i<o;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))||this)._skillName=void 0,e._damage=void 0,e._flyDir=void 0,e._moveSpeed=void 0,e._duration=1/0,e}e(o,t);var n=o.prototype;return n.init=function(t,e,o){void 0===o&&(o=1),this._skillName=t.name,this._damage=t.damage,this._duration=t.duration,this._moveSpeed=t.moveSpeed,this._flyDir=e,this.initCollider(o)},n.initCollider=function(t){void 0===t&&(t=1);var e=this.node.getComponent(i);e||(e=this.node.addComponent(i));var o=this.node.getComponent(a),n=new r(o.contentSize.x*t,o.contentSize.y*t);e.tag=u.enemySkill,e.size=n,e.group=h.enemySkill,e.on(s.BEGIN_CONTACT,this.onBeginContact,this)},n.initCircleCollider=function(t){void 0===t&&(t=1);var e=this.node.getComponent(l);e||(e=this.node.addComponent(l));var o=this.node.getComponent(a),n=new r(o.contentSize.x*t,o.contentSize.y*t);e.tag=u.enemySkill,e.radius=n.x/2,e.group=h.enemySkill,e.on(s.BEGIN_CONTACT,this.onBeginContact,this)},n.onBeginContact=function(t,e){e.tag===u.hero&&c.dispatch("usingHeroControlFun","createBossDamageTex",-this._damage)},n.recoveryPrefab=function(){m.putToPool(this._skillName,this.node)},n.destroyPrefab=function(){this.node.destroy()},n.update=function(t){this.weaponMove(t),this.weaponDuration(t)},n.weaponMove=function(t){if(!p.stopAll&&this._flyDir&&0!=this._moveSpeed&&this._duration!=1/0){var e=t*this._moveSpeed,o=this._flyDir.x*e,n=this._flyDir.y*e;this.node.setPosition(this.node.getPosition().x+o,this.node.getPosition().y+n,0)}},n.weaponDuration=function(t){p.stopAll||(this._duration-=t,this._duration<=0&&this.recoveryPrefab())},o}(d))||g);o._RF.pop()}}}));

System.register("chunks:///_virtual/EventManager.ts",["cc"],(function(e){var n;return{setters:[function(e){n=e.cclegacy}],execute:function(){n._RF.push({},"65fecLrBN5EdbS9KOtfYHkX","EventManager",void 0);var t=function(){function e(){this.event={}}var n=e.prototype;return n.add=function(e,n){e&&n?this.event[e]?console.warn("event already exists:",e):(this.event[e]={callback:n},console.log("event added:",e)):console.warn("event type or callback missing")},n.dispatch=function(e){if(!e)return console.warn("dispatch type is empty"),null;if(!this.event[e])return console.warn("event not registered:",e),null;var n=this.event[e].callback;if(!n)return console.warn("event callback missing:",e),null;try{for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return n.apply(void 0,r)}catch(n){return console.warn("event callback error:",e,n),null}},n.eventIsDefined=function(e){return!!this.event[e]},n.remove=function(e){e?this.event[e]?delete this.event[e]:console.warn("remove event not exist:",e):console.warn("remove event type is empty")},n.showAllEvents=function(){console.log(this.event)},e}();console.log("九重修炼 alpha-version-2.1");e("em",new t);n._RF.pop()}}}));

System.register("chunks:///_virtual/FanPrefab.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var n,r,t,o;return{setters:[function(e){n=e.inheritsLoose},function(e){r=e.cclegacy,t=e._decorator,o=e.Component}],execute:function(){var a;r._RF.push({},"e0b852hnStMuL8DCjNUMpIA","FanPrefab",void 0);var c=t.ccclass;t.property,e("FanPrefab",c("FanPrefab")(a=function(e){function r(){return e.apply(this,arguments)||this}n(r,e);var t=r.prototype;return t.start=function(){this.moveLikeParabola()},t.moveLikeParabola=function(){return console.log("还没写")},r}(o))||a);r._RF.pop()}}}));

System.register("chunks:///_virtual/FireBloom.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalData.ts","./Weapon.ts"],(function(t){var e,i,a,o,n,r;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,a=t._decorator},function(t){o=t.em},function(t){n=t.tagData},function(t){r=t.Weapon}],execute:function(){var s;i._RF.push({},"b247e+Qq1tGc6SfQssZUuHm","FireBloom",void 0);var c=a.ccclass;a.property,t("FireBloom",c("FireBloom")(s=function(t){function i(){return t.apply(this,arguments)||this}e(i,t);var a=i.prototype;return a.init=function(){this.initSkillData()},a.initSkillData=function(){var t=o.dispatch("usingHeroBasePropertyFun","getSkillBookDataByIdOrName","fireBloom");this._damage=t.baseDamage,this._moveSpeed=0,this._canAttackTimes=1/0,this._backDis=0,this._attackInterval=1,this._weaponName=t.name2,this.clearCacheData(),this.initBoxCollider(n.sword)},i}(r))||s);i._RF.pop()}}}));

System.register("chunks:///_virtual/FriendControl.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var n,t,r,i,o,l,a,s,c,u,f,p,d,y;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,r=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){o=e.cclegacy,l=e._decorator,a=e.Node,s=e.Prefab,c=e.instantiate,u=e.find,f=e.tween,p=e.Sprite,d=e.Color,y=e.Component}],execute:function(){var g,h,v,b,C,m,w;o._RF.push({},"96d97NdVelLaJt7lq+g3AHt","FriendControl",void 0);var z=l.ccclass,F=l.property;e("FriendControl",(g=z("FriendControl"),h=F(a),v=F(s),g((m=n((C=function(e){function n(){for(var n,t=arguments.length,o=new Array(t),l=0;l<t;l++)o[l]=arguments[l];return n=e.call.apply(e,[this].concat(o))||this,r(n,"friend1",m,i(n)),r(n,"f1s1",w,i(n)),n}t(n,e);var o=n.prototype;return o.start=function(){var e=this;this.schedule((function(){e.friend1UsingSkill1()}),1)},o.friend1UsingSkill1=function(){if(!this.friend1||!this.friend1.active)return console.log("friend 不存在 或未激活");var e=c(this.f1s1),n=this.friend1.getWorldPosition(),t=40,r=25,i=u("Canvas/bulletLayer");e.parent=i,e.setWorldPosition(n.x+t,n.y+r,0);var o=f().by(2,{position:{x:500,y:-500,z:0},angle:-3600}),l=f().to(1,{scale:{x:2,y:2,z:1}},{onUpdate:function(e,n){var t=e.getComponent(p).color;e.getComponent(p).color=d.lerp(new d,t,new d(t.r,t.g,t.b,255),n)}});f(e).parallel(o,l).call((function(){e.destroy()})).start()},o.update=function(e){},n}(y)).prototype,"friend1",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=n(C.prototype,"f1s1",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=C))||b));o._RF.pop()}}}));

System.register("chunks:///_virtual/GameAnimManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts"],(function(n){var i,t,e,a,o;return{setters:[function(n){i=n.inheritsLoose},function(n){t=n.cclegacy,e=n._decorator,a=n.Component},function(n){o=n.em}],execute:function(){var s;t._RF.push({},"1d4f9s3vJFHb4UKLxz8L+zJ","GameAnimManager",void 0);var r=e.ccclass;e.property,n("GameAnimManager",r("GameAnimManager")(s=function(n){function t(){for(var i,t=arguments.length,e=new Array(t),a=0;a<t;a++)e[a]=arguments[a];return(i=n.call.apply(n,[this].concat(e))||this)._animList=[],i}i(t,n);var e=t.prototype;return e.onDestroy=function(){o.remove("usingGameAnimManagerFun")},e.onLoad=function(){o.add("usingGameAnimManagerFun",this.usingGameAnimManagerFun.bind(this))},e.usingGameAnimManagerFun=function(n){for(var i=arguments.length,t=new Array(i>1?i-1:0),e=1;e<i;e++)t[e-1]=arguments[e];if(this[n]&&"function"==typeof this[n])return this[n].apply(this,t);throw n+" is not fun or undefined"},e.addAnimToList=function(n){console.log("添加anim：",n),this._animList.push(n)},e.removeAnimFromList=function(n){var i=this._animList.indexOf(n);if(!(i>-1))throw"anim is not in list.";this._animList.splice(i,1)},e.pauseAllAnim=function(){console.log("暂停list中所有的动画"),this._animList.forEach((function(n){n.pause()}))},e.resumeAllAnim=function(){console.log("恢复所有list中的动画"),this._animList.forEach((function(n){n.resume()}))},t}(a))||s);t._RF.pop()}}}));

System.register("chunks:///_virtual/GameMonetize.com-SDK.ts",["cc"],(function(){var e;return{setters:[function(c){e=c.cclegacy}],execute:function(){e._RF.push({},"cb456kBbFJNn4k61gmkPq3v","GameMonetize.com-SDK",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/GameSettings.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts"],(function(e){var t,n,i,o,r,a,s,c,u;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,a=e._decorator,s=e.Label,c=e.Component},function(e){u=e.em}],execute:function(){var l,p,g,h,f;r._RF.push({},"8b950jW4AZPXobu7MumYqkU","GameSettings",void 0);var d=a.ccclass,m=a.property;e("GameSettings",(l=d("GameSettings"),p=m(s),l((f=t((h=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,i(t,"contentLabel",f,o(t)),t}n(t,e);var r=t.prototype;return r.onEnable=function(){this.updateHeroPropertiesView()},r.updateHeroPropertiesView=function(){var e;e=u.dispatch("usingWeaponManagerFun","getWeaponDes")+u.dispatch("usingHeroControlFun","getHeroPropertiesDes"),this.contentLabel.string=e},r.onBtnSettings=function(){this.node.active=!0,u.dispatch("usingHeroControlFun","pauseGame")},r.closeSetting=function(){this.node.active=!1,u.dispatch("usingHeroControlFun","resumeGame")},t}(c)).prototype,"contentLabel",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=h))||g));r._RF.pop()}}}));

System.register("chunks:///_virtual/globalData.ts",["cc"],(function(e){var a;return{setters:[function(e){a=e.cclegacy}],execute:function(){a._RF.push({},"12677v3hZxChoqJeg+2NXbN","globalData",void 0);e("tagData",function(e){return e[e.hero=10]="hero",e[e.sword=11]="sword",e[e.fan=12]="fan",e[e.guard=13]="guard",e[e.spell=14]="spell",e[e.darts=15]="darts",e[e.friend1Skill1=16]="friend1Skill1",e[e.monster=17]="monster",e[e.wall=18]="wall",e[e.boss=19]="boss",e[e.fireBall=20]="fireBall",e[e.fireBallFire=21]="fireBallFire",e[e.trackDisappear=22]="trackDisappear",e[e.enemySkill=23]="enemySkill",e[e.obstacle=24]="obstacle",e}({})),e("groupIndex",{DEFAULT:Math.pow(2,0),enemy:Math.pow(2,1),self:Math.pow(2,2),obstacle:Math.pow(2,3),enemySkill:Math.pow(2,4),heroWeapon:Math.pow(2,5)}),e("attackInterval",{monsterCollideHero:1,guard:.5,spell:.1,f1s1:1/60,boss1:1,boss2:1}),e("ggd",{stopAll:!1,curStage:1,curLv:1,stageProgress:1});a._RF.pop()}}}));

System.register("chunks:///_virtual/globalFun.ts",["cc"],(function(t){var n,e,o;return{setters:[function(t){n=t.cclegacy,e=t.EventHandler,o=t.Button}],execute:function(){n._RF.push({},"449eazAx+VFQq/a5iitUUii","globalFun",void 0);t("glf",{createButton:function(t,n,r,a,c){if(void 0===c&&(c=""),t&&n&&r&&a){var i=new e;i.target=t,i.component=r,i.handler=a,i.customEventData=c;var u=n.getComponent(o);u||(u=n.addComponent(o)),u.clickEvents[0]=i}else console.log("参数错误 无法生成按钮 请重新设置")},getCirclePos:function(t,n){if(n<4)throw"圆上点数过少 请输入大于4的数字";if(n%4!=0)throw"生成的在圆上的点的总数错误，不是4的倍数"+n;for(var e=n/4,o=[],r=1;r<e;r++){var a=t*Math.sin(Math.PI/180*r/e*90),c=Math.sqrt(t*t-a*a);o.push([c,a],[c,-a],[-c,a],[-c,-a])}return o.push([0,t],[0,-t],[t,0],[-t,0]),o}});n._RF.pop()}}}));

System.register("chunks:///_virtual/GreenThunder.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EnemySkill.ts"],(function(e){var n,r,t,i;return{setters:[function(e){n=e.inheritsLoose},function(e){r=e.cclegacy,t=e._decorator},function(e){i=e.EnemySkill}],execute:function(){var u;r._RF.push({},"fa205J2QNhCM6XEN0hsqKzD","GreenThunder",void 0);var o=t.ccclass;t.property,e("GreenThunder",o("GreenThunder")(u=function(e){function r(){return e.apply(this,arguments)||this}return n(r,e),r.prototype.init=function(e){this._skillName="greenThunder",this._damage=e,this.initCollider()},r}(i))||u);r._RF.pop()}}}));

System.register("chunks:///_virtual/Guard.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalData.ts","./Weapon.ts"],(function(t){var e,n,i,o,a,s,r;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.em},function(t){a=t.tagData,s=t.ggd},function(t){r=t.Weapon}],execute:function(){var c;n._RF.push({},"f0a2dmCnJBInb6cEYwE9QoG","Guard",void 0);var l=i.ccclass;t("Guard",l("Guard")(c=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.init=function(t,e){this.initWeaponInfo(e,t);var n=t.name;this.initCircleCollider(a[n],-10)},i.colliderMonster=function(t){var e=this;if(s.stopAll)this.scheduleOnce((function(){e.colliderMonster(t)}),this._attackInterval);else if(this.isTouching(t)){var n=o.dispatch("usingHeroControlFun","getCurDamage")+this._damage;o.dispatch("createDamageTex",t.node,n,{x:0,y:20}),t.node.getComponent("Monster").updateBlood(-n),this.scheduleOnce((function(){e.colliderMonster(t)}),this._attackInterval)}},i.colliderBoss=function(t){var e=this;if(s.stopAll)this.scheduleOnce((function(){e.colliderBoss(t)}),this._attackInterval);else if(this.isTouching(t)){o.dispatch("createDamageTex",t.node,this._damage,{x:0,y:20});var n=t.node.parent.components[0];if(!n)throw"script name is different form node name.";var i=o.dispatch("usingHeroControlFun","getCurDamage")+this._damage;n.updateBlood(-i),this.scheduleOnce((function(){e.colliderBoss(t)}),this._attackInterval)}},n}(r))||c);n._RF.pop()}}}));

System.register("chunks:///_virtual/HellFire.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalData.ts","./Weapon.ts"],(function(t){var e,a,i,n,r,o;return{setters:[function(t){e=t.inheritsLoose},function(t){a=t.cclegacy,i=t._decorator},function(t){n=t.em},function(t){r=t.tagData},function(t){o=t.Weapon}],execute:function(){var s;a._RF.push({},"037bdybLU9JVYPgEIJ1NPSt","HellFire",void 0);var l=i.ccclass;i.property,t("HellFire",l("HellFire")(s=function(t){function a(){return t.apply(this,arguments)||this}e(a,t);var i=a.prototype;return i.init=function(){this.initSkillData()},i.initSkillData=function(){var t=n.dispatch("usingHeroBasePropertyFun","getSkillBookDataByIdOrName","hellFire");this._damage=t.baseDamage+(n.dispatch("usingHeroControlFun","getCurDamage")*t.damageTimes|0),this._moveSpeed=0,this._canAttackTimes=1/0,this._backDis=0,this._attackInterval=1,this._weaponName=t.name2,this.clearCacheData(),this.initBoxCollider(r.sword)},a}(o))||s);a._RF.pop()}}}));

System.register("chunks:///_virtual/helpLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalData.ts"],(function(n){var e,t,o,a,r,i;return{setters:[function(n){e=n.inheritsLoose},function(n){t=n.cclegacy,o=n._decorator,a=n.Component},function(n){r=n.em},function(n){i=n.ggd}],execute:function(){var c;t._RF.push({},"1aea51RUbNFdL7S/YxOX6C2","helpLayer",void 0);var s=o.ccclass;o.property,n("helpLayer",s("helpLayer")(c=function(n){function t(){return n.apply(this,arguments)||this}e(t,n);var o=t.prototype;return o.onBtnUnlockAllStages=function(){i.stageProgress=20,r.dispatch("savingGlobalDataToTempData")},o.onBtnOpenHelpLayer=function(){this.node.active=!0},o.onBtnCloseHelpLayer=function(){this.node.active=!1},o.onBtnOpenDamageImmunity=function(){r.dispatch("usingHeroControlFun","openDamageImmunity")},t}(a))||c);t._RF.pop()}}}));

System.register("chunks:///_virtual/HeroBaseProperty.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts"],(function(t){var e,i,o,n,r,a,s,v,l,u;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,o=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){r=t.cclegacy,a=t._decorator,s=t.JsonAsset,v=t.game,l=t.Component},function(t){u=t.em}],execute:function(){var L,p,h,c,d,_,g,B,y,f,m;r._RF.push({},"18e13h041hCKrr/q+F1r+Zb","HeroBaseProperty",void 0);var D=a.ccclass,b=a.property;t("HeroBaseProperty",(L=D("HeroBaseProperty"),p=b(s),h=b(s),c=b(s),d=b(s),L((B=e((g=function(t){function e(){for(var e,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,o(e,"heroPropertyDataJson",B,n(e)),o(e,"trainingLvListJson",y,n(e)),o(e,"skillBookListJson",f,n(e)),o(e,"equipmentListJson",m,n(e)),e._heroData=void 0,e._trainingLvList=void 0,e._skillBookList={},e._equipmentList={},e._percentageBloodLv=void 0,e._percentageDamageLv=void 0,e._moveSpeedLv=void 0,e._percentageMoveSpeedLv=void 0,e._criticalHitRateLv=void 0,e._bonusBulletTotalLv=void 0,e._bonusBulletMoveSpeedLv=void 0,e._bonusBulletDurationLv=void 0,e._bonusBulletAttackTimesLv=void 0,e._recoveryHealthyLv=void 0,e._expAdditionLv=void 0,e._divineStoneAdditionLv=void 0,e}i(e,t);var r=e.prototype;return r.onDestroy=function(){u.remove("usingHeroBasePropertyFun")},r.onLoad=function(){this._heroData=this.heroPropertyDataJson.json[0],this._trainingLvList=this.trainingLvListJson.json,this.initSkillBookData(),this.initEquipmentData(),u.add("usingHeroBasePropertyFun",this.usingHeroBasePropertyFun.bind(this)),v.addPersistRootNode(this.node)},r.initSkillBookData=function(){var t=this;this.skillBookListJson.json.forEach((function(e){var i=e.name,o=e.name2;t._skillBookList[i]=e,t._skillBookList[o]=e}))},r.initEquipmentData=function(){var t=this;this.equipmentListJson.json.forEach((function(e){var i=e.name;t._equipmentList[i]=e}))},r.onEnable=function(){this.initBasePropertyLv()},r.initBasePropertyLv=function(){var t=u.dispatch("getTempData","HeroBasePropertyLvList");null==t&&(t={percentageBloodLv:1,percentageDamageLv:1,percentageMoveSpeedLv:1,moveSpeedLv:1,criticalHitRateLv:1,bonusBulletTotalLv:1,bonusBulletMoveSpeedLv:1,bonusBulletDurationLv:1,bonusBulletAttackTimesLv:1,recoveryHealthyLv:1,expAdditionLv:1,divineStoneAdditionLv:10}),this._percentageBloodLv=t.percentageBloodLv,this._percentageDamageLv=t.percentageDamageLv,this._percentageMoveSpeedLv=t.percentageMoveSpeedLv,this._moveSpeedLv=t.moveSpeedLv,this._criticalHitRateLv=t.criticalHitRateLv,this._bonusBulletTotalLv=t.bonusBulletTotalLv,this._bonusBulletMoveSpeedLv=t.bonusBulletMoveSpeedLv,this._bonusBulletDurationLv=t.bonusBulletDurationLv,this._bonusBulletAttackTimesLv=t.bonusBulletAttackTimesLv,this._recoveryHealthyLv=t.recoveryHealthyLv,this._expAdditionLv=t.expAdditionLv,this._divineStoneAdditionLv=t.divineStoneAdditionLv,this.savingLvData()},r.savingLvData=function(){var t={percentageBloodLv:this._percentageBloodLv,percentageDamageLv:this._percentageDamageLv,moveSpeedLv:this._moveSpeedLv,percentageMoveSpeedLv:this._percentageMoveSpeedLv,criticalHitRateLv:this._criticalHitRateLv,bonusBulletTotalLv:this._bonusBulletTotalLv,bonusBulletMoveSpeedLv:this._bonusBulletMoveSpeedLv,bonusBulletDurationLv:this._bonusBulletDurationLv,bonusBulletAttackTimesLv:this._bonusBulletAttackTimesLv,recoveryHealthyLv:this._recoveryHealthyLv,expAdditionLv:this._expAdditionLv,divineStoneAdditionLv:this._divineStoneAdditionLv};u.dispatch("savingToTempData","HeroBasePropertyLvList",t)},r.usingHeroBasePropertyFun=function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),o=1;o<e;o++)i[o-1]=arguments[o];if(this[t]&&"function"==typeof this[t])return this[t].apply(this,i);throw t+" is not fun or undefined"},r.getHeroBaseProperty=function(t){if(!this._heroData.hasOwnProperty(t))throw"不存在属性"+t;var e=this["_"+t+"Lv"];return e?this._heroData[t][e-1]:this._heroData[t][0]},r.getHeroBasePropertyLvDetail=function(t){if(!this._heroData.hasOwnProperty(t))throw"不存在属性"+t;return this._heroData[t]},r.getHeroBasePropertyCurLv=function(t){if(!this._heroData.hasOwnProperty(t))throw"不存在属性"+t;return console.log("property",t,this["_"+t+"Lv"]),this["_"+t+"Lv"]},r.upgradeBaseProperty=function(t){if(!this._heroData.hasOwnProperty(t))throw"不存在属性"+t;this["_"+t+"Lv"]++,this.savingLvData()},r.getTrainingData=function(t){var e=u.dispatch("getTempData","training");return null===e?this._trainingLvList[0][t]:0!==e.curLv?this._trainingLvList[e.curLv][t]:void 0},r.getAllAboutSkillBook=function(){return this.skillBookListJson.json},r.getSkillBookDataByIdOrName=function(t){if(this._skillBookList.hasOwnProperty(t))return this._skillBookList[t];throw t+" of _skillBookList is null"},r.getEquipmentDataByName=function(t){if(this._equipmentList.hasOwnProperty(t))return this._equipmentList[t];throw t+" of _equipmentList is null"},e}(l)).prototype,"heroPropertyDataJson",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=e(g.prototype,"trainingLvListJson",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=e(g.prototype,"skillBookListJson",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=e(g.prototype,"equipmentListJson",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=g))||_));r._RF.pop()}}}));

System.register("chunks:///_virtual/HeroCollider.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalData.ts"],(function(e){var t,o,r,n,i,a,l,s,c,u,f,h;return{setters:[function(e){t=e.inheritsLoose},function(e){o=e.cclegacy,r=e._decorator,n=e.BoxCollider2D,i=e.UITransform,a=e.Size,l=e.Contact2DType,s=e.Component},function(e){c=e.em},function(e){u=e.tagData,f=e.groupIndex,h=e.ggd}],execute:function(){var g;o._RF.push({},"5519573lqJDRowrqZ0eN66i","HeroCollider",void 0);var d=r.ccclass;r.property,e("HeroCollider",d("HeroCollider")(g=function(e){function o(){for(var t,o=arguments.length,r=new Array(o),n=0;n<o;n++)r[n]=arguments[n];return(t=e.call.apply(e,[this].concat(r))||this)._touchFireBallFire=!1,t}t(o,e);var r=o.prototype;return r.start=function(){this.openCollider()},r.openCollider=function(){var e=this.getComponent(n);e||(e=this.node.addComponent(n));var t=this.node.getComponent(i),o=new a(t.contentSize.x,t.contentSize.y);e.tag=u.hero,e.size=o,e.group=f.self,e.on(l.BEGIN_CONTACT,this.onBeginContact,this),e.on(l.END_CONTACT,this.onEndContact,this)},r.onBeginContact=function(e,t){switch(t.tag){case u.fireBall:this.fireBallAttackHero();break;case u.fireBallFire:this._touchFireBallFire=!0,this.fireBallFireAttackHero();break;case u.obstacle:console.log("碰撞障碍物 未处理");break;default:if([u.boss,u.monster,u.enemySkill].indexOf(t.tag)>-1)break;throw new Error("未处理的碰撞开始："+e.tag+"与"+t.tag+"发生碰撞")}},r.onEndContact=function(e,t){switch(t.tag){case u.fireBallFire:this._touchFireBallFire=!1;break;default:var o=u;if([o.boss,o.monster,o.fireBall,o.enemySkill,o.obstacle].indexOf(t.tag)>-1)break;throw new Error("未处理的碰撞结束："+e.tag+"与"+t.tag+"发生碰撞")}},r.fireBallAttackHero=function(){if(!h.stopAll){c.dispatch("usingHeroControlFun","createBossDamageTex",-10)}},r.fireBallFireAttackHero=function(){var e=this;if(!h.stopAll&&this._touchFireBallFire){c.dispatch("usingHeroControlFun","createBossDamageTex",-8);this.scheduleOnce((function(){e.fireBallFireAttackHero()}),.5)}},o}(s))||g);o._RF.pop()}}}));

System.register("chunks:///_virtual/HeroControl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalData.ts","./LevelManager.ts"],(function(e){var t,o,i,n,s,r,a,h,u,l,c,d,p,g,_,B,v,m,y,f,b,S,M,D,P;return{setters:[function(e){t=e.applyDecoratedDescriptor,o=e.inheritsLoose,i=e.initializerDefineProperty,n=e.assertThisInitialized,s=e.createForOfIteratorHelperLoose},function(e){r=e.cclegacy,a=e._decorator,h=e.Sprite,u=e.Node,l=e.JsonAsset,c=e.Label,d=e.input,p=e.Input,g=e.PhysicsSystem2D,_=e.EPhysics2DDrawFlags,B=e.find,v=e.Animation,m=e.Collider2D,y=e.Rect,f=e.game,b=e.Color,S=e.Component},function(e){M=e.em},function(e){D=e.ggd},function(e){P=e.LevelManager}],execute:function(){var A,H,x,w,C,R,T,F,L,k,I,E,O,W,G,U,z,J,N;r._RF.push({},"4ed82YzdmNLu7le/hYjoBZp","HeroControl",void 0);var V=a.ccclass,j=a.property;e("HeroControl",(A=V("HeroControl"),H=j(h),x=j(h),w=j(u),C=j(h),R=j(l),T=j(l),F=j(c),L=j(u),A((E=t((I=function(e){function t(){for(var t,o=arguments.length,s=new Array(o),r=0;r<o;r++)s[r]=arguments[r];return t=e.call.apply(e,[this].concat(s))||this,i(t,"bloodSprite",E,n(t)),i(t,"shieldSprite",O,n(t)),i(t,"heroSprite",W,n(t)),i(t,"expProgress",G,n(t)),i(t,"expDataJson",U,n(t)),i(t,"heroPropertyDataJson",z,n(t)),i(t,"lvDescription",J,n(t)),i(t,"GameUILayer",N,n(t)),t._spriteAnim=void 0,t._heroData=void 0,t._expData=void 0,t._curDirection={x:0,y:0},t._canMove=!1,t._LM=void 0,t._WM=void 0,t._baseBlood=void 0,t._bonusBlood=void 0,t._curBlood=void 0,t._maxShield=0,t._curShield=0,t._baseMoveSpeed=void 0,t._bonusMoveSpeed=void 0,t._baseDamage=void 0,t._bonusDamage=void 0,t._criticalHitRate=void 0,t._bonusCriticalHitRate=void 0,t._bonusBulletTotal=0,t._bonusBulletMoveSpeed=0,t._bonusBulletDuration=0,t._bonusBulletAttackTimes=0,t._recoveryHealthy=0,t._expAddition=0,t._divineStoneAddition=0,t._moveSpeedTimes=1,t._changeHeroMoveSpeedCountdown=0,t._tempCriticalHitRate=0,t._isDamageImmunity=!1,t._percentageDamage=void 0,t._percentageBlood=void 0,t._percentageMoveSpeed=void 0,t._bonusPercentageDamage=void 0,t._bonusPercentageBlood=void 0,t._bonusPercentageMoveSpeed=void 0,t._trackDisappearCountdown=0,t._openAutoScript=!1,t._deBuffList={banMove:!1},t}o(t,e);var r=t.prototype;return r.onDestroy=function(){M.remove("getHeroWorldPos"),M.remove("usingHeroControlFun"),M.remove("getHeroControlProperty"),d.off(p.EventType.TOUCH_START,this.touchStart,this),d.off(p.EventType.TOUCH_MOVE,this.touchMove,this),d.off(p.EventType.TOUCH_END,this.touchEnd,this)},r.onLoad=function(){M.add("getHeroWorldPos",this.getHeroWorldPos.bind(this)),M.add("usingHeroControlFun",this.usingHeroControlFun.bind(this)),M.add("getHeroControlProperty",this.getHeroControlProperty.bind(this)),d.on(p.EventType.TOUCH_START,this.touchStart,this),d.on(p.EventType.TOUCH_MOVE,this.touchMove,this),d.on(p.EventType.TOUCH_END,this.touchEnd,this),this.initHeroData(),this.initComponents(),this.initOutScripts(),this._curDirection={x:0,y:0},this.schedule(this.continueRecoveryHealthy,1)},r.openPhysicalDraw=function(){g.instance.enable=!0,g.instance.debugDrawFlags=_.Aabb|_.Pair|_.CenterOfMass|_.Joint|_.Shape},r.initHeroData=function(){this._heroData=this.heroPropertyDataJson.json[0],this.initExpData(),this.initHeroDataByLv(),this.updateBloodProgress(0)},r.initExpData=function(){this._expData=this.expDataJson.json;var e={level:1,maxLevel:this._expData.length,curExp:0,levelMappingExpList:this._expData};this._LM=new P(e),this.lvDescription.string="LV:"+this._LM.level},r.initHeroDataByLv=function(){console.log("hero data",this._heroData),this._baseBlood=M.dispatch("usingHeroBasePropertyFun","getTrainingData","blood"),this._baseMoveSpeed=M.dispatch("usingHeroBasePropertyFun","getTrainingData","moveSpeed"),this._baseMoveSpeed+=M.dispatch("usingHeroBasePropertyFun","getHeroBaseProperty","moveSpeed"),this._baseDamage=M.dispatch("usingHeroBasePropertyFun","getTrainingData","damage"),this._percentageBlood=M.dispatch("usingHeroBasePropertyFun","getHeroBaseProperty","percentageBlood"),this._percentageDamage=M.dispatch("usingHeroBasePropertyFun","getHeroBaseProperty","percentageDamage"),this._percentageMoveSpeed=M.dispatch("usingHeroBasePropertyFun","getHeroBaseProperty","percentageMoveSpeed"),this._criticalHitRate=M.dispatch("usingHeroBasePropertyFun","getHeroBaseProperty","criticalHitRate"),this._bonusBulletTotal=M.dispatch("usingHeroBasePropertyFun","getHeroBaseProperty","bonusBulletTotal"),this._bonusBulletMoveSpeed=M.dispatch("usingHeroBasePropertyFun","getHeroBaseProperty","bonusBulletMoveSpeed"),this._bonusBulletDuration=M.dispatch("usingHeroBasePropertyFun","getHeroBaseProperty","bonusBulletDuration"),this._bonusBulletAttackTimes=M.dispatch("usingHeroBasePropertyFun","getHeroBaseProperty","bonusBulletAttackTimes"),this._recoveryHealthy=M.dispatch("usingHeroBasePropertyFun","getHeroBaseProperty","recoveryHealthy"),this._expAddition=M.dispatch("usingHeroBasePropertyFun","getHeroBaseProperty","expAddition")/100,this._divineStoneAddition=M.dispatch("usingHeroBasePropertyFun","getHeroBaseProperty","divineStoneAddition")/100,this._bonusBlood=0,this._bonusMoveSpeed=0,this._bonusDamage=0,this._bonusCriticalHitRate=0,this._bonusPercentageBlood=0,this._bonusPercentageMoveSpeed=0,this._bonusPercentageDamage=0,this._curBlood=this.getMaxBlood(),this.updateBloodProgress(0),console.log("initHeroDataByLv",this)},r.getHeroPropertiesDes=function(){var e="基础血量："+this._baseBlood+"\n",t="基础移速："+this._baseMoveSpeed+"\n",o="基础伤害："+this._baseDamage+"\n",i="基础暴击率："+this._criticalHitRate+"\n",n="血量百分比加成："+this._percentageBlood+"\n",s="伤害百分比加成："+this._percentageDamage+"\n",r="移速百分比加成："+this._percentageMoveSpeed+"\n",a="额外血量："+this._bonusBlood+"\n",h="额外移速："+this._bonusMoveSpeed+"\n",u="额外伤害："+this._bonusDamage+"\n",l="额外暴击率："+this._bonusCriticalHitRate+"\n",c="额外血量百分比加成："+this._bonusPercentageBlood+"\n",d="额外移速百分比加成："+this._bonusPercentageMoveSpeed+"\n",p="额外伤害百分比加成："+this._bonusPercentageDamage+"\n",g="临时暴击率："+this._tempCriticalHitRate+"\n";return"当前血量："+this._curBlood+"/"+this.getMaxBlood()+"\n"+("当前护盾："+this._curShield+"\n")+("当前伤害："+this.getCurDamage()+"\n")+("当前移速："+this.getCurMoveSpeed()+"\n")+("当前暴击率："+this.getCurCHR()+"\n")+e+t+o+i+n+s+r+a+h+u+l+c+d+p+g},r.initComponents=function(){this._spriteAnim=B("sprite",this.node).getComponent(v)},r.initOutScripts=function(){this._WM=B("weapon",this.node).getComponent("WeaponManager")},r.update=function(e){this.heroMoveControl(e)},r.heroMoveControl=function(e){if(this._canMove&&!D.stopAll){var t=this._curDirection;M.dispatch("usingMapLayerFun","updateMap",t);var o=this.getCurMoveSpeed(),i=this.isCollideObs(t.x*e*o,t.y*e*o);i?this.node.setPosition(this.node.position.x+i.x,this.node.position.y+i.y):this.node.setPosition(this.node.position.x+t.x*e*o,this.node.position.y+t.y*e*o)}},r.isCollideObs=function(e,t){for(var o,i=M.dispatch("usingMapLayerFun","getAllObs"),n=this.heroSprite.getWorldPosition(),r=this.heroSprite.getComponent(m),a=new y(r.worldAABB.x+e,r.worldAABB.y+t,r.worldAABB.width,r.worldAABB.height),h=s(i);!(o=h()).done;){var u=o.value,l=u.node.getWorldPosition();if(!this.getTwoPointDistance(n,l>300)&&this.rectIsIntersectsRect(a,u.worldAABB)){if(0!==e&&0!==t)return a=new y(r.worldAABB.x+e,r.worldAABB.y,r.worldAABB.width,r.worldAABB.height),this.rectIsIntersectsRect(a,u.worldAABB)?(a=new y(r.worldAABB.x,r.worldAABB.y+t,r.worldAABB.width,r.worldAABB.height),!this.rectIsIntersectsRect(a,u.worldAABB)&&{x:0,y:t}):{x:e,y:0};if(0===e&&0!==t){if(a=new y(r.worldAABB.x,r.worldAABB.y+t,r.worldAABB.width,r.worldAABB.height),!this.rectIsIntersectsRect(a,u.worldAABB))return{x:0,y:t}}else{if(0===e||0!==t)return!1;if(a=new y(r.worldAABB.x+e,r.worldAABB.y,r.worldAABB.width,r.worldAABB.height),!this.rectIsIntersectsRect(a,u.worldAABB))return{x:e,y:0}}}}return!1},r.getTwoPointDistance=function(e,t){var o=e.x-t.x,i=e.y-t.y;return Math.sqrt(o*o+i*i)},r.rectIsIntersectsRect=function(e,t){return e.intersects(t)},r.changeMoveState=function(e){this._canMove=e},r.touchStart=function(){console.log("touchStart"),this._canMove=!0},r.touchMove=function(e){var t=e.touch.getStartLocation(),o=e.touch.getLocation(),i={x:void 0,y:void 0};i.x=o.x-t.x,i.y=o.y-t.y,0==i.x&&0==i.y||this.setDirByTouchOffset(i)},r.touchEnd=function(){console.log("touchEnd"),this._canMove=!1},r.setDirByTouchOffset=function(e){if(0==e.x)this._curDirection.x=0,this._curDirection.y=Math.abs(e.y)/e.y;else if(0==e.y)this._curDirection.x=Math.abs(e.x)/e.x,this._curDirection.y=0;else{var t=Math.abs(e.x/e.y);t>=1?(this._curDirection.x=Math.abs(e.x)/e.x,this._curDirection.y=1/t*Math.abs(e.y)/e.y):(this._curDirection.x=t*Math.abs(e.x)/e.x,this._curDirection.y=Math.abs(e.y)/e.y)}this._curDirection.x<=0?this.heroSprite.setScale(1,1,1):this.heroSprite.setScale(-1,1,1)},r.continueRecoveryHealthy=function(){D.stopAll||this.updateBloodProgress(this._recoveryHealthy)},r.usingHeroControlFun=function(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];if(this[e]&&"function"==typeof this[e])return this[e].apply(this,o);throw e+" is not fun or undefined"},r.getHeroControlProperty=function(e){if(this.hasOwnProperty(e))return this[e];throw"hero control 中不存在属性："+e},r.pauseGame=function(){this._spriteAnim.pause(),D.stopAll=!0,M.dispatch("usingMonsterManagerFun","pauseAllAnim"),M.dispatch("usingGameAnimManagerFun","pauseAllAnim")},r.resumeGame=function(){B("Canvas/heroLayer/GameUILayer/passRewardLayer").active||(this._spriteAnim.resume(),D.stopAll=!1,M.dispatch("usingMonsterManagerFun","resumeAllAnim"),M.dispatch("usingGameAnimManagerFun","resumeAllAnim"))},r.getHeroWorldPos=function(){return this.heroSprite.getWorldPosition()},r.getRandomPosNearHero=function(e){void 0===e&&(e=200);var t=this.heroSprite.getWorldPosition(),o=Math.random()*e|0,i=Math.random()*e|0;return o=Math.random()>.5?o:-o,i=Math.random()>.5?i:-i,{x:t.x+o,y:t.y+i}},r.updatePercentageBloodProgress=function(e){var t=this.getMaxBlood()*e;this.updateBloodProgress(t)},r.updateBloodProgress=function(e){e<0&&this._curShield>0?this.updateShieldProgress(e):(e<0&&M.dispatch("usingSkillManagerFun","resetLikeWindMoveTimes"),this._curBlood+=e,this._curBlood<0&&(this._curBlood=0,this.showGameOver()),this._curBlood>this.getMaxBlood()&&(this._curBlood=this.getMaxBlood()),this.bloodSprite.fillRange=this._curBlood/this.getMaxBlood())},r.updateShieldProgress=function(e){this._curShield+=e,this._curShield>0?this.shieldSprite.fillRange=this._curShield/this._maxShield:(this._curShield=0,this.shieldSprite.node.parent.active=!1,e-=this._curShield,this.updateBloodProgress(e))},r.openShield=function(e){this._maxShield=e,this._curShield=this._maxShield,this.shieldSprite.fillRange=this._curShield/this._maxShield,this.shieldSprite.node.parent.active=!0},r.showGameOver=function(){D.stopAll=!0,this._WM.isUsingSword(!1),this._spriteAnim.stop(),M.dispatch("endStage")},r.updateExpProgress=function(e){e*=1+this._expAddition,this._LM.addExp(e)&&(this.selectUpgradeReward(),this.updateBloodProgress(0));var t=this._LM.getExpProgress();this.expProgress.fillRange=t},r.selectUpgradeReward=function(){this.lvDescription.string="LV:"+this._LM.level,this.pauseGame(),B("selectWeapon",this.GameUILayer).active=!0,M.dispatch("updateSelectWeapon")},r.isPlayHeroAnim=function(e){e?(this._spriteAnim.resume(),console.log("继续播放")):(this._spriteAnim.pause(),console.log("停止播放"))},r.createBossDamageTex=function(e){this._isDamageImmunity||(M.dispatch("createDamageTex",this.node,e,{x:0,y:50}),this.updateBloodProgress(e))},r.restartGame=function(){D.stopAll=!1,f.restart()},r.updateBonusValue=function(e,t){console.log("刷新额外属性 ,还没写");var o="",i={1:.01,2:.02,3:.03,4:.04,5:.05};switch(e){case"blood":this._bonusPercentageBlood+=i[t],this._bonusPercentageBlood=(100*this._bonusPercentageBlood|0)/100;var n=(this._baseBlood+this._bonusBlood)*i[t]|0;this.updateBloodProgress(n),o="血量+"+100*i[t]+"%";break;case"damage":this._bonusPercentageDamage+=i[t],this._bonusPercentageDamage=(100*this._bonusPercentageDamage|0)/100,o="伤害+"+100*i[t]+"%";break;case"moveSpeed":this._bonusPercentageMoveSpeed+=i[t],this._bonusPercentageMoveSpeed=(100*this._bonusPercentageMoveSpeed|0)/100,o="移速+"+100*i[t]+"%";break;case"superArmor":this._bonusPercentageBlood+=i[t],this._bonusPercentageBlood=(100*this._bonusPercentageBlood|0)/100;var s=(this._baseBlood+this._bonusBlood)*i[t]|0;this.updateBloodProgress(s),o+="血量+"+100*i[t]+"%",this._bonusPercentageDamage+=i[t],this._bonusPercentageDamage=(100*this._bonusPercentageDamage|0)/100,o+="伤害+"+100*i[t]+"%";break;default:throw"strength type is error"}return o},r.openDamageImmunity=function(){this._isDamageImmunity=!0},r.getMaxBlood=function(){return(this._baseBlood+this._bonusBlood)*(1+this._bonusPercentageBlood+this._percentageBlood)|0},r.getCurMoveSpeed=function(){return this._deBuffList.banMove?0:(this._baseMoveSpeed+this._bonusMoveSpeed)*(this._moveSpeedTimes+this._bonusPercentageMoveSpeed+this._percentageMoveSpeed)+(0|M.dispatch("usingSkillManagerFun","getMoveSpeedFromSecretSkill"))},r.getCurDamage=function(){var e=this._baseDamage+this._bonusDamage,t=M.dispatch("usingSkillManagerFun","getDamageValueFromSecretSkill"),o=M.dispatch("usingSkillManagerFun","getPercentageDamageFromSecretSkill"),i=(e+t)*(1+this._bonusPercentageDamage+this._percentageDamage+o);return parseInt(i.toFixed())},r.getCurCHR=function(){return this._criticalHitRate+this._tempCriticalHitRate+this._bonusCriticalHitRate},r.isCriticalHit=function(){return 100*Math.random()<this.getCurCHR()},r.addDebuffBanMove=function(e){var t=this;console.log("addDebuffSlow"),this._deBuffList.banMove=!0;this.schedule((function o(){D.stopAll||--e<=0&&(t.unschedule(o),t._deBuffList.banMove=!1)}),1)},r.changeHeroMoveSpeed=function(e,t){this._moveSpeedTimes=e,this._changeHeroMoveSpeedCountdown=t,this.schedule(this.changeHeroMoveSpeedCountdownRun,1)},r.changeHeroMoveSpeedCountdownRun=function(){this._changeHeroMoveSpeedCountdown--,this._changeHeroMoveSpeedCountdown<=0&&(this._moveSpeedTimes=1,this._changeHeroMoveSpeedCountdown=0)},r.updateTempCriticalHitRate=function(e){this._tempCriticalHitRate+=e},r.updateBonusCriticalHitRate=function(e){this._bonusCriticalHitRate+=e},r.updateBonusMoveSpeed=function(e){this._bonusMoveSpeed+=e},r.isOpenCollectGas=function(e){B("effect/collectGasEffect",this.node).active=e},r.isOpenSnowEffect=function(e){B("effect/snowEffect",this.node).active=e},r.usingSkillTrackDisappear=function(e){this._trackDisappearCountdown=30,this._isDamageImmunity=!0,this._spriteAnim.play("trackDisappear"),this.unschedule(this.trackDisappearSchedule),this.schedule(this.trackDisappearSchedule,1)},r.trackDisappearSchedule=function(){D.stopAll||(this._trackDisappearCountdown--,this._trackDisappearCountdown<=0&&(this._isDamageImmunity=!1,this._spriteAnim.play("heroMove1"),this.node.getChildByName("sprite").getComponent(h).color=new b(255,255,255,255)))},r.usingSkillLionRoar=function(){var e=M.dispatch("usingMonsterManagerFun","getAllMonsterScript"),t=M.dispatch("usingHeroBasePropertyFun","getSkillBookDataByIdOrName","怒狮狂吼");e.forEach((function(e){e.getDistanceToHero()<300&&(e.monsterIsRepelled(150),e.addDebuffTimid(t.duration))}))},r.usingSkillIceShield=function(){var e=M.dispatch("usingHeroBasePropertyFun","getSkillBookDataByIdOrName","iceShield"),t=this.getMaxBlood()*e.damageTimes;this.openShield(t)},r.openHangupTest=function(){this._openAutoScript=!0,M.dispatch("usingWeaponManagerFun","usingMaxLvWeapon")},t}(S)).prototype,"bloodSprite",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=t(I.prototype,"shieldSprite",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W=t(I.prototype,"heroSprite",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G=t(I.prototype,"expProgress",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U=t(I.prototype,"expDataJson",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=t(I.prototype,"heroPropertyDataJson",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J=t(I.prototype,"lvDescription",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N=t(I.prototype,"GameUILayer",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=I))||k));r._RF.pop()}}}));

System.register("chunks:///_virtual/HeroInfoLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalFun.ts","./PoolManager.ts"],(function(e){var t,o,i,r,a,n,s,c,l,h,p,m,d,u,g,f,v,B,P,y,b,S,w,C;return{setters:[function(e){t=e.applyDecoratedDescriptor,o=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized,a=e.createForOfIteratorHelperLoose},function(e){n=e.cclegacy,s=e._decorator,c=e.SpriteFrame,l=e.Prefab,h=e.Node,p=e.find,m=e.NodePool,d=e.Sprite,u=e.Label,g=e.Color,f=e.tween,v=e.Vec3,B=e.ProgressBar,P=e.Slider,y=e.instantiate,b=e.Component},function(e){S=e.em},function(e){w=e.glf},function(e){C=e.plm}],execute:function(){var _,I,N,D,E,L,q,H,F,k,T,R,M,A,O;n._RF.push({},"506f9zuJdRKlbDiCkIyUYSC","HeroInfoLayer",void 0);var V=s.ccclass,Q=s.property;e("HeroInfoLayer",(_=V("HeroInfoLayer"),I=Q([c]),N=Q(l),D=Q(l),E=Q(h),L=Q(h),q=Q(h),_((k=t((F=function(e){function t(){for(var t,o=arguments.length,a=new Array(o),n=0;n<o;n++)a[n]=arguments[n];return t=e.call.apply(e,[this].concat(a))||this,i(t,"selectBtnSF",k,r(t)),i(t,"HPPrefab",T,r(t)),i(t,"itemPrefab",R,r(t)),i(t,"HPPrefabPar",M,r(t)),i(t,"itemPrefabPar",A,r(t)),i(t,"maskPar",O,r(t)),t._curSelectItemData=void 0,t._tipsViewNode=void 0,t._itemPrefabArr=[],t._btnArr=[],t._HPNode=void 0,t._SSNode=void 0,t._EQNode=void 0,t._eqBtnList={},t._equPrefab=void 0,t._layerNode=[],t._config=["percentageBlood","percentageDamage","percentageMoveSpeed","moveSpeed","criticalHitRate","bonusBulletTotal","bonusBulletMoveSpeed","bonusBulletDuration","bonusBulletAttackTimes","recoveryHealthy","expAddition","divineStoneAddition"],t._nameConfig={percentageBlood:"血量百分比加成",percentageDamage:"伤害百分比加成",percentageMoveSpeed:"移速百分比加成",moveSpeed:"基础移速",criticalHitRate:"暴击率",bonusBulletTotal:"法宝额外数量",bonusBulletMoveSpeed:"法宝额外飞行速度",bonusBulletDuration:"法宝额外持续时间",bonusBulletAttackTimes:"法宝穿透次数",recoveryHealthy:"基础生命恢复",expAddition:"经验加成",divineStoneAddition:"灵石加成"},t._rewardConfig=void 0,t.关闭展示获得物品界面=void 0,t}o(t,e);var n=t.prototype;return n.onLoad=function(){this._btnArr.push(p("bg/selectBtnPar/btn1",this.node)),this._btnArr.push(p("bg/selectBtnPar/btn2",this.node)),this._btnArr.push(p("bg/selectBtnPar/btn3",this.node)),this._HPNode=p("/heroProperty",this.node),this._SSNode=p("/storageSpace",this.node),this._EQNode=p("/equipment",this.node),this._layerNode.push(this._HPNode,this._SSNode,this._EQNode),this._tipsViewNode=p("/heroProperty/tipsViewShow",this.node),C.addPoolToPools("SSLItemPrefab",new m,this.itemPrefab);var e=p("gets/itemPrefab",this.node);C.addPoolToPools("SSLGetsItemPrefab",new m,e);var t=p("/switchEquipment/selectEquPrefab",this._EQNode);C.addPoolToPools("ELItemPrefab",new m,t),this.initRewardConfig()},n.initRewardConfig=function(){this._rewardConfig={"一阶宝箱":["一阶妖丹","一阶道法果","一阶功法残卷","灵石","炼气丹","一阶功法整卷"],"一阶宝箱Ratio":[30,5,5,500,5,.5],"二阶宝箱":["二阶妖丹","二阶道法果","二阶功法残卷","灵石","筑基丹","二阶功法整卷"],"二阶宝箱Ratio":[30,5,4,5e3,5,.3],"三阶宝箱":["三阶妖丹","三阶道法果","三阶功法残卷","灵石","金元丹","三阶功法整卷"],"三阶宝箱Ratio":[30,5,3,5e4,5,.1],"四阶宝箱":["四阶妖丹","四阶道法果","四阶功法残卷","灵石","元婴丹","四阶功法整卷"],"四阶宝箱Ratio":[30,5,1,5e5,5,.1],"五阶宝箱":["五阶妖丹","五阶道法果","五阶功法残卷","灵石","化神丹","五阶功法整卷"],"五阶宝箱Ratio":[30,5,1,5e6,5,.1],"一阶功法整卷":[],"一阶功法整卷Ratio":[],"二阶功法整卷":[],"二阶功法整卷Ratio":[],"三阶功法整卷":[],"三阶功法整卷Ratio":[]};var e=S.dispatch("usingHeroBasePropertyFun","getAllAboutSkillBook");for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var o=e[t];switch(o.lv){case 1:this._rewardConfig.一阶功法整卷.push(o.name),this._rewardConfig.一阶功法整卷Ratio.push(o.rareRatio);break;case 2:this._rewardConfig.二阶功法整卷.push(o.name),this._rewardConfig.二阶功法整卷Ratio.push(o.rareRatio);break;case 3:this._rewardConfig.三阶功法整卷.push(o.name),this._rewardConfig.三阶功法整卷Ratio.push(o.rareRatio);break;default:throw"暂未处理："+o.lv+"阶功法。"}}console.log("_rewardConfig",this._rewardConfig)},n.onEnable=function(){this.onSelectBtn(null,"1"),p("/itemDetail/ProgressBar",this.node).active=!1,p("/itemDetail",this.node).active=!1},n.start=function(){this.initHeroProperty()},n.initHeroProperty=function(){for(var e=this,t=function(){var t=e._config[o],i=S.dispatch("usingHeroBasePropertyFun","getHeroBasePropertyCurLv",t),r=y(e.HPPrefab);r.parent=e.HPPrefabPar;var a=r.getChildByName("icon").getComponent(d),n="images/icons/icon_"+t+"/spriteFrame";S.dispatch("loadTheDirResources",n,(function(e){return a.spriteFrame=e})),r.getChildByName("description").getComponent(u).string="Lv:"+i+"\n"+e._nameConfig[t],r.getChildByName("value").getComponent(u).string=S.dispatch("usingHeroBasePropertyFun","getHeroBaseProperty",t);var s=r.getChildByName("upgrade");w.createButton(e.node,r.getChildByName("icon"),"HeroInfoLayer","onBtnBaseProperty",t),w.createButton(e.node,s,"HeroInfoLayer","onBtnUpgrade",t)},o=0;o<this._config.length;o++)t()},n.onSelectBtn=function(e,t){switch(null!==e&&S.dispatch("playOneShot","common/通用按键"),this.updateBtnSF(parseInt(t)-1),t){case"1":this.onBtn1();break;case"2":this.onBtn2();break;case"3":this.onBtn3();break;default:throw"p is err,current p is "+t}},n.updateBtnSF=function(e){var t=this;this._btnArr.forEach((function(o,i){i==e?(o.getComponent(d).spriteFrame=t.selectBtnSF[1],o.getChildByName("Label").getComponent(u).color=new g(255,204,0,255)):(o.getComponent(d).spriteFrame=t.selectBtnSF[0],o.getChildByName("Label").getComponent(u).color=new g(255,255,255,255))}))},n.onBtn1=function(){this.openLayer(this._HPNode)},n.onBtn2=function(){this.updateStorageSpace(),this.openLayer(this._SSNode)},n.onBtn3=function(){this.openLayer(this._EQNode)},n.openLayer=function(e){this._layerNode.forEach((function(t){t.active=e==t}))},n.onBtnBaseProperty=function(e,t){console.log("p",t);var o=this.getUpgradeDescription(t);this.tipsViewShow(o,3)},n.onBtnUpgrade=function(e,t){var o=this.isCanUpgrade(t);if(o){S.dispatch("reduceItemFromSS",o,1),S.dispatch("usingHeroBasePropertyFun","upgradeBaseProperty",t);var i=S.dispatch("usingHeroBasePropertyFun","getHeroBasePropertyCurLv",t),r=S.dispatch("usingHeroBasePropertyFun","getHeroBaseProperty",t),a=e.target.parent;a.getChildByName("description").getComponent(u).string="Lv:"+i+"\n"+this._nameConfig[t],a.getChildByName("value").getComponent(u).string=r}},n.isCanUpgrade=function(e){var t=S.dispatch("usingHeroBasePropertyFun","getHeroBasePropertyCurLv",e);if(t>=50)return S.dispatch("tipsViewShow","已到达最大等级 无法升级"),!1;var o="",i=Math.ceil(t/10);switch(i){case 1:o="一阶道法果";break;case 2:o="二阶道法果";break;case 3:o="三阶道法果";break;case 4:o="四阶道法果";break;case 5:o="五阶道法果";break;default:console.warn("itemLv is "+i)}return S.dispatch("getItemTotalByIdOrName",o)>0?o:(S.dispatch("tipsViewShow",o+"不足,无法升级"),!1)},n.getUpgradeDescription=function(e){var t=S.dispatch("usingHeroBasePropertyFun","getHeroBasePropertyCurLv",e),o=S.dispatch("usingHeroBasePropertyFun","getHeroBasePropertyLvDetail",e);console.log("lv",t),console.log("lvDetail",o);var i="";return o.forEach((function(e,t){i+=t+1+":"+e+", "})),i},n.tipsViewShow=function(e,t){void 0===e&&(e="请传参"),void 0===t&&(t=1),this._tipsViewNode.children[0].getComponent(u).string=e;var o=f().to(.5,{scale:new v(1,1,1)},{onUpdate:function(e,t){var o=e.getComponent(d).color;e.getComponent(d).color=g.lerp(new g,o,new g(o.r,o.g,o.b,255),t)}}),i=f().to(.5,{scale:new v(1,1,1)},{onUpdate:function(e,t){var o=e.getComponent(d).color;e.getComponent(d).color=g.lerp(new g,o,new g(o.r,o.g,o.b,0),t)}}),r=f().delay(t);f(this._tipsViewNode).sequence(o,r,i).start()},n.updateStorageSpace=function(){for(var e=this;this._itemPrefabArr.length>0;){var t=this._itemPrefabArr.shift();C.putToPool("SSLItemPrefab",t)}var o=S.dispatch("getItemList"),i=function(){var t=o[r],i=S.dispatch("getItemDataByIdOrName",r),a=C.getFromPool("SSLItemPrefab");a.parent=e.itemPrefabPar;var n=a.getChildByName("sprite").getComponent(d),s="images/items/"+i.loadUrl+"/spriteFrame";S.dispatch("loadTheDirResources",s,(function(e){return n.spriteFrame=e})),a.getChildByName("description").getComponent(u).string=i.description,a.getChildByName("name").getComponent(u).string=i.name+"X"+t,e._itemPrefabArr.push(a),w.createButton(e.node,n,"HeroInfoLayer","onBtnItem",r)};for(var r in o)i()},n.onBtnItem=function(e,t){console.log("onBtnItem",t);var o=S.dispatch("getItemDataByIdOrName",t);switch(this._curSelectItemData=o,o.type){case"材料":this.showItemDetail([0]);break;case"功法":case"丹药":case"道法果":case"消耗品":this.showItemDetail([0,1]);break;case"others":console.log("others 还没写");break;case"可合成材料":this.showItemDetail([2]);break;default:console.warn("未处理的类型："+o.type)}},n.showItemDetail=function(e){console.log("showItemDetail",this._curSelectItemData),this.maskPar.getChildByName("name").getComponent(u).string=this._curSelectItemData.name,this.maskPar.getChildByName("description").getComponent(u).string=this._curSelectItemData.description,this.maskPar.getChildByName("btnPar").children.forEach((function(t,o){e.indexOf(o)>-1?t.active=!0:t.active=!1})),this.maskPar.active=!0},n.onBtnSell=function(){this.showProgressBar(),this.showItemDetail([3,4])},n.onBtnConfirmSell=function(){console.log("确定卖出");var e=p("/itemDetail/ProgressBar",this.node).getComponent(B).progress,t=this._curSelectItemData,o=S.dispatch("getItemTotalByIdOrName",t.name);o=Math.floor(o*e);var i=t.price*o;console.log("卖出物品总数："+o),console.log("卖出物品总价格："+i),S.dispatch("reduceItemFromSS",t.name,o),S.dispatch("addItemToSS","灵石",i),this.updateStorageSpace(),this.maskPar.active=!1,this.closeProgressBar()},n.onBtnCancelSell=function(){this.closeProgressBar()},n.showProgressBar=function(){var e=p("/itemDetail/ProgressBar",this.node);e.getComponent(B).progress=0,e.getComponent(P).progress=0;var t=S.dispatch("getItemTotalByIdOrName",this._curSelectItemData.name);e.getChildByName("Label").getComponent(u).string="数量：0/"+t+"\n价格：0",e.active=!0},n.closeProgressBar=function(){p("/itemDetail/ProgressBar",this.node).active=!1},n.slideProgressBar=function(e){var t=p("/itemDetail/ProgressBar",this.node),o=e.progress;t.getComponent(B).progress=o;var i=S.dispatch("getItemTotalByIdOrName",this._curSelectItemData.name),r=Math.floor(i*o),a=r*this._curSelectItemData.price;t.getChildByName("Label").getComponent(u).string="数量："+r+"/"+i+"\n价格："+a},n.onBtnUsing=function(){switch(this._curSelectItemData.type){case"道法果":return this.closeItemDetail(),void this.onSelectBtn(null,"1");case"丹药":return this.closeItemDetail(),void S.dispatch("switchMainMenuLayer",null,"3");case"功法":return this.closeItemDetail(),void S.dispatch("switchMainMenuLayer",null,"5");default:console.warn("未处理的类型"+this._curSelectItemData.type)}S.dispatch("reduceItemFromSS",this._curSelectItemData.name,1),this.maskPar.active=!1;var e=this._curSelectItemData.name,t=this._rewardConfig[e],o=this._rewardConfig[e+"Ratio"],i={};if(o.every((function(e){return e<=1}))){for(var r,a=Math.random(),n=0;n<o.length;n++){if(o[n]>=a){r=n;break}}i[t[r]]=1}else for(var s=0;s<t.length;s++){var c=t[s],l=o[s];if(l>1){var h=Math.random()*l|0;h>0&&(i[c]=h)}else Math.random()<l&&(i[c]=1)}for(var p in console.log("gets",i),this.showGets(i),i)Object.prototype.hasOwnProperty.call(i,p)&&(console.log("key",p),S.dispatch("addItemToSS",p,i[p]));this.updateStorageSpace()},n.showGets=function(e){console.log("显示获得物品 还没写"),p("gets",this.node).active=!0;var t=p("gets/bg/ScrollView/view/content",this.node),o=function(){if(Object.prototype.hasOwnProperty.call(e,i)){var o=e[i],r=S.dispatch("getItemDataByIdOrName",i),a=C.getFromPool("SSLGetsItemPrefab");a.active=!0,a.parent=t;var n=a.getComponent(d),s="images/items/"+r.loadUrl+"/spriteFrame";S.dispatch("loadTheDirResources",s,(function(e){return n.spriteFrame=e})),a.getChildByName("name").getComponent(u).string=r.name+"x"+o}};for(var i in e)o()},n.onBtnMerge=function(){this.maskPar.active=!1;var e=this._curSelectItemData,t=S.dispatch("getItemTotalByIdOrName",e.name);if(t<e.mergeDemandTotal)S.dispatch("tipsViewShow",e.name+"数量不足，无法合成");else{var o=Math.floor(t/e.mergeDemandTotal),i=o*e.mergeDemandTotal;S.dispatch("reduceItemFromSS",e.name,i),S.dispatch("addItemToSS",e.mergeTarget,o);var r={};r[e.mergeTarget]=o,this.showGets(r),this.updateStorageSpace()}},n.closeGets=function(){p("gets",this.node).active=!1;for(var e=p("gets/bg/ScrollView/view/content",this.node);e.children.length;){var t=e.children[0];t.removeFromParent(),C.putToPool("SSLGetsItemPrefab",t)}},n.closeItemDetail=function(){this.maskPar.active=!1},n.initEquipment=function(){this._equPrefab=p("/equ",this._EQNode);for(var e=p("/bg/ScrollView/view/content",this._EQNode),t=0,o=["法器","法袍","鞋子","法宝1","法宝2","法宝3","符箓1","符箓2","符箓3"];t<o.length;t++){var i=o[t],r=y(this._equPrefab);r.parent=e,r.getChildByName("Label").getComponent(u).string=i,this._eqBtnList[i]=r,w.createButton(this.node,r.getChildByName("addEqBtn"),"HeroInfoLayer","onBtnEquipmentFrame",i)}console.log("this._eqBtnList",this._eqBtnList);this.updateEqShowBtn(["法器","法袍","鞋子","法宝1","法宝2","法宝3","符箓1","符箓2","符箓3"])},n.updateEqShowBtn=function(e){for(var t,o=a(e);!(t=o()).done;){var i=t.value;this._eqBtnList[i].active=!0}},n.onBtnEquipmentFrame=function(e,t){console.log("点击装备栏:"+t),p("/switchEquipment",this._EQNode).active=!0,this.initSwitchEquipment(t)},n.initSwitchEquipment=function(e){var t=this;console.log("initSwitchEquipment"),console.log("显示切换装备界面,type is "+e);var o=p("/switchEquipment/bg/ScrollView/view/content",this._EQNode);["回春剑","两仪巨剑","落日弓","清风袍","月影袍","月影鞋","清风鞋","流云鞋"].forEach((function(i){var r=S.dispatch("usingHeroBasePropertyFun","getEquipmentDataByName",i);if(r.type===e){var a=C.getFromPool("ELItemPrefab",!0);a.parent=o,console.log("equName:",i),console.log("prefab",a);var n=a.getComponent(d);a.getChildByName("name").getComponent(u).string=r.name;var s="images/items/"+r.loadUrl+"/spriteFrame";S.dispatch("loadTheDirResources",s,(function(e){return n.spriteFrame=e})),w.createButton(t.node,a,"HeroInfoLayer","showEquipmentDetail",r.name)}}))},n.showEquipmentDetail=function(e,t){var o=S.dispatch("usingHeroBasePropertyFun","getEquipmentDataByName",t),i=p("/switchEquipment/equDetail",this._EQNode);i.getChildByName("equName").getComponent(u).string=o.name,i.getChildByName("equBaseProperties").getComponent(u).string=this.getEquipmentBasePropertiesDescription(o),i.active=!0},n.getEquipmentBasePropertiesDescription=function(e){var t="";return e.damage&&(t+="伤害："+e.damage+"\n"),e.moveSpeed&&(t+="移速："+e.moveSpeed+"\n"),e.blood&&(t+="血量："+e.blood+"\n"),e.defense&&(t+="防御："+e.defense+"\n"),e.duration&&(t+="飞行道具持续时间："+e.duration),t},n.closeEquipmentDetail=function(){p("/switchEquipment/equDetail",this._EQNode).active=!1},n.switchEquipment=function(e,t){console.log("切换武器 还没写"),this.closeSwitchEquipment()},n.closeSwitchEquipment=function(){console.log("closeSwitchEquipment"),p("/switchEquipment",this._EQNode).active=!1,p("/switchEquipment/equDetail",this._EQNode).active=!1;for(var e=p("/switchEquipment/bg/ScrollView/view/content",this._EQNode);e.children.length>0;){var t=e.children[0];t.removeFromParent(),C.putToPool("ELItemPrefab",t)}},t}(b)).prototype,"selectBtnSF",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=t(F.prototype,"HPPrefab",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=t(F.prototype,"itemPrefab",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=t(F.prototype,"HPPrefabPar",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=t(F.prototype,"itemPrefabPar",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=t(F.prototype,"maskPar",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H=F))||H));n._RF.pop()}}}));

System.register("chunks:///_virtual/HeroWeapon.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var o,t,n,r;return{setters:[function(e){o=e.inheritsLoose},function(e){t=e.cclegacy,n=e._decorator,r=e.Component}],execute:function(){var c;t._RF.push({},"e8855FX8i9K5KSg1caZAyvx","HeroWeapon",void 0);var p=n.ccclass;n.property,e("HerpWeapon",p("HeroWeapon")(c=function(e){function t(){return e.apply(this,arguments)||this}o(t,e);var n=t.prototype;return n.start=function(){},n.update=function(e){},t}(r))||c);t._RF.pop()}}}));

System.register("chunks:///_virtual/HttpRequest.ts",["cc"],(function(e){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"feea6/nvANI9aAqPuZStDYe","HttpRequest",void 0);e("hr",new(function(){function e(){console.log("创建http请求")}var t=e.prototype;return t.get=function(e,t,o,n,l){void 0===n&&(n=null),void 0===l&&(l=null);var a=new XMLHttpRequest,r=t,u="?";for(var s in r){var c=s+"="+r[s];u+="?"==u?c:"&"+c}console.log("get:请求路径",e+u),a.open("GET",e+u),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),this.xhrBindCallback(a,o,n,l),a.send()},t.post=function(e,t,o,n,l){if("object"!=typeof t)return console.log("参数不是对象 传输错误");var a=new XMLHttpRequest;console.log("post:请求路径",e),a.open("POST",e),a.setRequestHeader("Content-Type","application/json"),this.xhrBindCallback(a,o,n,l),console.log(t),a.send(JSON.stringify(t))},t.xhrBindCallback=function(e,t,o,n){var l=this;e.onreadystatechange=function(){if(4==e.readyState)if(e.status>=200&&e.status<=207){var o=JSON.parse(e.responseText);console.log("bug"),t?t(o):l.runDefaultCompleteCallback(o)}else console.log("xhr.status",e.status)},e.onerror=function(){1==e.readyState&&0==e.status?o?o("断网"):l.runDefaultErrorCallback("断网"):o?o("未知错误"):l.runDefaultErrorCallback("未知错误")},e.timeout=6e4,e.ontimeout=function(e){n?n(e):l.runDefaultTimeoutCallback(e)}},t.runDefaultCompleteCallback=function(e){console.log("run Default Complete Callback"),console.log("response",e)},t.runDefaultErrorCallback=function(e){console.log("run Default Error Callback"),console.log("string",e)},t.runDefaultTimeoutCallback=function(e){console.log("run default timeout callback"),console.log("e",e)},e}()));t._RF.pop()}}}));

System.register("chunks:///_virtual/IceCone.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalData.ts","./Weapon.ts"],(function(t){var e,i,n,o,a,s;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,n=t._decorator},function(t){o=t.em},function(t){a=t.tagData},function(t){s=t.Weapon}],execute:function(){var c;i._RF.push({},"9e8786GKzVCk5+Ipdf+NqEC","IceCone",void 0);var r=n.ccclass;n.property,t("IceCone",r("IceCone")(c=function(t){function i(){return t.apply(this,arguments)||this}e(i,t);var n=i.prototype;return n.init=function(t,e){this.initSkillData(t,e),o.dispatch("playOneShot","battle/frozen")},n.initSkillData=function(t,e){this._damage=t.damage,this._duration=t.duration,this._moveSpeed=t.moveSpeed,this._canAttackTimes=t.canAttackTimes,this._backDis=0,this._attackInterval=.5,this._weaponName=t.name,this._flyDir=e,this.clearCacheData(),this.initBoxCollider(a.sword),this.changeBulletRotationByFlyDir()},n.colliderMonster=function(t){if(!this.isStopRun(t)&&!this.isHasAttacked(t.node.uuid)){this.updateMonsterBlood(t),this._hasAttackedEnemies.push(t.node.uuid),this._canAttackTimes--,console.log("冻结目标  还没写");var e=t.node.getComponent("Monster");e&&e.addDebuffFrozen(5),this._canAttackTimes<=0&&this.recoveryToPool()}},i}(s))||c);i._RF.pop()}}}));

System.register("chunks:///_virtual/ItemManager.ts",["cc"],(function(t){var i;return{setters:[function(t){i=t.cclegacy}],execute:function(){i._RF.push({},"6c3eaMSS1FJZpq6wdRN9a3f","ItemManager",void 0);t("ItemManger",function(){function t(){this._itemList={}}var i=t.prototype;return i.addItem=function(t,i){this._itemList.hasOwnProperty(t)?this._itemList[t]+=i:this.addNewItemToList(t,i)},i.addNewItemToList=function(t,i){this._itemList[t]=i},i.reduceItem=function(t,i){return!!this._itemList.hasOwnProperty(t)&&(!!this.itemIsEnough(t,i)&&(this._itemList[t]-=i,0===this._itemList[t]&&this.clearItemFromList(t),!0))},i.itemIsEnough=function(t,i){return this._itemList.hasOwnProperty(t)&&this._itemList[t]>=i},i.clearItemFromList=function(t){delete this._itemList[t]},i.getItemTotal=function(t){return this._itemList.hasOwnProperty(t)?this._itemList[t]:0},t}());i._RF.pop()}}}));

System.register("chunks:///_virtual/JustOneSwordDivideWorld.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalData.ts","./Weapon.ts"],(function(t){var i,e,s,n,a,o,l;return{setters:[function(t){i=t.inheritsLoose},function(t){e=t.cclegacy,s=t._decorator,n=t.Vec2},function(t){a=t.em},function(t){o=t.tagData},function(t){l=t.Weapon}],execute:function(){var h;e._RF.push({},"5e483mBHcFKd7tMJmx5es+4","JustOneSwordDivideWorld",void 0);var r=s.ccclass;s.property,t("JustOneSwordDivideWorld",r("JustOneSwordDivideWorld")(h=function(t){function e(){return t.apply(this,arguments)||this}i(e,t);var s=e.prototype;return s.init=function(t){this.initSkillData(t),this.playThisWeaponAudio(3)},s.playThisWeaponAudio=function(t){for(var i=0;i<t;i++)this.scheduleOnce((function(){a.dispatch("playOneShot","battle/spell")}),i)},s.initSkillData=function(t){this._damage=t.damage,this._duration=1/0,this._moveSpeed=0,this._canAttackTimes=1/0,this._backDis=0,this._attackInterval=.5,this._weaponName="未命名",this._flyDir=new n(-.25,-1),this.clearCacheData(),this.initBoxCollider(o.sword),this.changeBulletRotationByFlyDir()},s.colliderMonster=function(t){this.isStopRun(t)||this.isHasAttacked(t.node.uuid)||(this.updateMonsterBlood(t),this._hasAttackedEnemies.push(t.node.uuid),this._canAttackTimes--,this._canAttackTimes<=0&&this.recoveryToPool())},s.changeBulletRotationByFlyDir=function(){if(0!=this._flyDir.x||0!=this._flyDir.y)if(0!=this._flyDir.x)if(0!=this._flyDir.y){var t=Math.sqrt(this._flyDir.x*this._flyDir.x+this._flyDir.y*this._flyDir.y),i=Math.sin(Math.abs(this._flyDir.y)/t),e=90*Math.asin(i);this._flyDir.y>0?this._flyDir.x>0?this.node.angle=180+e:this.node.angle=360-e:this._flyDir.x>0?this.node.angle=180-e:this.node.angle=e}else this._flyDir.x>0?this.node.angle=180:this.node.angle=0;else this._flyDir.y>0?this.node.angle=-90:this.node.angle=90},e}(l))||h);e._RF.pop()}}}));

System.register("chunks:///_virtual/LevelManager.ts",["cc"],(function(e){var i;return{setters:[function(e){i=e.cclegacy}],execute:function(){i._RF.push({},"0208bjby31EyYWzQE6+eHxF","LevelManager",void 0);e("LevelManager",function(){function e(e){this.level=void 0,this.maxLevel=void 0,this.curExp=void 0,this.maxExp=void 0,this.levelMappingExpList=void 0,this.level=e.level,this.maxLevel=e.maxLevel,this.curExp=e.curExp,this.levelMappingExpList=e.levelMappingExpList,this.maxExp=this.levelMappingExpList[this.maxLevel-1].exp,console.log("levelManager",this)}var i=e.prototype;return i.addExp=function(e){return console.log("this.curExp ",this.curExp),console.log("this.maxExp  ",this.maxExp),console.log("num",e),this.curExp>=this.maxExp||this.level>=this.maxLevel?console.log("经验已满"):(this.curExp+=e,this.curExp>=this.maxExp&&(this.curExp=this.maxExp),this.isUpgrade()?(this.upgrade(),!0):void 0)},i.isUpgrade=function(){return this.curExp>=this.levelMappingExpList[this.level].exp},i.upgrade=function(){for(var e,i=this.maxLevel,t=this.level+1;t<i;t++){var s=this.levelMappingExpList[t-1].exp;if(s>this.curExp){e=t-1;break}t==i-1&&s<=this.curExp&&(e=this.maxLevel)}var l=e-this.level;this.level=e,console.log("等级+"+l)},i.getExpProgress=function(){if(1==this.level)return this.curExp/this.levelMappingExpList[this.level].exp;var e=this.levelMappingExpList[this.level-1].exp,i=this.levelMappingExpList[this.level-0].exp;return(this.curExp-e)/(i-e)},e}());i._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./debug-view-runtime-control.ts","./MonsterParNode.ts","./PassRewardLayer.ts","./Boss.ts","./Boss1.ts","./Boss2.ts","./Boss3.ts","./Boss4.ts","./BossN.ts","./Monster.ts","./MonsterData.ts","./MonsterLeader.ts","./MonsterManager.ts","./BlackHole.ts","./DarkMask.ts","./EnemySkill.ts","./GreenThunder.ts","./CommonCallback.ts","./GameAnimManager.ts","./StageManager.ts","./EventManager.ts","./HttpRequest.ts","./PoolManager.ts","./Queue.ts","./globalData.ts","./globalFun.ts","./FriendControl.ts","./HeroCollider.ts","./HeroControl.ts","./HeroWeapon.ts","./CurrentRoundMessage.ts","./GameSettings.ts","./Darts.ts","./FanPrefab.ts","./FireBloom.ts","./Guard.ts","./HellFire.ts","./IceCone.ts","./JustOneSwordDivideWorld.ts","./MoveLikeFire.ts","./SamadhiTrueFire.ts","./SkillManager.ts","./Spell.ts","./Sword.ts","./SwordRain.ts","./ThousandsSwordToTomb.ts","./Weapon.ts","./weaponManager.ts","./MapLayer.ts","./ShowLayer.ts","./HeroInfoLayer.ts","./MainMenu.ts","./MakePillsLayer.ts","./PrizeHallLayer.ts","./SelectStageLayer.ts","./SkillBookLayer.ts","./TrainingLayer.ts","./Canvas.ts","./DynamicLoading.ts","./PreLoad.ts","./AD_SDK.ts","./GameMonetize.com-SDK.ts","./testAds.ts","./AudioManager.ts","./HeroBaseProperty.ts","./ItemManager.ts","./LevelManager.ts","./SavingManager.ts","./StorageSpace.ts","./TipView.ts","./helpLayer.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/MainMenu.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts"],(function(e){var t,n,a,r,o,i,s,c,h,l,u,p,d,y;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,a=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){o=e.cclegacy,i=e._decorator,s=e.SpriteFrame,c=e.find,h=e.director,l=e.Sprite,u=e.Label,p=e.Color,d=e.Component},function(e){y=e.em}],execute:function(){var L,_,m,S,v;o._RF.push({},"4e87avhPWxNFp2OmdXxirn8","MainMenu",void 0);var N=i.ccclass,b=i.property;e("MainMenu",(L=N("MainMenu"),_=b([s]),L((v=t((S=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o))||this,a(t,"selectBtnSF",v,r(t)),t._btnArr=[],t._layerNode=[],t._SSLNode=void 0,t._HILNode=void 0,t._TLNode=void 0,t._MPNode=void 0,t._SBNode=void 0,t._PHNode=void 0,t}n(t,e);var o=t.prototype;return o.onDestroy=function(){y.remove("switchMainMenuLayer")},o.onLoad=function(){y.add("switchMainMenuLayer",this.onSelectBtn.bind(this)),this._btnArr.push(c("Canvas/menuLayer/selectBtnPar/btn1")),this._btnArr.push(c("Canvas/menuLayer/selectBtnPar/btn2")),this._btnArr.push(c("Canvas/menuLayer/selectBtnPar/btn3")),this._btnArr.push(c("Canvas/menuLayer/selectBtnPar/btn4")),this._btnArr.push(c("Canvas/menuLayer/selectBtnPar/btn5")),this._btnArr.push(c("Canvas/menuLayer/selectBtnPar/btn6")),this._SSLNode=c("Canvas/menuLayer/SelectStageLayer"),this._HILNode=c("Canvas/menuLayer/HeroInfoLayer"),this._TLNode=c("Canvas/menuLayer/TrainingLayer"),this._MPNode=c("Canvas/menuLayer/MakePillsLayer"),this._SBNode=c("Canvas/menuLayer/SkillBookLayer"),this._PHNode=c("Canvas/menuLayer/PrizeHallLayer"),this._layerNode.push(this._SSLNode,this._HILNode,this._TLNode,this._MPNode,this._SBNode,this._PHNode),this.onSelectBtn(null,"1"),h.preloadScene("game")},o.onSelectBtn=function(e,t){switch(this.updateBtnSF(parseInt(t)-1),t){case"1":null!==e&&y.dispatch("playOneShot","common/进入试炼场"),this.openLayer(this._SSLNode);break;case"2":null!==e&&y.dispatch("playOneShot","common/点击人物界面"),this.openLayer(this._HILNode);break;case"3":null!==e&&y.dispatch("playOneShot","common/点击修行界面"),this.openLayer(this._TLNode);break;case"4":null!==e&&y.dispatch("playOneShot","common/点击炼丹界面"),this.openLayer(this._MPNode);break;case"5":null!==e&&y.dispatch("playOneShot","common/点击秘籍界面"),this.openLayer(this._SBNode);break;case"6":this.openLayer(this._PHNode);break;default:throw"p is err,current p is "+t}},o.updateBtnSF=function(e){var t=this;this._btnArr.forEach((function(n,a){a==e?(n.getComponent(l).spriteFrame=t.selectBtnSF[1],n.getChildByName("Label").getComponent(u).color=new p(255,204,0,255)):(n.getComponent(l).spriteFrame=t.selectBtnSF[0],n.getChildByName("Label").getComponent(u).color=new p(255,255,255,255))}))},o.openLayer=function(e){this._layerNode.forEach((function(t){t.active=e==t}))},t}(d)).prototype,"selectBtnSF",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=S))||m));o._RF.pop()}}}));

System.register("chunks:///_virtual/MakePillsLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalFun.ts","./PoolManager.ts"],(function(e){var t,i,a,n,l,o,r,s,m,c,u,p,h,d,g,P,f,b,_;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,a=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){l=e.cclegacy,o=e._decorator,r=e.Prefab,s=e.SpriteFrame,m=e.Node,c=e.find,u=e.NodePool,p=e.instantiate,h=e.Sprite,d=e.Label,g=e.Color,P=e.Component},function(e){f=e.em},function(e){b=e.glf},function(e){_=e.plm}],execute:function(){var I,y,D,C,L,v,N,B,S,F,T;l._RF.push({},"55a8d2wX7hDXZkw04oDRSeH","MakePillsLayer",void 0);var M=o.ccclass,w=o.property;e("MakePillsLayer",(I=M("MakePillsLayer"),y=w(r),D=w(r),C=w([s]),L=w(m),I((B=t((N=function(e){function t(){for(var t,i=arguments.length,l=new Array(i),o=0;o<i;o++)l[o]=arguments[o];return t=e.call.apply(e,[this].concat(l))||this,a(t,"pillPrefab",B,n(t)),a(t,"itemPrefab",S,n(t)),a(t,"pillSF",F,n(t)),a(t,"itemPar",T,n(t)),t._curPillData=void 0,t._pillPar=void 0,t._pillPrefabArr=[],t._itemPrefabArr=[],t._pillListConfig=[{id:4,name:"炼气丹",imageIndex:0,description:"提升修为，通过妖丹炼制",consumeTotal:10,consumeItemName:"一阶妖丹",consumeLingshi:50},{id:5,name:"筑基丹",imageIndex:1,description:"提升修为，通过妖丹炼制",consumeTotal:10,consumeItemName:"二阶妖丹",consumeLingshi:500},{id:6,name:"金元丹",imageIndex:2,description:"提升修为，通过妖丹炼制",consumeTotal:10,consumeItemName:"三阶妖丹",consumeLingshi:5e3},{id:7,name:"元婴丹",imageIndex:3,description:"提升修为，通过妖丹炼制",consumeTotal:10,consumeItemName:"四阶妖丹",consumeLingshi:5e4},{id:8,name:"化神丹",imageIndex:4,description:"提升修为，通过妖丹炼制",consumeTotal:10,consumeItemName:"五阶妖丹",consumeLingshi:5e5}],t}i(t,e);var l=t.prototype;return l.onLoad=function(){this._pillPar=c("/selectPill/sliding/content",this.node),_.addPoolToPools("MPLItemPrefab",new u,this.itemPrefab),this.initPillList(),this._curPillData=this._pillListConfig[0],this.updatePillState(this._pillPrefabArr[0])},l.initPillList=function(){var e=this;this._pillListConfig.forEach((function(t,i){var a=p(e.pillPrefab);a.parent=e._pillPar,a.getChildByName("sprite").getComponent(h).spriteFrame=e.pillSF[t.imageIndex],a.getChildByName("name").getComponent(d).string=t.name,a.data=t,b.createButton(e.node,a,"MakePillsLayer","onBtnPill"),e._pillPrefabArr.push(a)}))},l.onEnable=function(){this.updatePillsContent(),this.updateMaterialDemand()},l.onBtnPill=function(e){var t=e.target;this._curPillData=t.data,console.log("_curPillData",this._curPillData),f.dispatch("playOneShot","common/通用按键"),this.updatePillState(t),this.updateMaterialDemand()},l.updatePillState=function(e){this._pillPrefabArr.forEach((function(t){t.getChildByName("name").getComponent(d).color=t===e?new g(255,204,0,255):new g(0,0,0,255)}))},l.updateMaterialDemand=function(){console.log("this._curPillData ",this._curPillData);var e=c("/stove/m1",this.node),t=c("/stove/m2",this.node),i=f.dispatch("getItemDataByIdOrName",this._curPillData.consumeItemName),a=f.dispatch("getItemDataByIdOrName","灵石"),n=f.dispatch("getItemTotalByIdOrName",this._curPillData.consumeItemName),l=f.dispatch("getItemTotalByIdOrName","灵石"),o=e.getChildByName("sprite").getComponent(h),r=t.getChildByName("sprite").getComponent(h);f.dispatch("loadTheDirResources","images/items/"+i.loadUrl+"/spriteFrame",(function(e){return o.spriteFrame=e})),f.dispatch("loadTheDirResources","images/items/"+a.loadUrl+"/spriteFrame",(function(e){return r.spriteFrame=e}));var s=e.getChildByName("Label").getComponent(d),m=t.getChildByName("Label").getComponent(d);s.string=i.name+"\n"+n+"/"+this._curPillData.consumeTotal,m.string=a.name+"\n"+l+"/"+this._curPillData.consumeLingshi},l.onBtnMakePill=function(){f.dispatch("playOneShot","common/炼制丹药");var e=f.dispatch("itemIsEnough",this._curPillData.consumeItemName,this._curPillData.consumeTotal),t=f.dispatch("itemIsEnough","灵石",this._curPillData.consumeLingshi);if(console.log("itemIsEnough",e),console.log("lingshiIsEnough",t),e&&t)f.dispatch("reduceItemFromSS",this._curPillData.consumeItemName,this._curPillData.consumeTotal),f.dispatch("reduceItemFromSS","灵石",this._curPillData.consumeLingshi),console.log(this._curPillData.name+"+1"),console.log("刷新背包"),f.dispatch("addItemToSS",this._curPillData.id,1),this.updatePillsContent(),this.updateMaterialDemand();else{var i="";i=e||t?e?"灵石不足，无法炼制。":"妖丹不足，无法炼制。":"妖丹和灵石不足，无法炼制。",f.dispatch("tipsViewShow",i)}},l.updatePillsContent=function(){var e=this;for(console.log("updatePillsContent");this._itemPrefabArr.length>0;){var t=this._itemPrefabArr.shift();_.putToPool("MPLItemPrefab",t)}var i=f.dispatch("getAllPills"),a=function(){if(Object.prototype.hasOwnProperty.call(i,n)){var t=i[n],a=_.getFromPool("MPLItemPrefab");a.parent=e.itemPar;var l=f.dispatch("getItemDataByIdOrName",n);a.getChildByName("name").getComponent(d).string=l.name+"\nX"+t;var o=a.getChildByName("sprite").getComponent(h),r="images/items/"+l.loadUrl+"/spriteFrame";f.dispatch("loadTheDirResources",r,(function(e){return o.spriteFrame=e})),e._itemPrefabArr.push(a)}};for(var n in i)a()},t}(P)).prototype,"pillPrefab",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=t(N.prototype,"itemPrefab",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F=t(N.prototype,"pillSF",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=t(N.prototype,"itemPar",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=N))||v));l._RF.pop()}}}));

System.register("chunks:///_virtual/MapLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalData.ts"],(function(t){var e,i,n,o,s,r,a,h,l,p,f,u,c,g,d,m,y,z,b,_,M,P,w,S;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,o=t.assertThisInitialized,s=t.createForOfIteratorHelperLoose},function(t){r=t.cclegacy,a=t._decorator,h=t.SpriteFrame,l=t.Prefab,p=t.Material,f=t.find,u=t.Size,c=t.UITransform,g=t.Sprite,d=t.instantiate,m=t.BoxCollider2D,y=t.Vec3,z=t.Rect,b=t.Vec2,_=t.Component},function(t){M=t.em},function(t){P=t.tagData,w=t.groupIndex,S=t.ggd}],execute:function(){var v,L,x,C,F,O,I,W,T,B,A,H,R;r._RF.push({},"809f5M75tREzYR8m406FnB9","MapLayer",void 0);var D=a.ccclass,E=a.property;t("MapLayer",(v=D("MapLayer"),L=E(h),x=E(l),C=E([h]),F=E(p),O=E(p),v((T=e((W=function(t){function e(){for(var e,i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];return e=t.call.apply(t,[this].concat(s))||this,n(e,"defaultBgSF",T,o(e)),n(e,"obstaclePrefab",B,o(e)),n(e,"obsSFs",A,o(e)),n(e,"frozenMaterial",H,o(e)),n(e,"normalMaterial",R,o(e)),e.mapList=[],e._mapSize=void 0,e._changeOffset=700,e._obsColliderArr=[],e._frozenCountdown=0,e._frozenTotalTime=0,e._frozenSlowTimes=0,e}i(e,t);var r=e.prototype;return r.onDestroy=function(){M.remove("usingMapLayerFun"),M.remove("getMapLayerProperty")},r.onLoad=function(){M.add("usingMapLayerFun",this.usingMapLayerFun.bind(this)),M.add("getMapLayerProperty",this.getMapLayerProperty.bind(this)),this.mapList.push(f("bg1",this.node)),this.mapList.push(f("bg2",this.node)),this.mapList.push(f("bg3",this.node)),this.mapList.push(f("bg4",this.node))},r.start=function(){this.initBg(),this.initObstacles()},r.initBg=function(){if(!this.defaultBgSF)throw"default bg is null";this._mapSize=new u(3*this.defaultBgSF.originalSize.x,3*this.defaultBgSF.originalSize.y),console.log("this._mapSize",this._mapSize);for(var t=0;t<this.mapList.length;t++){var e=this.mapList[t];e.getComponent(c).setContentSize(this._mapSize),e.getComponent(g).spriteFrame=this.defaultBgSF}var i=M.dispatch("getHeroWorldPos");this.mapList[0].setWorldPosition(i),this.mapList[1].setWorldPosition(i.x+this._mapSize.x,i.y,i.z),this.mapList[2].setWorldPosition(i.x,i.y+this._mapSize.y,i.z),this.mapList[3].setWorldPosition(i.x+this._mapSize.x,i.y+this._mapSize.y,i.z)},r.initObstacles=function(){var t=this;this.mapList.forEach((function(e){for(var i=[[2,2],[2,3],[2,4],[2,5],[2,6],[2,7],[3,2],[3,3],[3,4],[3,5],[3,6],[3,7],[4,2],[4,3],[4,6],[4,7],[5,2],[5,3],[5,6],[5,7],[6,2],[6,3],[6,4],[6,5],[6,6],[6,7],[7,2],[7,3],[7,4],[7,5],[7,6],[7,7]],n=0;n<10;n++){var o=i.splice(Math.random()*i.length|0,1)[0];t.addObstacle(e,o)}}))},r.addObstacle=function(t,e){var i=d(this.obstaclePrefab),n=new u(-this._mapSize.width/2,-this._mapSize.height/2);i.parent=t,i.setPosition(200*e[0]+n.width,200*e[1]+n.height),i.getComponent(g).spriteFrame=this.obsSFs[0];var o=i.addComponent(m),s=i.getComponent(c),r=new u(1*s.contentSize.x/2,1*s.contentSize.y/2);o.tag=P.obstacle,o.size=r,o.group=w.obstacle,this._obsColliderArr.push(o)},r.usingMapLayerFun=function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];if(this[t]&&"function"==typeof this[t])return this[t].apply(this,i);throw t+" is not fun or undefined"},r.getMapLayerProperty=function(t){if(this.hasOwnProperty(t))return this[t];throw"hero control 中不存在属性："+t},r.getAllObs=function(){return this._obsColliderArr},r.frozenMap=function(t,e){console.log("frozenMap"),this._frozenCountdown=t,this._frozenTotalTime=t,this._frozenSlowTimes=e,M.dispatch("usingHeroControlFun","isOpenSnowEffect",!0),this.unschedule(this.frozenCountdownRun),this.frozenMaterial.setProperty("frozenProgress",0),this.schedule(this.frozenCountdownRun,1);for(var i,n=s(this.mapList);!(i=n()).done;){i.value.getComponent(g).material=this.frozenMaterial}},r.frozenCountdownRun=function(){if(!S.stopAll){this._frozenCountdown--;var t=1-this._frozenCountdown/this._frozenTotalTime;this.frozenMaterial.setProperty("frozenProgress",t),console.log("this._frozenCountdown",this._frozenCountdown),this._frozenCountdown<=0&&(console.log("冻结结束"),M.dispatch("usingHeroControlFun","isOpenSnowEffect",!1),this._frozenCountdown=0,this.unschedule(this.frozenCountdownRun),this.recoveryMapNormalState())}},r.recoveryMapNormalState=function(){for(var t,e=s(this.mapList);!(t=e()).done;){t.value.getComponent(g).material=this.normalMaterial}},r.updateMap=function(t){var e=this.getCurPosMap();if(!this.heroIsNearbyMapEdge()){var i=this.getFarthestMap(),n=this.getFarthestMapInitPos(),o=e.getWorldPosition(),s=new y(o.x+this._mapSize.x*n.x,o.y+this._mapSize.y*n.y,o.z);i.setWorldPosition(s)}},r.getCurPosMap=function(){for(var t=M.dispatch("getHeroWorldPos"),e=0;e<this.mapList.length;e++){var i=this.mapList[e];if(this.thePointIsInsideMap(i,t))return i}throw"hero is outside map."},r.thePointIsInsideMap=function(t,e){var i=t.getWorldPosition();return new z(i.x-this._mapSize.x/2,i.y-this._mapSize.y/2,this._mapSize.x,this._mapSize.y).contains(e)},r.thePointIsInsideAnyMap=function(t){var e=this;return this.mapList.some((function(i){return e.thePointIsInsideMap(i,t)}))},r.heroIsNearbyMapEdge=function(){var t=this,e=M.dispatch("getHeroWorldPos");return!this.getThePointNearbyPoint(e).some((function(e){return!t.mapList.some((function(i){return t.thePointIsInsideMap(i,e)}))}))},r.getFarthestMap=function(){for(var t=M.dispatch("getHeroWorldPos"),e=this.mapList[0],i=this.mapList[0].getWorldPosition(),n=(i.x-t.x)*(i.x-t.x)+(i.y-t.y)*(i.y-t.y),o=1;o<this.mapList.length;o++){var s=this.mapList[o],r=s.getWorldPosition(),a=(r.x-t.x)*(r.x-t.x)+(r.y-t.y)*(r.y-t.y);a>n&&(n=a,e=s)}return e},r.getFarthestMapInitPos=function(){for(var t,e=M.dispatch("getHeroWorldPos"),i=this.getThePointNearbyPoint(e),n=0;n<i.length;n++){var o=i[n];if(!this.thePointIsInsideAnyMap(o)){t=o,console.log(n);break}}var s=t.subtract(e);return console.log("getFarthestMapInitPos",s),new b(s.x/Math.abs(s.x),s.y/Math.abs(s.y))},r.getThePointNearbyPoint=function(t){return[new b(t.x+this._changeOffset,t.y),new b(t.x,t.y+this._changeOffset),new b(t.x-this._changeOffset,t.y),new b(t.x,t.y-this._changeOffset),new b(t.x+this._changeOffset,t.y+this._changeOffset),new b(t.x-this._changeOffset,t.y+this._changeOffset),new b(t.x-this._changeOffset,t.y-this._changeOffset),new b(t.x+this._changeOffset,t.y-this._changeOffset)]},e}(_)).prototype,"defaultBgSF",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=e(W.prototype,"obstaclePrefab",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=e(W.prototype,"obsSFs",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H=e(W.prototype,"frozenMaterial",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=e(W.prototype,"normalMaterial",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=W))||I));r._RF.pop()}}}));

System.register("chunks:///_virtual/Monster.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalData.ts","./PoolManager.ts","./MonsterData.ts"],(function(t){var e,i,o,n,r,s,a,d,l,u,h,c,f,p,m,g,y,v,_,A,C,b,M,w;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,o=t.initializerDefineProperty,n=t.assertThisInitialized,r=t.createForOfIteratorHelperLoose},function(t){s=t.cclegacy,a=t._decorator,d=t.Material,l=t.Animation,u=t.BoxCollider2D,h=t.UITransform,c=t.Size,f=t.Contact2DType,p=t.Sprite,m=t.Collider2D,g=t.Rect,y=t.Component},function(t){v=t.em},function(t){_=t.ggd,A=t.tagData,C=t.groupIndex,b=t.attackInterval},function(t){M=t.plm},function(t){w=t.monsterData}],execute:function(){var B,D,x,z,S,T,P,L,I,k,W;s._RF.push({},"668ee8+QZZCoZGzSXap1See","Monster",void 0);var R=a.ccclass,F=a.property;t("Monster",(B=R("Monster"),D=F(d),x=F(d),z=F(d),S=F(d),B((L=e((P=function(t){function e(){for(var e,i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,o(e,"flashWhiteMaterial",L,n(e)),o(e,"defaultMaterial_normal",I,n(e)),o(e,"defaultMaterial_green",k,n(e)),o(e,"debuff_frozen",W,n(e)),e._defaultMaterial=void 0,e._canAttack=!0,e._banTouch=!1,e._curMonsterData=null,e._maxBlood=1,e._curBlood=1,e._attackInterval=1,e._isSuperArmor=!1,e._type="normal",e._curMoveSpeedTimes=1,e._frontCount=0,e._behindCount=0,e._remainingDuration=0,e._diedAnimProgress=0,e._debuffList={timid:{state:!1,duration:0,damage:.5,moveSpeed:.5},frozen:{state:!1,duration:0,damage:0,moveSpeed:0}},e}i(e,t);var s=e.prototype;return s.init=function(t){"normal"==t.color?this._defaultMaterial=this.defaultMaterial_normal:this._defaultMaterial=this.defaultMaterial_green,this.recoveryDefaultMaterial(),this._curMonsterData=t,this.initMonsterMoveAnim(t),this._maxBlood=t.maxBlood,this._curBlood=t.maxBlood,this.initCollider(),this.startCountdown(120)},s.startCountdown=function(t){this._remainingDuration=t,this.unschedule(this.durationCountdown),this.schedule(this.durationCountdown,1)},s.durationCountdown=function(){_.stopAll||(this._remainingDuration--,this.runOthers(),this._remainingDuration<=0&&(M.putToPool("monsterChild",this.node),this.unschedule(this.durationCountdown)))},s.runOthers=function(){if(v.dispatch("getMapLayerProperty","_frozenCountdown")>0){var t=.05*this._maxBlood|0,e=v.dispatch("usingHeroControlFun","getCurDamage");e=Math.floor(.05*e)+t,v.dispatch("createDamageTex",this.node,e,{x:0,y:20}),this.updateBlood(e)}},s.initMonsterMoveAnim=function(t){var e=this,i="monster"+t.animKey,o=v.dispatch("getMonsterAnimByAnimKey",i);o?this.node.getComponent(l).defaultClip=o:v.dispatch("loadTheDirResources","/anim/enemy/monster/"+i,(function(t){e.node.getComponent(l).defaultClip=t}))},s.initCollider=function(){var t=this.getComponent(u);t||(t=this.node.addComponent(u));var e=this.node.getComponent(h),i=new c(e.contentSize.x/2,e.contentSize.y/2);t.tag=A.monster,t.size=i,t.group=C.enemy,t.on(f.BEGIN_CONTACT,this.onBeginContact,this)},s.updateBlood=function(t,e){void 0===e&&(e=0),v.dispatch("playOneShot","battle/怪物受击"),this._curBlood+=t,this._curBlood<=0?this.monsterDied():this.monsterIsRepelled(e)},s.monsterDied=function(){M.putToPool("monsterChild",this.node),v.dispatch("usingHeroControlFun","updateExpProgress",100),v.dispatch("updateKillCountLabel",1),this.afterMonsterDied()},s.afterMonsterDied=function(){v.dispatch("usingSkillManagerFun","add_bloodMakeMeStrongTimes");var t=v.dispatch("usingSkillManagerFun","getRecoveryBloodFromSecretSkill");v.dispatch("usingHeroControlFun","updateBloodProgress",t)},s.monsterIsRepelled=function(t){if(this.flashWhite(),!this._isSuperArmor){var e=v.dispatch("getHeroWorldPos"),i=this.node.getWorldPosition();i.subtract3f(e.x,e.y,e.z).normalize();var o=this.node.getPosition();this.node.setPosition(o.x+t*i.x,o.y+t*i.y,0)}},s.getDistanceToHero=function(){var t=v.dispatch("getHeroWorldPos"),e=this.node.getWorldPosition();return this.getTwoPointDistance(t,e)},s.flashWhite=function(){this.unschedule(this.recoveryNormalState),this.node.getComponent(p).material=this.flashWhiteMaterial;this._banTouch=!0,this.scheduleOnce(this.recoveryNormalState,.1)},s.frozenEffect=function(){this.node.getComponent(p).material=this.debuff_frozen,this.pauseAnim()},s.recoveryNormalState=function(){this._banTouch=!1,this._debuffList.frozen.state||(this.recoveryDefaultMaterial(),this.resumeAnim())},s.recoveryDefaultMaterial=function(){this.node.getComponent(p).material=this._defaultMaterial},s.collectToTarget=function(t,e){if(e){var i=e.node.getWorldPosition(),o=t.node.getWorldPosition();i.subtract3f(o.x,o.y,o.z).normalize();var n=this.node.getPosition();this.node.setPosition(n.x+20*i.x,n.y+20*i.y,0)}},s.recoveryDefault=function(){console.log("recoveryDefault")},s.isCollideObs=function(t,e){for(var i,o=v.dispatch("usingMapLayerFun","getAllObs"),n=this.node.getWorldPosition(),s=this.node.getComponent(m),a=new g(s.worldAABB.x+t,s.worldAABB.y+e,s.worldAABB.width,s.worldAABB.height),d=r(o);!(i=d()).done;){var l=i.value,u=l.node.getWorldPosition();if(!this.getTwoPointDistance(n,u>300)&&this.rectIsIntersectsRect(a,l.worldAABB))return!0}return!1},s.move=function(t){if(!_.stopAll){var e=v.dispatch("getHeroWorldPos");if(!this.isTouchingHero()&&0!=this._curMoveSpeedTimes){var i=this.node.getWorldPosition(),o=e.x-i.x,n=e.y-i.y,r=Math.sqrt(o*o+n*n),s=w.minGapWithHero2;if("leader"==this._type&&(s*=5),r>=s){var a=this.getMonsterCurMoveSpeed(),d=0==a?0:r/a,l=0==d?0:t/d*o,u=0==d?0:t/d*n,h=this.dynamicAvoidCollider();if(h){var c=this.getNewDirWhenCollideObstacle(l,u,h);this.node.setWorldPosition(i.x+c.x*t,i.y+c.y*t,0)}else this.node.setWorldPosition(i.x+l,i.y+u,0)}}}},s.dynamicAvoidCollider=function(){for(var t,e=this.getComponent(u),i=v.dispatch("getHeroWorldPos"),o=e.node.getWorldPosition(),n=v.dispatch("getAllMonsterColliders"),s=r(n);!(t=s()).done;){var a=t.value;if(a!==e&&this.rectIsIntersectsRect(a.worldAABB,e.worldAABB))if(this.getTwoPointDistance(i,o)>this.getTwoPointDistance(i,a.node.getWorldPosition()))return a}for(var d,l=v.dispatch("usingMapLayerFun","getAllObs"),h=r(l);!(d=h()).done;){var c=d.value;if(this.rectIsIntersectsRect(c.worldAABB,e.worldAABB))if(this.getTwoPointDistance(i,o)>this.getTwoPointDistance(i,c.node.getWorldPosition()))return c}return null},s.getTwoPointDistance=function(t,e){var i=t.x-e.x,o=t.y-e.y;return Math.sqrt(i*i+o*o)},s.getNewDirWhenCollideObstacle=function(t,e,i){var o=this._curMonsterData.moveSpeed*w.MSCoefficient*this._curMoveSpeedTimes;t=0===t?0:Math.abs(t)/t*o,e=0===e?0:Math.abs(e)/e*o;var n=this.getComponent(u).worldAABB;if(0!==t&&0!==e){var r=new g(n.x+t,n.y,n.width,n.height);if(this.isCollideExceptRawCollider(r,i)){var s=new g(n.x,n.y+e,n.width,n.height);return this.isCollideExceptRawCollider(s,i)?{x:0,y:0}:{x:0,y:e}}return{x:t,y:0}}if(0===t&&0!==e){var a=e,d=-e,l=new g(n.x+a,n.y,n.width,n.height);if(this.isCollideExceptRawCollider(l,i)){var h=new g(n.x+d,n.y,n.width,n.height);return this.isCollideExceptRawCollider(h,i)?{x:0,y:0}:{x:d,y:0}}return{x:a,y:0}}if(0!==t&&0===e){var c=t,f=-t,p=new g(n.x,n.y+c,n.width,n.height);if(this.isCollideExceptRawCollider(p,i)){var m=new g(n.x,n.y+f,n.width,n.height);return this.isCollideExceptRawCollider(m,i)?{x:0,y:0}:{x:0,y:f}}return{x:0,y:c}}return{x:0,y:0}},s.isCollideExceptRawCollider=function(t,e){for(var i,o=this.getComponent(u),n=v.dispatch("getAllMonsterColliders"),s=r(n);!(i=s()).done;){var a=i.value;if(a!==o&&this.rectIsIntersectsRect(a.worldAABB,t))return!0}for(var d,l=v.dispatch("usingMapLayerFun","getAllObs"),h=r(l);!(d=h()).done;){var c=d.value;if(c!==e&&this.rectIsIntersectsRect(c.worldAABB,t))return!0}return!1},s.onBeginContact=function(t,e){if(!_.stopAll&&!this._banTouch&&t.tag!=e.tag)switch(e.tag){case A.hero:this.monsterAttackHeroByCollide(t,e);break;case A.friend1Skill1:this.friendAttackMonsterByFriend1Skill1(t,e);break;case A.obstacle:this.ejectMonsterInObstacle(t.worldAABB,e.worldAABB)}},s.rectIsIntersectsRect=function(t,e){return t.intersects(e)},s.isTouchingHero=function(){var t=this.getComponent(u),e=v.dispatch("getHeroControlProperty","node").getChildByName("sprite").getComponent(u);return this.rectIsIntersectsRect(t.worldAABB,e.worldAABB)},s.monsterAttackHeroByCollide=function(t,e){var i=this;_.stopAll?this.scheduleOnce((function(){i._canAttack=!0,i.monsterAttackHeroByCollide(t,e)}),this._attackInterval):this.rectIsIntersectsRect(t.worldAABB,e.worldAABB)&&this._canAttack&&(this._canAttack=!1,v.dispatch("createMonsterDamageTex",e.node,this.getMonsterCurDamage()),this.scheduleOnce((function(){i._canAttack=!0,i.monsterAttackHeroByCollide(t,e)}),this._attackInterval))},s.friendAttackMonsterByFriend1Skill1=function(t,e){var i=this;if(!_.stopAll&&this.rectIsIntersectsRect(t.worldAABB,e.worldAABB)){v.dispatch("createDamageTex",t.node,5,{x:0,y:20}),this.updateBlood(-5,0),this.collectToTarget(t,e),this.scheduleOnce((function(){i.friendAttackMonsterByFriend1Skill1(t,e)}),b.f1s1)}},s.update=function(t){this.move(t),this.updateSpriteDirection()},s.updateSpriteDirection=function(){if(!this._debuffList.frozen.state){var t=v.dispatch("getHeroWorldPos").x-this.node.getWorldPosition().x,e=this.node.getScale();t>0?this.node.setScale(-Math.abs(e.x),e.y,e.z):t<0&&this.node.setScale(Math.abs(e.x),e.y,e.z)}},s.pauseAnim=function(){this.node.getComponent(l).pause()},s.resumeAnim=function(){_.stopAll||this._debuffList.frozen.state||this.node.getComponent(l).resume()},s.getMonsterCurDamage=function(){if(this._debuffList.frozen.state)return this._debuffList.frozen.damage;var t=this._curMonsterData.damage;return this._debuffList.timid.state&&(t*=this._debuffList.timid.damage),t},s.getMonsterCurMoveSpeed=function(){if(this._debuffList.frozen.state)return this._debuffList.frozen.moveSpeed;var t=this._curMonsterData.moveSpeed*w.MSCoefficient*this._curMoveSpeedTimes;(this._debuffList.timid.state&&(t*=this._debuffList.timid.moveSpeed),v.dispatch("getMapLayerProperty","_frozenCountdown")>0)&&(t*=1-v.dispatch("getMapLayerProperty","_frozenSlowTimes"));return t},s.addDebuffTimid=function(t){if(t<=0)throw"addDebuffTimid err,t must > 0";this._debuffList.timid.state=!0,this._debuffList.timid.duration=t,this.unschedule(this.reduceDebuffTimid),this.scheduleOnce(this.reduceDebuffTimid,1)},s.reduceDebuffTimid=function(){_.stopAll||(this._debuffList.timid.duration--,this._debuffList.timid.duration<=0&&(this._debuffList.timid.state=!1,this.unschedule(this.reduceDebuffTimid)))},s.addDebuffFrozen=function(t){if(t<=0)throw"addDebuffTimid err,t must > 0";v.dispatch("playOneShot","battle/frozen"),this._debuffList.frozen.state=!0,this._debuffList.frozen.duration=t,this.frozenEffect(),this.unschedule(this.reduceDebuffFrozen),this.schedule(this.reduceDebuffFrozen,1)},s.reduceDebuffFrozen=function(){_.stopAll||(this._debuffList.frozen.duration--,this._debuffList.frozen.duration<=0&&(console.log("解除冻结状态"),this._debuffList.frozen.state=!1,this.recoveryNormalState(),this.unschedule(this.reduceDebuffFrozen)))},s.ejectMonsterInObstacle=function(t,e){},e}(y)).prototype,"flashWhiteMaterial",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=e(P.prototype,"defaultMaterial_normal",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=e(P.prototype,"defaultMaterial_green",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W=e(P.prototype,"debuff_frozen",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=P))||T));s._RF.pop()}}}));

System.register("chunks:///_virtual/MonsterData.ts",["cc"],(function(r){var t;return{setters:[function(r){t=r.cclegacy}],execute:function(){t._RF.push({},"30144h3bq1FZq7sGzjXg5LP","MonsterData",void 0);var e=100,i=100,c={xLine:function(r,t){if(void 0===t&&(t=0),r<=0||r%1!=0||r%2==0)throw new Error("参数错误 小于1 或为非整数 或为非偶数");for(var i=Math.floor(r/2),c=[],n=0;n<r;n++)c.push([(-i+n)*e,t]);return c},yLine:function(r,t){if(void 0===t&&(t=0),r<=0||r%1!=0||r%2==0)throw new Error("参数错误 小于1 或为非整数 或为偶数");for(var e=Math.floor(r/2),c=[],n=0;n<r;n++)c.push([t,(-e+n)*i]);return c},triR:function(r){if(r<=0||r%1!=0||r%2==0)throw new Error("参数错误 小于1 或为非整数 或为非偶数");for(var t=Math.floor(r/2),c=[],n=0;n<r;n++)n<=t?c.push([n*e,(t-n)*i]):c.push([(r-n-1)*e,(t-n)*i]);return c},triL:function(r){if(r<=0||r%1!=0||r%2==0)throw new Error("参数错误 小于1 或为非整数 或为非偶数");for(var t=Math.floor(r/2),c=[],n=0;n<r;n++)n<=t?c.push([(t-n)*e,(t-n)*i]):c.push([(n-t)*e,(t-n)*i]);return c},triU:function(r){if(r<=0||r%1!=0||r%2==0)throw new Error("参数错误 小于1 或为非整数 或为非偶数");for(var t=Math.floor(r/2),c=[],n=0;n<r;n++)n<=t?c.push([(t-n)*e,(t-n)*i]):c.push([(t-n)*e,(n-t)*i]);return c},triD:function(r){if(r<=0||r%1!=0||r%2==0)throw new Error("参数错误 小于1 或为非整数 或为非偶数");for(var t=Math.floor(r/2),c=[],n=0;n<r;n++)n<=t?c.push([(t-n)*e,-(t-n)*i]):c.push([(t-n)*e,-(n-t)*i]);return c},circle:function(r,t){if(t<4)throw"圆上点数过少 请输入大于4的数字";if(t%4!=0)throw"生成的在圆上的点的总数错误，不是4的倍数"+t;for(var e=t/4,i=[],c=1;c<e;c++){var n=r*Math.sin(Math.PI/180*c/e*90),o=Math.sqrt(r*r-n*n);i.push([o,n],[o,-n],[-o,n],[-o,-n])}return i.push([0,r],[0,-r],[r,0],[-r,0]),i},heart:function(r,t){if(t<20)throw"total过小，无法生成心形方程";var e=2*Math.PI/t;r/=16;for(var i=[];t;){var c=e*t,n=16*Math.pow(Math.sin(c),3),o=13*Math.cos(c)-5*Math.cos(2*c)-2*Math.cos(3*c)-Math.cos(4*c);n*=r,o*=r,i.push([n,o]),t--}return i},rect:function(r,t){if(t>0&&t%4!=0)throw"total 必须是大于0的4的倍数.";var e=t/4,i=[],n=c.xLine(e,r),o=c.xLine(e,-r),h=c.yLine(e,r),a=c.yLine(e,-r);return n.forEach((function(r){return i.push(r)})),o.forEach((function(r){return i.push(r)})),h.forEach((function(r){return i.push(r)})),a.forEach((function(r){return i.push(r)})),i}};r("monsterData",{minGapWithHero1:150,minGapWithHero2:5,queueMappingList:{1:"one",2:"x3",3:"y3",4:"triR3",5:"triL3",6:"triU3",7:"triD3",8:"x5",9:"y5",10:"triR5",11:"triL5",12:"circleR1000T20",13:"heartR500T40",9001:"rectO500T12",9002:"rectO500T20",9003:"rectO500T28",9004:"rectO500T36",10001:"circleR1000T28",10002:"heartR500T28",10003:"circleR1000T36",10004:"heartR500T36",10005:"circleR1000T44",10006:"heartR500T44",10007:"circleR1000T52",10008:"heartR500T52",10009:"circleR1000T60",10010:"heartR500T60"},queue:{one:c.xLine(1),x3:c.xLine(3),y3:c.yLine(3),triR3:c.triR(3),triL3:c.triL(3),triU3:c.triU(3),triD3:c.triD(3),x5:c.xLine(5),y5:c.yLine(5),triR5:c.triR(5),triL5:c.triL(5),triU5:c.triU(5),triD5:c.triD(5),circleR1000T20:c.circle(1e3,20),heartR500T20:c.heart(500,20),rectO500T12:c.rect(500,12),rectO500T20:c.rect(500,20),rectO500T28:c.rect(500,28),rectO500T36:c.rect(500,36),circleR1000T28:c.circle(1e3,28),heartR500T28:c.heart(500,28),circleR1000T36:c.circle(1e3,36),heartR500T36:c.heart(500,36),circleR1000T44:c.circle(1e3,44),heartR500T44:c.heart(500,44),circleR1000T52:c.circle(1e3,52),heartR500T52:c.heart(500,52),circleR1000T60:c.circle(1e3,60),heartR500T60:c.heart(500,60)},queueDir:{one:null,x3:null,y3:null,x5:null,y5:null,triR3:{x:-800,y:0},triL3:{x:800,y:0},triU3:{x:0,y:800},triD3:{x:0,y:-800},triR5:{x:-800,y:0},triL5:{x:800,y:0},triU5:{x:0,y:800},triD5:{x:0,y:-800},circleR1000T20:{x:0,y:0},heartR500T40:{x:0,y:0}},MSCoefficient:.5});t._RF.pop()}}}));

System.register("chunks:///_virtual/MonsterLeader.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalData.ts","./PoolManager.ts","./Monster.ts"],(function(e){var t,r,a,o,i,n,s,l,d,c,h,p,u,g,m,f,y,S;return{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inheritsLoose,a=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){i=e.cclegacy,n=e._decorator,s=e.Prefab,l=e.Material,d=e.Sprite,c=e.BoxCollider2D,h=e.UITransform,p=e.Size,u=e.Contact2DType},function(e){g=e.em},function(e){m=e.tagData,f=e.groupIndex},function(e){y=e.plm},function(e){S=e.Monster}],execute:function(){var v,M,B,D,L,T,_;i._RF.push({},"f31darYW99DxIBZWKvRFDZr","MonsterLeader",void 0);var b=n.ccclass,C=n.property;e("MonsterLeader",(v=b("MonsterLeader"),M=C(s),B=C([l]),v((T=t((L=function(e){function t(){for(var t,r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return t=e.call.apply(e,[this].concat(i))||this,a(t,"fireBall",T,o(t)),a(t,"leaderMaTerial",_,o(t)),t._strengthType=void 0,t}r(t,e);var i=t.prototype;return i.createLeader=function(e,t){this._type="leader";var r=JSON.parse(JSON.stringify(g.dispatch("getMonsterDataById",e)));switch(this.setDefaultMaterialByType(t),t){case 0:this.createLeaderStrengthBlood(r);break;case 1:this.createLeaderStrengthMoveSpeed(r);break;case 2:this.createLeaderStrengthDamage(r);break;case 3:this.createLeaderSuperArmor(r);break;default:throw"未知的类型："+t}},i.setDefaultMaterialByType=function(e){var t=this.leaderMaTerial[e];if(!t)throw"type is "+e+" material is error";this._defaultMaterial=t,this.node.getComponent(d).material=this._defaultMaterial,console.log("setDefaultMaterialByType",this.node)},i.createLeaderStrengthBlood=function(e){this._strengthType="blood",console.log("创建强化血量精英怪"),e.maxBlood*=20,e.damage*=3,e.moveSpeed*=1.5,this.node.setScale(2,2),this.init(e)},i.createLeaderStrengthMoveSpeed=function(e){this._strengthType="moveSpeed",console.log("创建强化移速精英怪"),e.maxBlood*=5,e.damage*=2,e.moveSpeed*=3,this.node.setScale(1.2,1.2),this.init(e)},i.createLeaderStrengthDamage=function(e){this._strengthType="damage",console.log("创建强化伤害精英怪"),e.maxBlood*=10,e.damage*=5,e.moveSpeed*=1.5,this.node.setScale(1.5,1.5),this.init(e)},i.createLeaderSuperArmor=function(e){this._strengthType="superArmor",console.log("创建霸体精英怪"),this._isSuperArmor=!0,e.maxBlood*=10,e.damage*=2,e.moveSpeed*=2,this.node.setScale(1.5,1.5),this.init(e)},i.init=function(e){this._curMonsterData=e,this.initMonsterMoveAnim(e),this._maxBlood=2*e.maxBlood,this._curBlood=e.maxBlood,this._attackInterval*=.5,this.initCollider()},i.initCollider=function(){var e=this.getComponent(c);e||(e=this.node.addComponent(c));var t=this.node.getComponent(h),r=new p(t.contentSize.x,t.contentSize.y);e.tag=m.monster,e.size=r,e.group=f.enemy,e.on(u.BEGIN_CONTACT,this.onBeginContact,this)},i.update=function(e){this.move(e),this.updateSpriteDirection()},i.dynamicAvoidCollider=function(){return null},i.monsterDied=function(){this.node.parent&&(y.putToPool("monsterLeader",this.node),g.dispatch("updateLeaderCurTotal",-1),g.dispatch("showKillLeaderReward",this._strengthType),g.dispatch("usingHeroControlFun","updateExpProgress",200),g.dispatch("updateKillCountLabel",1)),this.afterMonsterDied()},t}(S)).prototype,"fireBall",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=t(L.prototype,"leaderMaTerial",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=L))||D));i._RF.pop()}}}));

System.register("chunks:///_virtual/MonsterManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PoolManager.ts","./EventManager.ts"],(function(e){var t,n,r,o,i,s,a,l,h,u,d,c,m,f,p,M,g;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){i=e.cclegacy,s=e._decorator,a=e.Prefab,l=e.JsonAsset,h=e.AnimationClip,u=e.Label,d=e.NodePool,c=e.find,m=e.Vec3,f=e.BoxCollider2D,p=e.Component},function(e){M=e.plm},function(e){g=e.em}],execute:function(){var y,v,P,b,C,L,A,x,w,_,T,D,B;i._RF.push({},"64b4feS1jZCmaEd2+7cjaAo","MonsterManager",void 0);var I=s.ccclass,E=s.property;e("MonsterManager",(y=I("MonsterManager"),v=E(a),P=E(a),b=E(l),C=E(h),L=E(u),y((w=t((x=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return t=e.call.apply(e,[this].concat(i))||this,r(t,"monsterChildPrefab",w,o(t)),r(t,"monsterLeaderPrefab",_,o(t)),r(t,"monsterPropertiesJson",T,o(t)),r(t,"animClip",D,o(t)),r(t,"monsterTotalLabel",B,o(t)),t._initPosList=null,t._monsterProperties={},t._monsterAnimClips={},t._createCount=0,t}n(t,e);var i=t.prototype;return i.onDestroy=function(){g.remove("usingMonsterManagerFun"),g.remove("createMonsterByOutsideData"),g.remove("createMonsterLeader"),g.remove("getMonsterTotal"),g.remove("removeAllMonsters"),g.remove("getMonsterDataById"),g.remove("getMonsterAnimByAnimKey"),g.remove("createMonsterDamageTex"),g.remove("getAllMonsterColliders")},i.onLoad=function(){this.initAnimClips(),g.add("usingMonsterManagerFun",this.usingMonsterManagerFun.bind(this)),g.add("createMonsterByOutsideData",this.createMonsterByOutsideData.bind(this)),g.add("createMonsterLeader",this.createMonsterLeader.bind(this)),g.add("getMonsterTotal",this.getMonsterTotal.bind(this)),g.add("removeAllMonsters",this.removeAllMonsters.bind(this)),g.add("getMonsterDataById",this.getMonsterDataById.bind(this)),g.add("getMonsterAnimByAnimKey",this.getMonsterAnimByAnimKey.bind(this)),g.add("createMonsterDamageTex",this.createMonsterDamageTex.bind(this)),g.add("getAllMonsterColliders",this.getAllMonsterColliders.bind(this));var e=new d,t=new d;M.addPoolToPools("monsterChild",e,this.monsterChildPrefab),M.addPoolToPools("monsterLeader",t,this.monsterLeaderPrefab),this._initPosList={up:{x:0,y:300},down:{x:0,y:-300},left:{x:-300,y:0},right:{x:300,y:0}},this.initMonsterProperties()},i.initAnimClips=function(){var e=this;g.dispatch("loadTheDir","/anim/enemy/monster",(function(t){t.forEach((function(t){e._monsterAnimClips[t.name]=t}))}))},i.initMonsterProperties=function(){var e=this;this.monsterPropertiesJson.json.forEach((function(t){var n=t.id;e._monsterProperties[n]=t}))},i.start=function(){this.showMonsterTotal(1)},i.showMonsterTotal=function(e){var t=this;this.schedule((function(){var e=t.getMonsterTotal();t.monsterTotalLabel.string="怪物总数：\n"+e}),e)},i.createMonsterLeader=function(e,t){var n=M.getFromPool("monsterLeader");n.parent=c("Canvas/enemyLayer");var r=this.getRandomInitPos(),o=g.dispatch("getHeroWorldPos");n.setWorldPosition(r.x+o.x,r.y+o.y,0),n.getComponent("MonsterLeader").createLeader(e,t)},i.getAllAroundWpList=function(e){var t={up:new m,down:new m,left:new m,right:new m};for(var n in t){var r=t[n];r.x=e.x+this._initPosList[n].x,r.y=e.y+this._initPosList[n].y,r.z=0}return t},i.createQueueCircle=function(e,t){if(t%4!=0)throw"生成的在圆上的点的总数错误，不是4的倍数"+t;for(var n=t/4,r=[],o=1;o<n;o++){var i=e*Math.sin(Math.PI/180*o/n*90),s=Math.sqrt(e*e-i*i);r.push([s,i],[s,-i],[-s,i],[-s,-i])}return r.push([0,e],[0,-e],[e,0],[-e,0]),r},i.createQueueHeart=function(e,t){if(t<20)throw"total过小，无法生成心形方程";var n=2*Math.PI/t;e/=16;for(var r=[];t;){var o=n*t,i=16*Math.pow(Math.sin(o),3),s=13*Math.cos(o)-5*Math.cos(2*o)-2*Math.cos(3*o)-Math.cos(4*o);i*=e,s*=e,r.push([i,s]),t--}return r},i.createMonsterByOutsideData=function(e,t,n){void 0===n&&(n=null),null==n&&(n=this.getRandomInitPos()),this.createMonsterQueue(e,t,n)},i.getRandomInitPos=function(){switch(this._createCount++,this._createCount%4){case 0:return{x:2*this._initPosList.up.x,y:2*this._initPosList.up.y};case 1:return{x:2*this._initPosList.down.x,y:2*this._initPosList.down.y};case 2:return{x:2*this._initPosList.left.x,y:2*this._initPosList.left.y};case 3:return{x:2*this._initPosList.right.x,y:2*this._initPosList.right.y};default:throw new Error("getRandomInitPos err")}},i.createMonsterQueue=function(e,t,n){var r=this;n=this.addRandomOffset(n),t.forEach((function(t){r.createMonster(e,t,n)}))},i.createMonster=function(e,t,n){var r=M.getFromPool("monsterChild");r.parent=this.node;var o=g.dispatch("getHeroWorldPos");r.setWorldPosition(n.x+o.x+t[0],n.y+o.y+t[1],0),r.active=!0;var i=g.dispatch("getMonsterDataById",e);r.getComponent("Monster").init(i)},i.addRandomOffset=function(e){if(0==e.x&&0!=e.y){var t=e.y;e.x+=Math.random()>.5?.5*t+Math.random()*t*.5|0:-(.5*t+Math.random()*t*.5|0)}else{if(0==e.x||0!=e.y)return e;var n=e.x;e.y+=Math.random()>.5?.5*n+Math.random()*n*.5|0:-(.5*n+Math.random()*n*.5|0)}return e},i.getMonsterTotal=function(){var e=0;return this.node.children.forEach((function(t){e++})),e},i.removeAllMonsters=function(){for(;this.node.children.length;){var e=this.node.children[0];e.removeFromParent(),M.putToJunkyard(e,!0)}},i.getMonsterDataById=function(e){if(this._monsterProperties.hasOwnProperty(e))return this._monsterProperties[e];throw"property "+e+" of _monsterProperties is null"},i.getMonsterAnimByAnimKey=function(e){return this._monsterAnimClips[e]},i.createMonsterDamageTex=function(e,t){g.dispatch("getHeroControlProperty","_isDamageImmunity")||(g.dispatch("createDamageTex",e,t,{x:0,y:50}),g.dispatch("usingHeroControlFun","updateBloodProgress",-t))},i.getAllMonsterColliders=function(){var e=[];return this.node.children.forEach((function(t){if("monsterChild"==t.name){var n=t.getComponent(f);e.push(n)}})),e},i.getAllMonsterScript=function(){var e=[];return this.node.children.forEach((function(t){"monsterChild"==t.name?e.push(t.getComponent("Monster")):"monsterLeader"==t.name&&e.push(t.getComponent("MonsterLeader"))})),e},i.pauseAllAnim=function(){this.doSameThings("pauseAnim")},i.resumeAllAnim=function(){this.doSameThings("resumeAnim")},i.doSameThings=function(e){this.node.children.forEach((function(t){"monsterChild"==t.name?t.getComponent("Monster")[e]():"monsterLeader"==t.name?t.getComponent("MonsterLeader")[e]():t.components[0][e]()}))},i.usingMonsterManagerFun=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(this[e]&&"function"==typeof this[e])return this[e].apply(this,n);throw e+" is not fun or undefined"},t}(p)).prototype,"monsterChildPrefab",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=t(x.prototype,"monsterLeaderPrefab",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=t(x.prototype,"monsterPropertiesJson",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=t(x.prototype,"animClip",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B=t(x.prototype,"monsterTotalLabel",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=x))||A));i._RF.pop()}}}));

System.register("chunks:///_virtual/MonsterParNode.ts",["cc"],(function(){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"5c6a3Yv5EpJsq04i8Ct/NRI","MonsterParNode",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/MoveLikeFire.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalData.ts","./Weapon.ts"],(function(t){var e,i,a,n,o,r,s;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,a=t._decorator,n=t.Animation},function(t){o=t.em},function(t){r=t.tagData},function(t){s=t.Weapon}],execute:function(){var c;i._RF.push({},"a82d3h5129GNKZOCSjN7cNi","MoveLikeFire",void 0);var l=a.ccclass;a.property,t("MoveLikeFire",l("MoveLikeFire")(c=function(t){function i(){return t.apply(this,arguments)||this}e(i,t);var a=i.prototype;return a.init=function(){this.initSkillData()},a.initSkillData=function(){var t=o.dispatch("usingHeroBasePropertyFun","getSkillBookDataByIdOrName","moveLikeFire");this._damage=t.baseDamage,this._moveSpeed=0,this._canAttackTimes=1/0,this._backDis=10,this._attackInterval=.3,this._weaponName=t.name2,this.clearCacheData(),this.initBoxCollider(r.sword),this.node.getComponent(n).play()},i}(s))||c);i._RF.pop()}}}));

System.register("chunks:///_virtual/PassRewardLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalData.ts"],(function(e){var t,i,r,n,a,o,s,d,l,h,c,p,g,u,f;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,r=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){a=e.cclegacy,o=e._decorator,s=e.Label,d=e.SpriteFrame,l=e.find,h=e.Sprite,c=e.instantiate,p=e.director,g=e.Component},function(e){u=e.em},function(e){f=e.ggd}],execute:function(){var w,m,b,R,L,v,y,S,_;a._RF.push({},"3915avsEoJBXokQnV1iJKrp","PassRewardLayer",void 0);var C=o.ccclass,F=o.property;e("PassRewardLayer",(w=C("PassRewardLayer"),m=F(s),b=F(d),R=F(d),w((y=t((v=function(e){function t(){for(var t,i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return t=e.call.apply(e,[this].concat(a))||this,r(t,"descriptionLabel",y,n(t)),r(t,"bgSpriteSF",S,n(t)),r(t,"leaderRewardSF",_,n(t)),t._bgSprite=null,t._prefab=null,t._rContent=null,t._killLeaderRewardConfig=void 0,t._isPass=!1,t._notNoticeKillReward=!1,t}i(t,e);var a=t.prototype;return a.onLoad=function(){u.add("openRewardLayer",this.openLayer.bind(this)),u.add("showKillLeaderReward",this.showKillLeaderReward.bind(this)),u.add("showPassReward",this.showPassReward.bind(this)),this.initNode(),this.initOutRefList(),this.initLeaderRewardConfig()},a.onDestroy=function(){u.remove("openRewardLayer"),u.remove("showKillLeaderReward"),u.remove("showPassReward")},a.initNode=function(){this._bgSprite=l("bg",this.node).getComponent(h),this._prefab=l("prefab",this.node),this._rContent=l("bg/ScrollView/view/content",this.node)},a.initOutRefList=function(){if(!this.bgSpriteSF)throw"reward refs init failed,please checking refs are added.";this._bgSprite.spriteFrame=this.bgSpriteSF},a.initLeaderRewardConfig=function(){this._killLeaderRewardConfig={0:"strengthBlood1",1:"strengthBlood2",2:"strengthBlood3",3:"strengthBlood4",4:"strengthBlood5",5:"strengthDamage1",6:"strengthDamage2",7:"strengthDamage3",8:"strengthDamage4",9:"strengthDamage5",10:"strengthMoveSpeed1",11:"strengthMoveSpeed2",12:"strengthMoveSpeed3",13:"strengthMoveSpeed4",14:"strengthMoveSpeed5"}},a.onDisable=function(){l("killLeaderReward",this.node).getComponent(h).spriteFrame=null,l("killLeaderReward/Label",this.node).getComponent(s).string="",f.stopAll=l("passRewardLayer",this.node.parent).active},a.showKillLeaderReward=function(e){if(this.leaderRewardSF.length<=0)throw"leader reward sf is null";var t=5*Math.random()|0,i=u.dispatch("usingHeroControlFun","updateBonusValue",e,t+1);u.dispatch("createTipsTex",i)},a.showPassReward=function(e,t){var i=this;e.forEach((function(e){if(console.log(e),e.total>0){var t=c(i._prefab),r=u.dispatch("getItemDataByIdOrName",e.id);t.parent=i._rContent,t.getChildByName("name").getComponent(s).string=r.name+"x"+e.total;var n=t.getChildByName("sprite").getComponent(h),a="images/items/"+r.loadUrl+"/spriteFrame";u.dispatch("loadTheDirResources",a,(function(e){return n.spriteFrame=e})),t.active=!0}})),this.descriptionLabel.string=t,f.stopAll=!0,this.node.active=!0,this._isPass=!0},a.closeLayer=function(){this._isPass?(console.log("跳转到菜单界面"),p.loadScene("mainMenu",(function(){u.dispatch("switchMainBgm","/audio/music/刀剑如梦")}))):(this.node.active=!1,l("Toggle",this.node).active=!1,u.dispatch("usingMonsterManagerFun","resumeAllAnim"),u.dispatch("usingHeroControlFun","resumeGame"))},a.openLayer=function(){this.node.active=!0},a.onBtnNotNotice=function(){this._notNoticeKillReward=!this._notNoticeKillReward},t}(g)).prototype,"descriptionLabel",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=t(v.prototype,"bgSpriteSF",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=t(v.prototype,"leaderRewardSF",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),L=v))||L));a._RF.pop()}}}));

System.register("chunks:///_virtual/PoolManager.ts",["cc"],(function(o){var s,t,e;return{setters:[function(o){s=o.cclegacy,t=o.NodePool,e=o.instantiate}],execute:function(){s._RF.push({},"dd9c4pCzpdDAodMdKm5AUaB","PoolManager",void 0);o("plm",new(function(){function o(){this.pools=void 0,this.prefabs=void 0,this.junkyard=void 0,this.pools={},this.prefabs={},this.junkyard=new t}var s=o.prototype;return s.addPoolToPools=function(o,s,t){this.pools[o]?console.warn("对象池"+o+"已存在"):(this.pools[o]=s,this.prefabs[o]=t,console.log("成功添加对象池"+o))},s.getFromPool=function(o,s){void 0===s&&(s=!1);var t=this.pools[o],l=this.prefabs[o];if(!t)return console.warn("对象池"+o+"不存在"),!1;if(!l)throw"预制件"+o+"不存在";var n=null;return t.size()>0?(n=t.get(),s&&console.log("从对象池获取"+o+"成功")):(n=e(l),s&&console.log("从对象池创建"+o+"成功")),n},s.putToPool=function(o,s,t){void 0===t&&(t=!1);var e=this.pools[o];if(!e)return console.warn(o+"对象池不存在,直接销毁"),void s.destroy();t&&console.log("将"+o+" "+s.uuid+"放入对象池"),e.put(s)},s.putToJunkyard=function(o,s){void 0===s&&(s=!1),s&&console.log("放入垃圾场"),this.junkyard.put(o)},s.showAllPoolsAndPrefab=function(){console.log("pools",this.pools),console.log("prefabs",this.prefabs)},s.clearAllNodePool=function(){for(var o in this.clearJunkyard(),this.pools){if(Object.prototype.hasOwnProperty.call(this.pools,o))this.pools[o].clear(),delete this.pools[o]}for(var s in this.prefabs)Object.prototype.hasOwnProperty.call(this.prefabs,s)&&delete this.prefabs[s];console.log("this.pools",this.pools),console.log("this.prefabs",this.prefabs)},s.clearJunkyard=function(){this.junkyard.clear()},o}()));s._RF.pop()}}}));

System.register("chunks:///_virtual/PreLoad.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var r,i,t,o,n,l,a,s,c,p;return{setters:[function(e){r=e.applyDecoratedDescriptor,i=e.inheritsLoose,t=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){n=e.cclegacy,l=e._decorator,a=e.Sprite,s=e.Label,c=e.director,p=e.Component}],execute:function(){var u,f,g,d,L,h,b;n._RF.push({},"0945a1ycZVIXowKyhXL17x/","PreLoad",void 0);var y=l.ccclass,S=l.property;e("PreLoad",(u=y("PreLoad"),f=S(a),g=S(s),u((h=r((L=function(e){function r(){for(var r,i=arguments.length,n=new Array(i),l=0;l<i;l++)n[l]=arguments[l];return r=e.call.apply(e,[this].concat(n))||this,t(r,"fillSprite",h,o(r)),t(r,"progressLabel",b,o(r)),r}i(r,e);var n=r.prototype;return n.onLoad=function(){c.loadScene("game")},n.updateLoadingProgress=function(e){this.fillSprite&&this.progressLabel&&(e<=this.fillSprite.fillRange||(this.fillSprite.fillRange=e,this.progressLabel.string=(100*e).toFixed(2)+"%"))},r}(p)).prototype,"fillSprite",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=r(L.prototype,"progressLabel",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=L))||d));n._RF.pop()}}}));

System.register("chunks:///_virtual/PrizeHallLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./HttpRequest.ts","./PoolManager.ts"],(function(e){var t,n,i,o,r,a,s,c,l,d,u;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,i=e._decorator,o=e.find,r=e.NodePool,a=e.Sprite,s=e.Label,c=e.Component},function(e){l=e.em},function(e){d=e.hr},function(e){u=e.plm}],execute:function(){var p;n._RF.push({},"30ff6dHnqlOSpEBe/yd75rI","PrizeHallLayer",void 0);var h=i.ccclass;i.property,e("PrizeHallLayer",h("PrizeHallLayer")(p=function(e){function n(){for(var t,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))||this)._curCdkeySting=void 0,t._itemPrefab=void 0,t._itemContent=void 0,t}t(n,e);var i=n.prototype;return i.onLoad=function(){this._itemPrefab=o("item",this.node),this._itemContent=o("ScrollView/view/content",this.node);var e=new r;u.addPoolToPools("PrizeHallItem",e,this._itemPrefab)},i.onDisable=function(){this.clearContent()},i.inputCdkey=function(e){this._curCdkeySting=e.string},i.sendPrizeRequest=function(){var e=this;console.log("sendPrizeRequest current cdkey is ",this._curCdkeySting);d.get("http://47.97.222.77:3001/game/copy9train/prize",{cdk:this._curCdkeySting},(function(t){console.log("response",t),t.successful?(console.log("添加领取奖励效果 还没写"),l.dispatch("tipsViewShow","领取奖励成功"),e.distributePrizes(t.data)):l.dispatch("tipsViewShow","cdk错误，领取失败。")}))},i.distributePrizes=function(e){var t=this;this.clearContent(),console.log("get prizes",e);for(var n=function(){var n=e.prize[i],o=e.total[i],r=l.dispatch("getItemDataByIdOrName",n);l.dispatch("addItemToSS",n,o);var c=u.getFromPool("PrizeHallItem");c.parent=t._itemContent;var d=c.getChildByName("Sprite").getComponent(a),p="images/items/"+r.loadUrl+"/spriteFrame";l.dispatch("loadTheDirResources",p,(function(e){return d.spriteFrame=e})),c.getChildByName("Label").getComponent(s).string=r.name+"\nX"+o,c.active=!0,c.parent=t._itemContent},i=0;i<e.prize.length;i++)n()},i.clearContent=function(){console.log("清除content");for(var e=o("ScrollView/view/content",this.node);e.children.length;){var t=this._itemContent.children[0];t.removeFromParent(),u.putToPool("PrizeHallItem",t)}},n}(c))||p);n._RF.pop()}}}));

System.register("chunks:///_virtual/Queue.ts",["cc"],(function(t){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"54a10/Onh9HBJIkeKY3XN7P","Queue",void 0);t("Queue",function(){function t(){this.list=[]}var e=t.prototype;return e.enqueue=function(t){this.list.push(t)},e.dequeue=function(){return this.empty()?(console.log("无法出队"),!1):this.list.shift()},e.front=function(){return this.empty()&&console.log("无法查看"),this.list[0]},e.back=function(){return this.empty()&&console.log("无法查看"),this.list[this.list.length-1]},e.toString=function(){return this.list.join("\n")},e.clear=function(){delete this.list,this.list=[]},e.empty=function(){if(0===this.list.length)return console.log("队列为空"),!0},t}());e._RF.pop()}}}));

System.register("chunks:///_virtual/SamadhiTrueFire.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalData.ts","./Weapon.ts"],(function(t){var i,e,n,a,o,r,s;return{setters:[function(t){i=t.inheritsLoose},function(t){e=t.cclegacy,n=t._decorator,a=t.Animation},function(t){o=t.em},function(t){r=t.tagData},function(t){s=t.Weapon}],execute:function(){var u;e._RF.push({},"fa9e36GRPBDFq3fyBBV3pXc","SamadhiTrueFire",void 0);var c=n.ccclass;n.property,t("SamadhiTrueFire",c("SamadhiTrueFire")(u=function(t){function e(){return t.apply(this,arguments)||this}i(e,t);var n=e.prototype;return n.onDestroy=function(){},n.init=function(){this.addToAnimManger(),this.initSkillData()},n.initSkillData=function(){var t=o.dispatch("usingHeroBasePropertyFun","getSkillBookDataByIdOrName","samadhiTrueFire");this._damage=t.baseDamage,this._duration=t.duration,this._backDis=0,this._canAttackTimes=1/0,this._attackInterval=.5,this._weaponName=t.name,this.node.parent=o.dispatch("getHeroControlProperty","node").getChildByName("sprite"),this.initBoxCollider(r.sword)},n.recoveryToPool=function(){this.removeFromList(),this.node.destroy()},n.addToAnimManger=function(){var t=this.node.getComponent(a);o.dispatch("usingGameAnimManagerFun","addAnimToList",t)},n.removeFromList=function(){var t=this.node.getComponent(a);o.dispatch("usingGameAnimManagerFun","removeAnimFromList",t)},e}(s))||u);e._RF.pop()}}}));

System.register("chunks:///_virtual/SavingManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalData.ts"],(function(a){var t,e,n,o,i,s,r,g;return{setters:[function(a){t=a.inheritsLoose},function(a){e=a.cclegacy,n=a._decorator,o=a.game,i=a.sys,s=a.Component},function(a){r=a.em},function(a){g=a.ggd}],execute:function(){var l;e._RF.push({},"57546QrwlBC8YczrgjQR8PN","SavingManager",void 0);var p=n.ccclass;n.property,a("SavingManager",p("SavingManager")(l=function(a){function e(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=a.call.apply(a,[this].concat(n))||this)._tempData={},t}t(e,a);var n=e.prototype;return n.onLoad=function(){r.add("savingToTempData",this.savingToTempData.bind(this)),r.add("getTempData",this.getTempData.bind(this)),r.add("savingGlobalDataToTempData",this.savingGlobalDataToTempData.bind(this)),this.initTempData(),o.addPersistRootNode(this.node),console.log("========================INIT SavingManager==================="),this.initGlobalData()},n.onDestroy=function(){r.remove("savingToTempData"),r.remove("getTempData")},n.savingToTempData=function(a,t){this._tempData.hasOwnProperty(a)||console.warn("添加新属性"+a),this._tempData[a]=JSON.parse(JSON.stringify(t)),console.log("temp data，saving key is "+a,this._tempData),i.localStorage.setItem("saving",JSON.stringify(this._tempData))},n.getTempData=function(a){return this._tempData.hasOwnProperty(a)?this._tempData[a]:null},n.initTempData=function(){var a=i.localStorage.getItem("saving");a&&(this._tempData=JSON.parse(a))},n.initGlobalData=function(){if(this._tempData.hasOwnProperty("global")){var a=this._tempData.global;g.stageProgress=a.stageProgress}},n.savingGlobalDataToTempData=function(){var a={stageProgress:g.stageProgress};this.savingToTempData("global",a)},e}(s))||l);e._RF.pop()}}}));

System.register("chunks:///_virtual/SelectStageLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalData.ts","./globalFun.ts"],(function(t){var e,a,i,n,s,o,r,g,l,h,c,p,u,m,f,d,b,P;return{setters:[function(t){e=t.applyDecoratedDescriptor,a=t.inheritsLoose,i=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){s=t.cclegacy,o=t._decorator,r=t.Prefab,g=t.Node,l=t.JsonAsset,h=t.instantiate,c=t.Label,p=t.UITransform,u=t.director,m=t.find,f=t.Component},function(t){d=t.em},function(t){b=t.ggd},function(t){P=t.glf}],execute:function(){var N,y,_,B,C,v,L,S,k;s._RF.push({},"94db5bEjvBPh5zPA2EHobww","SelectStageLayer",void 0);var w=o.ccclass,T=o.property;t("SelectCheckpointLayer",(N=w("SelectStageLayer"),y=T(r),_=T(g),B=T(l),N((L=e((v=function(t){function e(){for(var e,a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return e=t.call.apply(t,[this].concat(s))||this,i(e,"SCPrefab",L,n(e)),i(e,"prefabPar",S,n(e)),i(e,"stageConfigJson",k,n(e)),e._isLoading=!1,e._stageName={1:"探索",2:"了解",3:"熟悉",4:"认知",5:"大家伙",6:"更深处的东西",7:"一探究竟",8:"原来如此",9:"看清一切",10:"大家伙的真面目"},e._mapName={1:"青青草原",2:"暗黑大陆",3:"晨星荒漠",4:"绝命谷",5:"寂静岭",6:"灼烧大陆",7:"无声荒漠",8:"虚无之地",9:"极寒之地",10:"魔幻大陆"},e._prefabArr=[],e._initPos={y:-300,gap:-500,changePos:1e3,changeRank:5},e._stageTotal=0,e}a(e,t);var s=e.prototype;return s.onLoad=function(){this._stageTotal=this.getStageTotal(),this.initPrefabs()},s.getStageTotal=function(){var t=this.stageConfigJson.json,e=0;for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e++;return e},s.initPrefabs=function(){for(var t=0;t<5;t++){var e=h(this.SCPrefab);e.parent=this.prefabPar,e.setPosition(0,this._initPos.y+t*this._initPos.gap);var a=t+1;e.stageNum=a,e.stageNum>b.stageProgress?e.getChildByName("btnBg").getChildByName("stageLock").active=!0:e.getChildByName("btnBg").getChildByName("stageLock").active=!1,e.getChildByName("Label").getComponent(c).string="关卡"+a+"\n"+this._mapName[Math.ceil(a/10)]+"\n"+this._stageName[a];var i=e.getChildByName("btnBg");P.createButton(this.node,i,"SelectStageLayer","onBtnEnter"),this._prefabArr.push(e)}var n=this.prefabPar.getComponent(p);n.setContentSize(n.width,this._stageTotal*Math.abs(this._initPos.gap)),console.log("this.prefabPar",this.prefabPar)},s.onBtnCheckpoint=function(t){var e=t.target.parent;console.log("onBtnCheckpoint",e.stageNum),this.onBtnEnter(t)},s.update=function(t){for(var e=this.prefabPar.parent.getWorldPosition(),a=0;a<this._prefabArr.length;a++){var i=this._prefabArr[a],n=i.getWorldPosition();if(n.y-e.y>this._initPos.changePos&&i.stageNum+this._initPos.changeRank<=this._stageTotal){var s=this._initPos.changeRank*this._initPos.gap;i.setWorldPosition(n.x,n.y+s,n.z),i.stageNum+=this._initPos.changeRank,i.stageNum>b.stageProgress?i.getChildByName("btnBg").getChildByName("stageLock").active=!0:i.getChildByName("btnBg").getChildByName("stageLock").active=!1,i.getChildByName("Label").getComponent(c).string="关卡"+i.stageNum+"\n"+this._mapName[Math.ceil(i.stageNum/10)]+"\n"+this._stageName[i.stageNum%10==0?10:i.stageNum%10]}else if(n.y-e.y<-this._initPos.changePos&&i.stageNum-this._initPos.changeRank>=1){var o=this._initPos.changeRank*this._initPos.gap;i.setWorldPosition(n.x,n.y-o,n.z),i.stageNum-=this._initPos.changeRank,i.stageNum>b.stageProgress?i.getChildByName("btnBg").getChildByName("stageLock").active=!0:i.getChildByName("btnBg").getChildByName("stageLock").active=!1,i.getChildByName("Label").getComponent(c).string="关卡"+i.stageNum+"\n"+this._mapName[Math.ceil(i.stageNum/10)]+"\n"+this._stageName[i.stageNum%10==0?10:i.stageNum%10]}}},s.onBtnEnter=function(t){var e=t.target.parent.stageNum;this._isLoading||(this._isLoading=!0,console.log("进入关卡"+e),e<=20?(this.openLoading(),b.curStage=parseInt(e),console.log("切换音效"),u.loadScene("game",(function(){d.dispatch("switchMainBgm","/audio/music/不谓侠")}))):(console.warn("current stage is  undefined"),this._isLoading=!1))},s.openLoading=function(){m("Canvas/loading").active=!0},s.onBtnChangeStage=function(){b.stageProgress++,d.dispatch("savingGlobalDataToTempData")},e}(f)).prototype,"SCPrefab",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=e(v.prototype,"prefabPar",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=e(v.prototype,"stageConfigJson",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=v))||C));s._RF.pop()}}}));

System.register("chunks:///_virtual/ShowLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./PoolManager.ts"],(function(e){var t,o,n,a,r,i,l,c,s,p,f,u,g,d,w;return{setters:[function(e){t=e.applyDecoratedDescriptor,o=e.inheritsLoose,n=e.initializerDefineProperty,a=e.assertThisInitialized},function(e){r=e.cclegacy,i=e._decorator,l=e.Prefab,c=e.NodePool,s=e.Vec3,p=e.Label,f=e.tween,u=e.Color,g=e.Component},function(e){d=e.em},function(e){w=e.plm}],execute:function(){var y,m,T,h,P,v,x;r._RF.push({},"68818T5aVRELL8hQCf3cMKn","ShowLayer",void 0);var b=i.ccclass,C=i.property;e("ShowLayer",(y=b("ShowLayer"),m=C(l),T=C(l),y((v=t((P=function(e){function t(){for(var t,o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return t=e.call.apply(e,[this].concat(r))||this,n(t,"damagePrefab",v,a(t)),n(t,"tipsPrefab",x,a(t)),t}o(t,e);var r=t.prototype;return r.onDestroy=function(){d.remove("createDamageTex"),d.remove("createTipsTex")},r.onLoad=function(){d.add("createDamageTex",this.createDamageTex.bind(this)),d.add("createTipsTex",this.createTipsTex.bind(this));var e=new c;w.addPoolToPools("damageTex",e,this.damagePrefab);var t=new c;w.addPoolToPools("tipsTex",t,this.tipsPrefab)},r.createDamageTex=function(e,t,o,n){void 0===o&&(o={x:0,y:50}),void 0===n&&(n="normal");var a=this.getColorConfigByDamage(n),r=w.getFromPool("damageTex");r.setScale(new s(0,0,1)),r.getComponent(p).string=t,r.getComponent(p).color=a,r.parent=this.node;var i=e.getWorldPosition();r.setWorldPosition(i.x+o.x,i.y+o.y,0),this.playEffect2(r,a)},r.playEffect1=function(e,t){var o=f().by(.5,{position:new s(0,100,0)},{onUpdate:function(o,n){e.getComponent(p).color=u.lerp(new u,t,new u(t.r,t.g,t.b,0),n)}}),n=f().to(.3,{scale:new s(1.2,1.2,1)});f(e).parallel(o,n).call((function(){e.setScale(new s(1,1,1)),w.putToPool("damageTex",e,!0)})).start()},r.playEffect2=function(e,t){f(e).to(.1,{scale:new s(1,1,1)}).delay(.3).to(.1,{scale:new s(0,0,1)}).call((function(){e.setScale(new s(1,1,1)),w.putToPool("damageTex",e,!1)})).start()},r.getColorConfigByDamage=function(e){switch(e){case"normal":return new u(255,255,255,255);case"criticalHit":return new u(255,0,0,255);default:return new u(255,255,255,255)}},r.getColorConfigByDamage2=function(e){for(var t=[50,100,150,200,300],o=[new u(255,255,255,255),new u(255,183,23,255),new u(0,255,20,255),new u(245,0,255,255),new u(255,0,0,255)],n=0;n<t.length;n++){if(t[n]>=e)return o[n]}return o[o.length-1]},r.createTipsTex=function(e,t){void 0===t&&(t={x:0,y:50});var o=w.getFromPool("tipsTex");o.getComponent(p).string=e,o.parent=this.node;var n=d.dispatch("getHeroWorldPos");o.setWorldPosition(n.x+t.x,n.y+t.y,0),this.playTIPSTeXEffect(o)},r.playTIPSTeXEffect=function(e,t){void 0===t&&(t=new u(255,255,255,255));var o=f().by(1,{position:new s(0,200,0)},{onUpdate:function(o,n){e.getComponent(p).color=u.lerp(new u,t,new u(t.r,t.g,t.b,0),n)}}),n=f().to(.5,{scale:new s(1.2,1.2,1)});f(e).parallel(o,n).call((function(){e.setScale(new s(1,1,1)),w.putToPool("tipsTex",e,!0)})).start()},t}(g)).prototype,"damagePrefab",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=t(P.prototype,"tipsPrefab",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=P))||h));r._RF.pop()}}}));

System.register("chunks:///_virtual/SkillBookLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalFun.ts","./PoolManager.ts"],(function(o){var i,t,n,e,s,a,r,l,c,h,k,B,u;return{setters:[function(o){i=o.inheritsLoose},function(o){t=o.cclegacy,n=o._decorator,e=o.find,s=o.NodePool,a=o.Label,r=o.Sprite,l=o.Color,c=o.instantiate,h=o.Component},function(o){k=o.em},function(o){B=o.glf},function(o){u=o.plm}],execute:function(){var g;t._RF.push({},"3cdb8SMhhdF5JZZxaW7u/Sm","SkillBookLayer",void 0);var p=n.ccclass;n.property,o("SkillBookLayer",p("SkillBookLayer")(g=function(o){function t(){for(var i,t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return(i=o.call.apply(o,[this].concat(n))||this)._loadingList={_skillBookClass:!1,_skillBook:!1},i._skillBookClass=void 0,i._skillBook=void 0,i._bookContent=void 0,i._curSelectBook=void 0,i._finishBookList=[],i._bookPrefabList={},i._usingBookList={"身法":"","心法":"","武技":"","绝技":"","神通":""},i}i(t,o);var n=t.prototype;return n.onLoad=function(){var o=e("switchBook/bookPrefab",this.node);u.addPoolToPools("SBLBookPrefab",new s,o),this._bookContent=e("ScrollView/view/content",this.node)},n.start=function(){this.dynamicLoadPrefabs(),this.initData(),this.initUsingBook()},n.initData=function(){var o=k.dispatch("getTempData","SkillBookLayer");o&&(this._finishBookList=o.finishBookList,this._usingBookList=o.usingBookList)},n.dynamicLoadPrefabs=function(){var o=this;k.dispatch("loadTheDirResources","prefabs/mainMenu/skillBookClass",(function(i){o._skillBookClass=i,o._loadingList._skillBookClass=!0,o.initBookListView()})),k.dispatch("loadTheDirResources","prefabs/mainMenu/skillBook",(function(i){o._skillBook=i,o._loadingList._skillBook=!0,o.initBookListView()}))},n.initBookListView=function(){var o=this;if(this.isCompleteLoading()){var i=this.getSkillBookClassList();console.log("initBookListView",i);var t=function(){if(Object.prototype.hasOwnProperty.call(i,n)){var t=i[n],s=c(o._skillBookClass);s.parent=o._bookContent,s.getChildByName("Label").getComponent(a).string=n,t.forEach((function(i){var t=c(o._skillBook);o._finishBookList.indexOf(i.name)<0?(t.getComponent(r).color=new l(100,100,100,255),t.children[0].getComponent(a).color=new l(30,30,30,255)):(t.getComponent(r).color=new l(255,255,255,255),t.children[0].getComponent(a).color=new l(255,255,255,255)),t.children[0].getComponent(a).string=i.name,t.parent=e("/content",s),B.createButton(o.node,t,"SkillBookLayer","onBtnShowBookDetail",i.name),o._bookPrefabList[i.name]=t}))}};for(var n in i)t()}},n.isCompleteLoading=function(){for(var o in this._loadingList){if(Object.prototype.hasOwnProperty.call(this._loadingList,o))if(!this._loadingList[o])return!1}return!0},n.getSkillBookClassList=function(){var o=k.dispatch("usingHeroBasePropertyFun","getAllAboutSkillBook"),i={};return o.forEach((function(o){i.hasOwnProperty(o.type)?i[o.type].push(o):i[o.type]=[o]})),i},n.onBtnShowBookDetail=function(o,i){var t=e("bookDetail",this.node),n=e("/bookDetail/study/Label",this.node).getComponent(a);n.string="领悟",t.active=!0,this._curSelectBook=i,this._finishBookList.indexOf(this._curSelectBook)>-1&&(n.string="已掌握");var s=k.dispatch("usingHeroBasePropertyFun","getSkillBookDataByIdOrName",i);console.log("onBtnShowBookDetail",s),t.getChildByName("bookName").getComponent(a).string=s.name+"\n"+s.lv+"阶功法",t.getChildByName("bookDescription").getComponent(a).string="\n\n"+s.description},n.closeBookDetail=function(){e("bookDetail",this.node).active=!1},n.onBtnStudyBook=function(){if(!(this._finishBookList.indexOf(this._curSelectBook)>-1)){if(k.dispatch("reduceItemFromSS",this._curSelectBook,1)){this._finishBookList.push(this._curSelectBook),e("/bookDetail/study/Label",this.node).getComponent(a).string="已掌握";var o=this._bookPrefabList[this._curSelectBook];o.getComponent(r).color=new l(255,255,255,255),o.children[0].getComponent(a).color=new l(255,255,255,255),this.savingFinishBookData()}else k.dispatch("tipsViewShow","缺少秘籍:"+this._curSelectBook,3);console.log(this._finishBookList)}},n.savingFinishBookData=function(){var o={finishBookList:this._finishBookList,usingBookList:this._usingBookList};k.dispatch("savingToTempData","SkillBookLayer",o)},n.initUsingBook=function(){var o=this;console.log("初始化携带功法 还没写");var i=function(){if(Object.prototype.hasOwnProperty.call(o._usingBookList,t)){var i=o._usingBookList[t];if(""!==i){var n=e("usingBook/"+t,o.node).getChildByName("sprite").getComponent(r),s="images/icons/icon_"+i+"/spriteFrame";k.dispatch("loadTheDirResources",s,(function(o){return n.spriteFrame=o}))}}};for(var t in this._usingBookList)i()},n.onBtnSwitchBook=function(o,i){console.log("切换"+i),e("switchBook",this.node).active=!0,e("switchBook/bg/title",this.node).getComponent(a).string=i,this.initSwitchBook(i)},n.initSwitchBook=function(o){var i=this,t=e("switchBook/bg/content",this.node);this._finishBookList,this._finishBookList.forEach((function(n){var e=k.dispatch("usingHeroBasePropertyFun","getSkillBookDataByIdOrName",n);if(e.type==o){var s=u.getFromPool("SBLBookPrefab"),l=s.getComponent(r);s.parent=t,s.getChildByName("name").getComponent(a).string=e.name;var c="images/icons/icon_"+e.name2+"/spriteFrame";k.dispatch("loadTheDirResources",c,(function(o){return l.spriteFrame=o})),B.createButton(i.node,s,"SkillBookLayer","switchBook",o+"@"+e.name2)}}))},n.switchBook=function(o,i){console.log("p",i);var t=i.split("@"),n=t[0],s=t[1],a=e("usingBook/"+n,this.node).getChildByName("sprite").getComponent(r),l="images/icons/icon_"+s+"/spriteFrame";k.dispatch("loadTheDirResources",l,(function(o){return a.spriteFrame=o})),this._usingBookList[n]=s,console.log("this._usingBookList",this._usingBookList),this.closeSwitchBook(),this.savingFinishBookData()},n.closeSwitchBook=function(){e("switchBook",this.node).active=!1;for(var o=e("switchBook/bg/content",this.node);o.children.length;){var i=o.children[0];i.removeFromParent(),u.putToPool("SBLBookPrefab",i)}},t}(h))||g);t._RF.pop()}}}));

System.register("chunks:///_virtual/SkillManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalData.ts","./globalFun.ts"],(function(e){var i,t,n,o,a,r,s,l,u,c,d,p,g,h;return{setters:[function(e){i=e.applyDecoratedDescriptor,t=e.inheritsLoose,n=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){a=e.cclegacy,r=e._decorator,s=e.Prefab,l=e.Sprite,u=e.Label,c=e.instantiate,d=e.Component},function(e){p=e.em},function(e){g=e.ggd},function(e){h=e.glf}],execute:function(){var k,f,S,m,v;a._RF.push({},"147015qvZlGX40D++2yinmG","SkillManager",void 0);var F=r.ccclass,B=r.property;e("SkillManager",(k=F("SkillManager"),f=B(s),k((v=i((m=function(e){function i(){for(var i,t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return i=e.call.apply(e,[this].concat(a))||this,n(i,"skillPrefab",v,o(i)),i._openSecretList=[],i._likeWindMoveTimes=0,i._bloodMakeMeStrongTimes=0,i._drinkBloodValue=0,i._percentageDamage=0,i._countdownList={sunHeart:0},i}t(i,e);var a=i.prototype;return a.onDestroy=function(){p.remove("usingSkillManagerFun"),p.remove("getSkillManagerProperty")},a.onLoad=function(){p.add("usingSkillManagerFun",this.usingSkillManagerFun.bind(this)),p.add("getSkillManagerProperty",this.getSkillManagerProperty.bind(this)),this.initSkill()},a.start=function(){this.openAllSecretSkill()},a.initSkill=function(){var e=this,i=p.dispatch("getTempData","SkillBookLayer")&&p.dispatch("getTempData","SkillBookLayer").usingBookList;if(i){var t=function(){if(Object.prototype.hasOwnProperty.call(i,n)){var t=i[n];if(t){var o=c(e.skillPrefab);o.parent=e.node;var a=o.getComponent(l),r="images/icons/icon_"+t+"/spriteFrame";p.dispatch("loadTheDirResources",r,(function(e){return a.spriteFrame=e})),h.createButton(e.node,o,"SkillManager","onBtnSkill",t)}}};for(var n in i)t()}},a.onBtnSkill=function(e,i){var t=e.target.getChildByName("mask").getComponent(l);if(!(t.fillRange>0)){this[i](),t.fillRange=1;var n=p.dispatch("usingHeroBasePropertyFun","getSkillBookDataByIdOrName",i).cd,o=e.target.getChildByName("remainingTime").getComponent(u);this.startCoolDowntime(t,o,n)}},a.startCoolDowntime=function(e,i,t){var n=1/60,o=0;i.string=t;var a=setInterval((function(){g.stopAll||(o+=n,e.fillRange=1-o/t,i.string=(t-o).toFixed(2),o>=t&&(clearInterval(a),e.fillRange=0,i.string=""))}),1e3*n)},a.usingSkillManagerFun=function(e){for(var i=arguments.length,t=new Array(i>1?i-1:0),n=1;n<i;n++)t[n-1]=arguments[n];if(this[e]&&"function"==typeof this[e])return this[e].apply(this,t);throw e+" is not fun or undefined"},a.getSkillManagerProperty=function(e){if(this.hasOwnProperty(e))return this[e];throw"skill manager 中不存在属性："+e},a.changeMoveSpeed=function(){var e=p.dispatch("usingHeroBasePropertyFun","getSkillBookDataByIdOrName","changeMoveSpeed");p.dispatch("usingHeroControlFun","changeHeroMoveSpeed",e.moveSpeedTimes,e.duration)},a.swordRain=function(){p.dispatch("usingWeaponManagerFun","usingSkillSwordRain")},a.justOneSwordDivideWorld=function(){p.dispatch("usingWeaponManagerFun","usingSkillJustOneSwordDivideWorld")},a.collectGas=function(){var e=this;console.log("凝气术，还没写");var i=p.dispatch("usingHeroBasePropertyFun","getSkillBookDataByIdOrName","凝气术");p.dispatch("usingHeroControlFun","updateTempCriticalHitRate",i.criticalHitRate),p.dispatch("usingHeroControlFun","isOpenCollectGas",!0);var t=i.duration;this.schedule((function n(){g.stopAll||--t<=0&&(e.unschedule(n),p.dispatch("usingHeroControlFun","updateTempCriticalHitRate",-i.criticalHitRate),p.dispatch("usingHeroControlFun","isOpenCollectGas",!1))}),1)},a.thousandsSwordToTomb=function(){p.dispatch("usingWeaponManagerFun","usingSkillThousandsSwordToTomb")},a.trackDisappear=function(){var e=p.dispatch("usingHeroBasePropertyFun","getSkillBookDataByIdOrName","trackDisappear");p.dispatch("usingHeroControlFun","usingSkillTrackDisappear",e.duration),p.dispatch("usingHeroControlFun","changeHeroMoveSpeed",e.moveSpeedTimes,e.duration)},a.lionRoar=function(){p.dispatch("usingHeroControlFun","usingSkillLionRoar")},a.iceCone=function(){p.dispatch("usingWeaponManagerFun","usingSkillIceCone")},a.iceShield=function(){p.dispatch("usingHeroControlFun","usingSkillIceShield")},a.iceAge=function(){var e=p.dispatch("usingHeroBasePropertyFun","getSkillBookDataByIdOrName","iceAge");p.dispatch("usingMapLayerFun","frozenMap",e.duration,.2)},a.moveLikeMeteor=function(){var e=p.dispatch("usingHeroBasePropertyFun","getSkillBookDataByIdOrName","moveLikeMeteor");p.dispatch("usingHeroControlFun","changeHeroMoveSpeed",e.moveSpeedTimes,e.duration)},a.samadhiTrueFire=function(){p.dispatch("loadTheDirResources","/prefabs/hero/weapon/samadhiTrueFire",(function(e){c(e).getComponent("SamadhiTrueFire").init()}))},a.sunHeart=function(){var e=this;p.dispatch("loadTheDirResources","/prefabs/hero/weapon/sunHeart",(function(e){c(e).parent=p.dispatch("getHeroControlProperty","node").getChildByName("effect")}));var i=p.dispatch("usingHeroBasePropertyFun","getSkillBookDataByIdOrName","sunHeart");p.dispatch("usingHeroControlFun","updateTempCriticalHitRate",i.criticalHitRate),this._countdownList.sunHeart=i.duration,this.unschedule(this.sunHeartCountdownRun),this.schedule((function(){e.sunHeartCountdownRun()}),1)},a.sunHeartCountdownRun=function(){if(!g.stopAll){this._countdownList.sunHeart--;var e=p.dispatch("usingHeroBasePropertyFun","getSkillBookDataByIdOrName","sunHeart");p.dispatch("usingHeroControlFun","updatePercentageBloodProgress",-e.damageTimes),this._countdownList.sunHeart<=0&&(p.dispatch("usingHeroControlFun","updateTempCriticalHitRate",-e.criticalHitRate),this.unschedule(this.sunHeartCountdownRun))}},a.fireBloom=function(){p.dispatch("usingWeaponManagerFun","usingSkillFireBloom")},a.hellFire=function(){p.dispatch("usingWeaponManagerFun","usingSkillHellFire")},a.openAllSecretSkill=function(){var e=this,i=p.dispatch("getTempData","SkillBookLayer")&&p.dispatch("getTempData","SkillBookLayer").finishBookList;console.log("openAllSecretSkill",i),i&&i.forEach((function(i){var t=p.dispatch("usingHeroBasePropertyFun","getSkillBookDataByIdOrName",i);"秘法"==t.type&&e[t.name2]()}))},a.likeWindMove=function(){var e=this;this.schedule((function(){e._likeWindMoveTimes<50&&e._likeWindMoveTimes++}),1)},a.resetLikeWindMoveTimes=function(){this._likeWindMoveTimes=0},a.bloodMakeMeStrong=function(){this._openSecretList.push("bloodMakeMeStrong")},a.add_bloodMakeMeStrongTimes=function(){this._openSecretList.indexOf("bloodMakeMeStrong")<0||this._bloodMakeMeStrongTimes++},a.drinkBlood=function(){this._openSecretList.push("drinkBlood"),this._drinkBloodValue=20},a.iceHeart=function(){this._openSecretList.push("iceHeart");var e=p.dispatch("usingHeroBasePropertyFun","getSkillBookDataByIdOrName","iceHeart");this._percentageDamage+=e.damageTimes},a.moveLikeFire=function(){this._openSecretList.push("moveLikeFire"),p.dispatch("usingWeaponManagerFun","usingSkillMoveLikeFire")},a.flowFire=function(){this._openSecretList.push("flowFire");var e=p.dispatch("usingHeroBasePropertyFun","getSkillBookDataByIdOrName","flowFire");this._percentageDamage+=e.damageTimes},a.getMoveSpeedFromSecretSkill=function(){return this._likeWindMoveTimes},a.getDamageValueFromSecretSkill=function(){var e=this._bloodMakeMeStrongTimes;return this._openSecretList.indexOf("iceHeart")>-1&&(e+=p.dispatch("usingHeroBasePropertyFun","getSkillBookDataByIdOrName","iceHeart").baseDamage),e},a.getPercentageDamageFromSecretSkill=function(){return this._percentageDamage},a.getRecoveryBloodFromSecretSkill=function(){return this._drinkBloodValue},i}(d)).prototype,"skillPrefab",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=m))||S));a._RF.pop()}}}));

System.register("chunks:///_virtual/Spell.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalData.ts","./Weapon.ts"],(function(t){var n,e,o,i,a,l;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator},function(t){i=t.em},function(t){a=t.tagData},function(t){l=t.Weapon}],execute:function(){var c;e._RF.push({},"076f0Ym5/1BxYGaaGR0LdPg","Spell",void 0);var r=o.ccclass;t("Spell",r("Spell")(c=function(t){function e(){return t.apply(this,arguments)||this}n(e,t);var o=e.prototype;return o.init=function(t,n){this.initWeaponInfo(n,t);var e=t.name;this.initBoxCollider(a[e])},o.playSpellAudio=function(){i.dispatch("playOneShot","battle/spell")},e}(l))||c);e._RF.pop()}}}));

System.register("chunks:///_virtual/StageManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./MonsterData.ts","./EventManager.ts","./globalData.ts","./Queue.ts"],(function(t){var e,a,i,s,r,o,n,u,l,h,c,g,d,f,_,m;return{setters:[function(t){e=t.applyDecoratedDescriptor,a=t.inheritsLoose,i=t.initializerDefineProperty,s=t.assertThisInitialized},function(t){r=t.cclegacy,o=t._decorator,n=t.JsonAsset,u=t.Prefab,l=t.find,h=t.Label,c=t.instantiate,g=t.Component},function(t){d=t.monsterData},function(t){f=t.em},function(t){_=t.ggd},function(t){m=t.Queue}],execute:function(){var p,C,b,v,S,T,L,w,D,M,y;r._RF.push({},"4e520BxXQJPQrigNDESbUJs","StageManager",void 0);var k=o.ccclass,R=o.property;t("StageManager",(p=k("StageManager"),C=R(n),b=R(n),v=R(n),S=R([u]),p((w=e((L=function(t){function e(){for(var e,a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r))||this,i(e,"stageConfigJson",w,s(e)),i(e,"leaderAndBossConfigJson",D,s(e)),i(e,"rewardConfigJson",M,s(e)),i(e,"bossPrefabs",y,s(e)),e._curStageName=void 0,e._curStageTime=0,e._killCount=0,e._createCount=0,e._curData=void 0,e._stageConfig=void 0,e._bossConfig=void 0,e._rewardConfig=void 0,e._stageQueue=void 0,e._curLeaderTotal=0,e._killLeaderTotal=0,e._timeLabel=void 0,e._killCountLabel=void 0,e._monsterArmyConfig={stage1:{time:[30,60,90,120,180,200],queue:[9001,9001,9002,9002,9003,9003]},stage2:{time:[30,60,90,120,180,240,300,330],queue:[10001,10001,10002,10002,10003,10003,10004,10005]},stage3:{time:[30,60,90,120,180,240,300,330],queue:[10001,10002,10003,10003,10004,10004,10005,10006]},stage4:{time:[30,60,90,120,180,240,300,360,420,450],queue:[10001,10002,10003,10004,10005,10006,10007,10008,10009,10010]},stage5:{time:[30,60,90,120,180,240,300,360,420,450],queue:[10003,10004,10005,10006,10007,10008,10009,10009,10010,10010]}},e}a(e,t);var r=e.prototype;return r.onDestroy=function(){f.remove("endStage"),f.remove("passStage"),f.remove("updateKillCountLabel"),f.remove("updateLeaderCurTotal")},r.onLoad=function(){f.add("endStage",this.endStage.bind(this)),f.add("passStage",this.passStage.bind(this)),f.add("updateKillCountLabel",this.updateKillCountLabel.bind(this)),f.add("updateLeaderCurTotal",this.updateLeaderCurTotal.bind(this)),this._curStageName="stage"+_.curStage,this._stageConfig=this.stageConfigJson.json,this._bossConfig=this.leaderAndBossConfigJson.json[_.curStage-1],this._rewardConfig=this.rewardConfigJson.json,this._stageQueue=new m,this.initStage(this._stageConfig[this._curStageName]),console.log(this._curStageName+":",this._stageConfig[this._curStageName]),this._timeLabel=l("Canvas/heroLayer/GameUILayer/expPar/curTime").getComponent(h),this._killCountLabel=l("Canvas/heroLayer/GameUILayer/expPar/curKillCount").getComponent(h)},r.start=function(){this.startStage()},r.initStage=function(t){console.log(t);for(var e=0;e<t.length;e++){var a=t[e];this._stageQueue.enqueue(a)}this._curData=this._stageQueue.dequeue()},r.startStage=function(){null!=this._curData?(console.log("data",this._curData),this._killCount=0,this._curStageTime=0,this.updateKillCountLabel(0),this.updateTimeLabel(),this.startStageTimer(),this.schedule(this.stageQueueTaskCallBack,this._curData.timeGap)):console.warn("_curData is null, stop startStage")},r.startStageTimer=function(){this.unschedule(this.stageTimerCallback),this._curStageTime=0,this.schedule(this.stageTimerCallback,1)},r.stageTimerCallback=function(){try{if(_.stopAll)return;this._curStageTime++,this.updateTimeLabel();var t=_.curStage%5==0?5:_.curStage%5,e=this._monsterArmyConfig["stage"+t];if(e){var a=e.time.indexOf(this._curStageTime);if(a>-1){var i=d.queueMappingList[e.queue[a]],s=d.queue[i];if(!s)return void console.warn("queue is error:",i);var r=this._curData.id[Math.random()*this._curData.id.length|0];f.dispatch("createMonsterByOutsideData",r,s,{x:0,y:0})}}}catch(t){console.warn("stageTimerCallback error:",t)}},r.stageQueueTaskCallBack=function(){try{if(_.stopAll)return;if(this._curStageTime>this._curData.time)console.log("进入下一个阶段"),this._curData=this._stageQueue.dequeue(),this.unschedule(this.stageQueueTaskCallBack),this._curData?this.schedule(this.stageQueueTaskCallBack,this._curData.timeGap):this._bossConfig.bossId<0?this.passStage():(this.stopCreateMonster(),this.createBoss());else{if(!f.eventIsDefined("getMonsterTotal"))return;if(f.dispatch("getMonsterTotal")<this._curData.max)if(this._createCount++,this._createCount>this._bossConfig.startCount&&this._createCount%this._bossConfig.mod==0&&this._curLeaderTotal<this._bossConfig.maxTotal){var t=this._curData.id[Math.random()*this._curData.id.length|0],e=this._bossConfig.type[Math.random()*this._bossConfig.type.length|0];f.dispatch("createMonsterLeader",t,e),this._curLeaderTotal++}else this.createMonsterByCurData()}}catch(t){console.warn("StageManager error (ignored on web):",t)}},r.distributeReward=function(t,e){void 0===e&&(e=!1),console.log("击杀怪物总数",this._killCount),console.log("击杀精英怪总数",this._killLeaderTotal),console.log("根据击杀 发放奖励");var a=this.getPassRewardContent(e);f.dispatch("showPassReward",a,t),a.forEach((function(t){t.total>0&&f.dispatch("addItemToSS",t.id,t.total)})),e&&_.curStage+1>_.stageProgress&&(_.stageProgress=_.curStage+1,f.dispatch("savingGlobalDataToTempData"))},r.createMonsterByCurData=function(){var t=this.getIndexByRatio(this._curData.ratio),e=d.queueMappingList[this._curData.queue[t]];if("circleR1000T20"!=e&&"heartR500T40"!=e){var a=d.queue[e],i=d.queueDir[e];if(a)if(i||null===i){var s=this._curData.id[Math.random()*this._curData.id.length|0];f.dispatch("createMonsterByOutsideData",s,a,i)}else console.warn("找不到映射方向:",e);else console.warn("找不到映射队列:",e)}},r.getIndexByRatio=function(t){for(var e=Math.random(),a=0;a<t.length;a++){if(t[a]>=e)return a}console.warn("value均小于1，ratioArr 配置错误")},r.passStage=function(){this.stopCreateMonster(),this.distributeReward("通 关 奖 励",!0)},r.endStage=function(){console.log("关闭关卡"),this.stopCreateMonster(),this.distributeReward("击 杀 奖 励")},r.stopCreateMonster=function(){this.unschedule(this.stageQueueTaskCallBack),this.unschedule(this.stageTimerCallback),f.dispatch("removeAllMonsters")},r.createBoss=function(){var t=this.bossPrefabs[this._bossConfig.bossId-1];if(!t)throw"prefab is undefined";c(t).parent=l("Canvas/enemyLayer")},r.updateTimeLabel=function(){this._timeLabel.string=" 时 间 ： "+this._curStageTime+" "},r.updateKillCountLabel=function(t){this._killCount+=t,this._killCountLabel.string=" 击 杀 ： "+this._killCount+" "},r.updateLeaderCurTotal=function(t){this._curLeaderTotal+=t,t<0&&(this._killLeaderTotal+=Math.abs(t))},r.getPassRewardContent=function(t){var e=this,a=this._rewardConfig[this._curStageName],i=[];a.monsterReward.forEach((function(t,s){for(var r=a.monsterRewardRatio[s],o=0,n=0;n<e._killCount;n++){Math.random()<=r&&o++}if(o>0){var u={id:t,total:o};i.push(u)}}));var s={id:3,total:Math.ceil(this._killCount*(a.lingshi.min+Math.random()*(a.lingshi.max-a.lingshi.min)))};return i.push(s),a.leaderReward.forEach((function(t,s){for(var r=a.leaderRewardRatio[s],o=0,n=0;n<e._killLeaderTotal;n++){Math.random()<=r&&o++}if(o>0){var u={id:t,total:o};i.push(u)}})),t&&a.passReward.forEach((function(t,e){var s=a.passRewardRatio[e];Math.random()<s&&i.push({id:t,total:1})})),console.log("rewardArr",i),i},e}(g)).prototype,"stageConfigJson",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=e(L.prototype,"leaderAndBossConfigJson",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=e(L.prototype,"rewardConfigJson",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=e(L.prototype,"bossPrefabs",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=L))||T));r._RF.pop()}}}));

System.register("chunks:///_virtual/StorageSpace.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./ItemManager.ts"],(function(t){var e,i,a,r,s,o,n,m,d,h,I;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,a=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){s=t.cclegacy,o=t._decorator,n=t.JsonAsset,m=t.game,d=t.Component},function(t){h=t.em},function(t){I=t.ItemManger}],execute:function(){var c,l,u,S,p;s._RF.push({},"b3799jrBkdOuIf8jGPcYoQz","StorageSpace",void 0);var g=o.ccclass,f=o.property;t("StorageSpace",(c=g("StorageSpace"),l=f(n),c((p=e((S=function(t){function e(){for(var e,i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return e=t.call.apply(t,[this].concat(s))||this,a(e,"itemDataJson",p,r(e)),e._itemData={},e._IM=void 0,e}i(e,t);var s=e.prototype;return s.onDestroy=function(){h.remove("addItemToSS"),h.remove("reduceItemFromSS"),h.remove("itemIsEnough"),h.remove("getItemList"),h.remove("getItemDataByIdOrName"),h.remove("getItemTotalByIdOrName"),h.remove("getAllPills")},s.onLoad=function(){h.add("addItemToSS",this.addItemToSS.bind(this)),h.add("reduceItemFromSS",this.reduceItemFromSS.bind(this)),h.add("itemIsEnough",this.itemIsEnough.bind(this)),h.add("getItemList",this.getItemList.bind(this)),h.add("getItemDataByIdOrName",this.getItemDataByIdOrName.bind(this)),h.add("getItemTotalByIdOrName",this.getItemTotalByIdOrName.bind(this)),h.add("getAllPills",this.getAllPills.bind(this)),this.initItemData(),this._IM=new I,m.addPersistRootNode(this.node)},s.initItemData=function(){var t=this;this.itemDataJson.json.forEach((function(e){var i=e.id,a=e.name;t._itemData[i]=e,t._itemData[a]=e}))},s.showAll=function(){console.log("_IM",this._IM)},s.initSSData=function(){var t=h.dispatch("getTempData","storageSpace");if(null!==t)for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)){var i=t[e];this._IM.addItem(parseInt(e),i)}},s.start=function(){this.initSSData(),this.addSomeItems()},s.addSomeItems=function(){},s.helpAddItems=function(){this.addItemToSS("一阶宝箱",99),this.addItemToSS("二阶宝箱",99),this.addItemToSS("三阶宝箱",99),this.addItemToSS("四阶宝箱",99),this.addItemToSS("五阶宝箱",99),this.addItemToSS("一阶功法残卷",99),this.addItemToSS("一阶功法整卷",99)},s.helpAddItems2=function(){for(var t=1;t<62;t++)this.addItemToSS(t,100)},s.getItemDataByIdOrName=function(t){if(this._itemData.hasOwnProperty(t))return this._itemData[t];throw t+" of _itemData is null"},s.addItemToSS=function(t,e){if(!this._itemData.hasOwnProperty(t))throw"id_name err,id is "+t+" item is err";var i=this._itemData[t].id;this._IM.addItem(i,e),h.dispatch("savingToTempData","storageSpace",this.getItemList())},s.reduceItemFromSS=function(t,e){if(!this._itemData.hasOwnProperty(t))throw"id_name err,id_name is "+t+" item is err";var i=this._itemData[t].id,a=this._IM.reduceItem(i,e);return h.dispatch("savingToTempData","storageSpace",this.getItemList()),a},s.itemIsEnough=function(t,e){if(!this._itemData.hasOwnProperty(t))throw"id_name err,id_name is "+t+" item is err";var i=this._itemData[t].id;return this._IM.itemIsEnough(i,e)},s.getItemList=function(){return this._IM._itemList},s.getItemTotalByIdOrName=function(t){if(!this._itemData.hasOwnProperty(t))throw t+" of _itemData is null";var e=this._itemData[t].id;return this._IM.getItemTotal(e)},s.getAllPills=function(){var t={};for(var e in this._IM._itemList)Object.prototype.hasOwnProperty.call(this._IM._itemList,e)&&"丹药"==this._itemData[e].type&&(t[e]=this._IM._itemList[e]);return t},e}(d)).prototype,"itemDataJson",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=S))||u));s._RF.pop()}}}));

System.register("chunks:///_virtual/Sword.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalData.ts","./Weapon.ts"],(function(t){var i,n,e,s,o,a;return{setters:[function(t){i=t.inheritsLoose},function(t){n=t.cclegacy,e=t._decorator},function(t){s=t.em},function(t){o=t.tagData},function(t){a=t.Weapon}],execute:function(){var r;n._RF.push({},"129e2bHdPtBCbnuzFFQDPpA","Sword",void 0);var l=e.ccclass;e.property,t("Sword",l("Sword")(r=function(t){function n(){return t.apply(this,arguments)||this}i(n,t);var e=n.prototype;return e.init=function(t,i,n){this.initWeaponInfo(i,t,n);var e=t.name;this.initBoxCollider(o[e]),this.changeBulletRotationByFlyDir(),s.dispatch("playOneShot","battle/bullet")},e.colliderMonster=function(t){this.isStopRun(t)||this.isHasAttacked(t.node.uuid)||(this.updateMonsterBlood(t),this._hasAttackedEnemies.push(t.node.uuid),this._canAttackTimes--,this._canAttackTimes<=0&&this.recoveryToPool())},e.changeBulletRotationByFlyDir=function(){if(0!=this._flyDir.x||0!=this._flyDir.y)if(0!=this._flyDir.x)if(0!=this._flyDir.y){var t=Math.sqrt(this._flyDir.x*this._flyDir.x+this._flyDir.y*this._flyDir.y),i=Math.sin(Math.abs(this._flyDir.y)/t),n=90*Math.asin(i);this._flyDir.y>0?this._flyDir.x>0?this.node.angle=180+n:this.node.angle=360-n:this._flyDir.x>0?this.node.angle=180-n:this.node.angle=n}else this._flyDir.x>0?this.node.angle=180:this.node.angle=0;else this._flyDir.y>0?this.node.angle=-90:this.node.angle=90},n}(a))||r);n._RF.pop()}}}));

System.register("chunks:///_virtual/SwordRain.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalData.ts","./Weapon.ts"],(function(t){var i,n,e,a,s,o,l;return{setters:[function(t){i=t.inheritsLoose},function(t){n=t.cclegacy,e=t._decorator,a=t.Vec2},function(t){s=t.em},function(t){o=t.tagData},function(t){l=t.Weapon}],execute:function(){var r;n._RF.push({},"9af2aMLjflOtJfSTrAGnq5k","SwordRain",void 0);var h=e.ccclass;e.property,t("SwordRain",h("SwordRain")(r=function(t){function n(){return t.apply(this,arguments)||this}i(n,t);var e=n.prototype;return e.init=function(t){this.initSkillData(t),s.dispatch("playOneShot","battle/bullet")},e.initSkillData=function(t){this._damage=t.damage,this._duration=t.duration,this._moveSpeed=500,this._canAttackTimes=1/0,this._backDis=0,this._attackInterval=.5,this._weaponName=t.name,this._flyDir=new a(-.25,-1),this.clearCacheData(),this.initBoxCollider(o.sword),this.changeBulletRotationByFlyDir()},e.colliderMonster=function(t){this.isStopRun(t)||this.isHasAttacked(t.node.uuid)||(this.updateMonsterBlood(t),this._hasAttackedEnemies.push(t.node.uuid),this._canAttackTimes--,this._canAttackTimes<=0&&this.recoveryToPool())},e.changeBulletRotationByFlyDir=function(){if(0!=this._flyDir.x||0!=this._flyDir.y)if(0!=this._flyDir.x)if(0!=this._flyDir.y){var t=Math.sqrt(this._flyDir.x*this._flyDir.x+this._flyDir.y*this._flyDir.y),i=Math.sin(Math.abs(this._flyDir.y)/t),n=90*Math.asin(i);this._flyDir.y>0?this._flyDir.x>0?this.node.angle=180+n:this.node.angle=360-n:this._flyDir.x>0?this.node.angle=180-n:this.node.angle=n}else this._flyDir.x>0?this.node.angle=180:this.node.angle=0;else this._flyDir.y>0?this.node.angle=-90:this.node.angle=90},n}(l))||r);n._RF.pop()}}}));

System.register("chunks:///_virtual/testAds.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts"],(function(t){var e,n,s,o,r;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,s=t._decorator,o=t.Component},function(t){r=t.em}],execute:function(){var c;n._RF.push({},"2b285d1pABPvbomGQPT2Bdu","testAds",void 0);var i=s.ccclass;t("testAds",i("testAds")(c=function(t){function n(){return t.apply(this,arguments)||this}return e(n,t),n.prototype.start=function(){r.dispatch("createPlayADEvent",this.node,"GameMonetize")},n}(o))||c);n._RF.pop()}}}));

System.register("chunks:///_virtual/ThousandsSwordToTomb.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalData.ts","./Weapon.ts"],(function(t){var o,i,n,e,s,a,r,c,l,h,d,m,p,u,v,f,D;return{setters:[function(t){o=t.inheritsLoose},function(t){i=t.cclegacy,n=t._decorator,e=t.UITransform,s=t.Sprite,a=t.Color,r=t.math,c=t.Vec2,l=t.BoxCollider2D,h=t.Contact2DType,d=t.tween,m=t.Vec3},function(t){p=t.em},function(t){u=t.tagData,v=t.groupIndex,f=t.ggd},function(t){D=t.Weapon}],execute:function(){var _;i._RF.push({},"25249OVHDpCfIXwpquDtNdf","ThousandsSwordToTomb",void 0);var y=n.ccclass;n.property,t("ThousandsSwordToTomb",y("ThousandsSwordToTomb")(_=function(t){function i(){for(var o,i=arguments.length,n=new Array(i),e=0;e<i;e++)n[e]=arguments[e];return(o=t.call.apply(t,[this].concat(n))||this)._moveDistance=void 0,o._isPlayAnim=void 0,o}o(i,t);var n=i.prototype;return n.init=function(t){this.initSkillData(t)},n.initSkillData=function(t){this._isPlayAnim=!1,this._damage=t.damage,this._moveDistance=t.moveDistance-this.node.getComponent(e).contentSize.x/4,console.log("data.moveDistance",t.moveDistance),console.log("this._moveDistance",this._moveDistance),this._moveSpeed=2e3,this._canAttackTimes=1/0,this._backDis=0,this._attackInterval=.5,this._weaponName=t.name,this.node.getComponent(s).color=new a(255,204,0,255);var o=p.dispatch("getHeroWorldPos"),i=r.random()>.5?Math.random():-r.random();i*=.7;var n=t.moveDistance;this.node.setWorldPosition(o.x-n*i,o.y+n,o.z),this._flyDir=new c(i,-1),console.log("this._flyDir",this._flyDir),this.clearCacheData(),this.initBoxCollider(u.sword),this.changeBulletRotationByFlyDir()},n.initBoxCollider=function(t,o){if(!t)throw"tag is"+t;var i=this.node.getComponent(l);i||(i=this.node.addComponent(l)),i.tag=t,i.group=v.heroWeapon,i.on(h.BEGIN_CONTACT,this.onBeginContact,this),i.on(h.END_CONTACT,this.onEndContact,this)},n.weaponMove=function(t){if(!f.stopAll&&this._flyDir)if(this._moveDistance<=0)this.playDestroyAnim();else if(0!=this._moveSpeed){var o=t*this._moveSpeed,i=this._flyDir.x*o,n=this._flyDir.y*o;this.node.setPosition(this.node.getPosition().x+i,this.node.getPosition().y+n,0),this._moveDistance+=n}},n.playDestroyAnim=function(){var t=this;if(!this._isPlayAnim){p.dispatch("playOneShot","battle/砸地"),this._isPlayAnim=!0;var o=new a(255,255,255,255);d(this.node).by(.5,{position:new m(0,0,0)},{onUpdate:function(i,n){t.node.getComponent(s).color=a.lerp(new a,o,new a(o.r,o.g,o.b,0),n)}}).call((function(){t.recoveryToPool()})).start()}},i}(D))||_);i._RF.pop()}}}));

System.register("chunks:///_virtual/TipView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts"],(function(e){var o,n,t,i,r,c,p,s,a,u;return{setters:[function(e){o=e.inheritsLoose},function(e){n=e.cclegacy,t=e._decorator,i=e.Label,r=e.tween,c=e.Vec3,p=e.Sprite,s=e.Color,a=e.Component},function(e){u=e.em}],execute:function(){var l;n._RF.push({},"39f4bK1+n9Lsp/dZy6C5YpZ","TipView",void 0);var w=t.ccclass;t.property,e("TipView",w("TipView")(l=function(e){function n(){return e.apply(this,arguments)||this}o(n,e);var t=n.prototype;return t.onLoad=function(){u.add("tipsViewShow",this.tipsViewShow.bind(this))},t.onDestroy=function(){u.remove("tipsViewShow")},t.tipsViewShow=function(e,o){void 0===e&&(e="请传参"),void 0===o&&(o=1),this.node.children[0].getComponent(i).string=e;var n=r().to(.5,{scale:new c(1,1,1)},{onUpdate:function(e,o){var n=e.getComponent(p).color;e.getComponent(p).color=s.lerp(new s,n,new s(n.r,n.g,n.b,255),o)}}),t=r().to(.5,{scale:new c(1,1,1)},{onUpdate:function(e,o){var n=e.getComponent(p).color;e.getComponent(p).color=s.lerp(new s,n,new s(n.r,n.g,n.b,0),o)}}),a=r().delay(o);r(this.node).sequence(n,a,t).start()},n}(a))||l);n._RF.pop()}}}));

System.register("chunks:///_virtual/TrainingLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalFun.ts","./PoolManager.ts","./LevelManager.ts"],(function(i){var n,t,e,r,a,s,o,l,p,g,c,u,h,d,v,L,f,_,m,b;return{setters:[function(i){n=i.applyDecoratedDescriptor,t=i.inheritsLoose,e=i.initializerDefineProperty,r=i.assertThisInitialized},function(i){a=i.cclegacy,s=i._decorator,o=i.JsonAsset,l=i.Prefab,p=i.Node,g=i.Sprite,c=i.Label,u=i.find,h=i.NodePool,d=i.tween,v=i.Vec3,L=i.Component},function(i){f=i.em},function(i){_=i.glf},function(i){m=i.plm},function(i){b=i.LevelManager}],execute:function(){var P,T,y,w,x,C,E,B,U,D,S,M,I,A,z,N,V;a._RF.push({},"9d7ecxRXdtAUbVGlUY0HvPs","TrainingLayer",void 0);var F=s.ccclass,O=s.property;i("TrainingLayer",(P=F("TrainingLayer"),T=O(o),y=O(l),w=O(p),x=O(g),C=O(c),E=O(c),B=O(p),P((S=n((D=function(i){function n(){for(var n,t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a))||this,e(n,"trainingLvListJson",S,r(n)),e(n,"pillPrefab",M,r(n)),e(n,"pillPar",I,r(n)),e(n,"expProgress",A,r(n)),e(n,"expProgressDescription",z,r(n)),e(n,"trainingLv",N,r(n)),e(n,"trainingBonusLabelPar",V,r(n)),n._itemPrefabArr=[],n._trainingLvList=void 0,n._yellowCircle=void 0,n._rotationSpeed=100,n._pillList=void 0,n._isUpgrading=!1,n._curTrainingExp=void 0,n._curTrainingLv=void 0,n._TIM=void 0,n}t(n,i);var a=n.prototype;return a.onLoad=function(){this._yellowCircle=u("trainingCircle",this.node),this._pillList=u("pillList",this.node),this._trainingLvList=this.trainingLvListJson.json,m.addPoolToPools("TLPillPrefab",new h,this.pillPrefab)},a.onEnable=function(){this.updatePillsContent()},a.updatePillsContent=function(){var i=this;for(console.log("updatePillsContent");this._itemPrefabArr.length>0;){var n=this._itemPrefabArr.shift();m.putToPool("TLPillPrefab",n)}var t=f.dispatch("getAllPills"),e=function(){if(Object.prototype.hasOwnProperty.call(t,r)){var n=t[r],e=m.getFromPool("TLPillPrefab");e.parent=i.pillPar;var a=f.dispatch("getItemDataByIdOrName",r);e.getChildByName("name").getComponent(c).string=a.name+"\nX"+n;var s=e.getChildByName("sprite").getComponent(g),o="images/items/"+a.loadUrl+"/spriteFrame";f.dispatch("loadTheDirResources",o,(function(i){return s.spriteFrame=i})),_.createButton(i.node,e,"TrainingLayer","onBtnUsingPill",a.name),i._itemPrefabArr.push(e)}};for(var r in t)e()},a.start=function(){this.initTrainingLv()},a.initTrainingLv=function(){var i=f.dispatch("getTempData","training");null===i?(this._curTrainingExp=0,this._curTrainingLv=0):(this._curTrainingExp=i.curExp,this._curTrainingLv=i.curLv,console.log("读取列表 配置修为 还没写"));var n={level:0,maxLevel:this._trainingLvList.length-1,curExp:0,levelMappingExpList:this._trainingLvList};this._TIM=new b(n),this._TIM.addExp(this._curTrainingExp),this.updateProgressView()},a.savingTrainingData=function(){var i={curExp:this._curTrainingExp,curLv:this._curTrainingLv};f.dispatch("savingToTempData","training",i)},a.onBtnUsingPill=function(i,n){var t;switch(f.dispatch("playOneShot","common/吃药"),f.dispatch("reduceItemFromSS",n,1),this.updatePillsContent(),console.log("加经验 还没写"),n){case"炼气丹":t=1;break;case"筑基丹":t=10;break;case"金元丹":t=100;break;case"元婴丹":t=1e3;break;default:t=0,console.warn("尚未添加丹药"+n+"的经验值")}this._TIM.addExp(t),this._curTrainingExp=this._TIM.curExp,this.updateProgressView(),this.savingTrainingData()},a.updateProgressView=function(){var i=this._trainingLvList[this._curTrainingLv].exp,n=this._curTrainingExp+"/"+i,t=this._trainingLvList[this._curTrainingLv],e=this.trainingBonusLabelPar;this.expProgressDescription.string=n,this.expProgress.fillRange=this._curTrainingExp/i,this.trainingLv.string=t.name,e.getChildByName("l1").getComponent(c).string="血量加成："+t.blood,e.getChildByName("l2").getComponent(c).string="伤害加成："+t.damage,e.getChildByName("l3").getComponent(c).string="移速加成："+t.moveSpeed},a.onBtnUpgrade=function(){this._isUpgrading?f.dispatch("tipsViewShow","突破中..."):this.isCanUpgrade()?(this._isUpgrading=!0,this._curTrainingLv++,this.playUpgradeAnim(),this.savingTrainingData()):f.dispatch("tipsViewShow","当前状态无法突破。")},a.isCanUpgrade=function(){return this._TIM.level>this._curTrainingLv},a.playUpgradeAnim=function(){var i=this;f.dispatch("playOneShot","common/突破"),d(this._yellowCircle).call((function(){i._rotationSpeed=-500})).to(2.5,{scale:new v(2,2,1)},{easing:"cubicIn"}).to(2.5,{scale:new v(1,1,1)},{easing:"cubicOut"}).call((function(){i._rotationSpeed=100,i._isUpgrading=!1,i.updateProgressView()})).start()},a.update=function(i){this._yellowCircle.angle+=this._rotationSpeed*i},n}(L)).prototype,"trainingLvListJson",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=n(D.prototype,"pillPrefab",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=n(D.prototype,"pillPar",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=n(D.prototype,"expProgress",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=n(D.prototype,"expProgressDescription",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N=n(D.prototype,"trainingLv",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V=n(D.prototype,"trainingBonusLabelPar",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U=D))||U));a._RF.pop()}}}));

System.register("chunks:///_virtual/Weapon.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalData.ts","./PoolManager.ts"],(function(t){var i,e,o,n,a,s,r,c,h,l,d,u,_,g;return{setters:[function(t){i=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator,n=t.BoxCollider2D,a=t.UITransform,s=t.Size,r=t.Contact2DType,c=t.CircleCollider2D,h=t.Component},function(t){l=t.em},function(t){d=t.groupIndex,u=t.ggd,_=t.tagData},function(t){g=t.plm}],execute:function(){var p;e._RF.push({},"cafd4Zb9TdIspSioAwoZg46","Weapon",void 0);var f=o.ccclass;t("Weapon",f("Weapon")(p=function(t){function e(){for(var i,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(i=t.call.apply(t,[this].concat(o))||this)._curLevel=void 0,i._curData=void 0,i._weaponId=void 0,i._weaponName=void 0,i._imageIndex=void 0,i._damage=void 0,i._duration=void 0,i._moveSpeed=void 0,i._maxLevel=void 0,i._canAttackTimes=void 0,i._backDis=void 0,i._attackInterval=void 0,i._flyDir=void 0,i._touchingArr=[],i._hasAttackedEnemies=[],i}i(e,t);var o=e.prototype;return o.initWeaponInfo=function(t,i,e){void 0===e&&(e={x:1,y:1}),this._curLevel=t,this._curData=i,this._weaponId=i.id,this._weaponName=i.name,this._imageIndex=i.imageIndex,this._maxLevel=i.maxLevel,this.initCurLvInfo(),this._flyDir=e,this.clearCacheData()},o.initCurLvInfo=function(){var t=this._curLevel-1;if(this._damage=this._curData.damage[t],this._duration=this._curData.duration.length>0?this._curData.duration[t]:1/0,this._moveSpeed=this._curData.moveSpeed.length>0?this._curData.moveSpeed[t]:0,this._canAttackTimes=this._curData.canAttackTimes.length>0?this._curData.canAttackTimes[t]:1/0,this._backDis=this._curData.backDis.length>0?this._curData.backDis[t]:0,this._attackInterval=this._curData.attackInterval.length>0?this._curData.attackInterval[t]:.5,0!==this._duration){var i=l.dispatch("getHeroControlProperty","_bonusBulletDuration");this._duration+=i}if(0!==this._moveSpeed){var e=l.dispatch("getHeroControlProperty","_bonusBulletMoveSpeed");this._moveSpeed+=e}if(0!==this._canAttackTimes){var o=l.dispatch("getHeroControlProperty","_bonusBulletAttackTimes");this._canAttackTimes+=o}},o.clearCacheData=function(){this._touchingArr.length=0,this._hasAttackedEnemies.length=0},o.initBoxCollider=function(t,i){if(void 0===i&&(i={x:0,y:0}),!t)throw"tag is"+t;var e=this.node.getComponent(n);e||(e=this.node.addComponent(n));var o=this.node.getComponent(a),c=new s(o.contentSize.x+i.x,o.contentSize.y+i.y);e.tag=t,e.size=c,e.group=d.heroWeapon,e.on(r.BEGIN_CONTACT,this.onBeginContact,this),e.on(r.END_CONTACT,this.onEndContact,this)},o.initCircleCollider=function(t,i){if(void 0===i&&(i=0),!t)throw"tag is"+t;var e=this.node.getComponent(c);e||(e=this.node.addComponent(c));var o=this.node.getComponent(a);e.tag=t,e.radius=o.contentSize.x/2+i,e.group=d.heroWeapon,e.on(r.BEGIN_CONTACT,this.onBeginContact,this),e.on(r.END_CONTACT,this.onEndContact,this)},o.update=function(t){this.weaponMove(t),this.weaponDuration(t)},o.weaponMove=function(t){if(!u.stopAll&&this._flyDir&&0!=this._moveSpeed&&this._duration!=1/0){var i=t*this._moveSpeed,e=this._flyDir.x*i,o=this._flyDir.y*i;this.node.setPosition(this.node.getPosition().x+e,this.node.getPosition().y+o,0)}},o.weaponDuration=function(t){u.stopAll||(this._duration-=t,this._duration<=0&&this.recoveryToPool())},o.changeBulletRotationByFlyDir=function(){if(0!=this._flyDir.x||0!=this._flyDir.y)if(0!=this._flyDir.x)if(0!=this._flyDir.y){var t=Math.sqrt(this._flyDir.x*this._flyDir.x+this._flyDir.y*this._flyDir.y),i=Math.sin(Math.abs(this._flyDir.y)/t),e=90*Math.asin(i);this._flyDir.y>0?this._flyDir.x>0?this.node.angle=180+e:this.node.angle=360-e:this._flyDir.x>0?this.node.angle=180-e:this.node.angle=e}else this._flyDir.x>0?this.node.angle=180:this.node.angle=0;else this._flyDir.y>0?this.node.angle=-90:this.node.angle=90},o.onBeginContact=function(t,i){switch(i.tag){case _.wall:this.colliderWall(i);break;case _.monster:this._touchingArr.push(i),this.colliderMonster(i);break;case _.boss:this._touchingArr.push(i),this.colliderBoss(i);break;default:if([_.fireBall,_.fireBallFire].indexOf(i.tag)>-1)break;console.warn("未处理的碰撞结束："+t.tag+"与"+i.tag+"发生碰撞")}},o.onEndContact=function(t,i){switch(i.tag){case _.monster:case _.boss:this.colliderEnemyEnd(i);break;default:if([_.fireBall,_.fireBallFire].indexOf(i.tag)>-1)break;console.warn("未处理的碰撞结束："+t.tag+"与"+i.tag+"发生碰撞")}},o.colliderWall=function(t){console.log(this._weaponName+"撞墙")},o.colliderMonster=function(t){this.isStopRun(t)||(this.updateMonsterBlood(t),this._canAttackTimes--,this._canAttackTimes<=0&&this.recoveryToPool())},o.colliderBoss=function(t){this.isStopRun(t)||(this.updateBossBlood(t),this.updateCanAttackTimes())},o.colliderEnemyEnd=function(t){var i=this._touchingArr.indexOf(t);i>-1&&this._touchingArr.splice(i,1)[0]},o.isTouching=function(t){return this._touchingArr.indexOf(t)>-1},o.isHasAttacked=function(t){return this._hasAttackedEnemies.indexOf(t)>-1},o.updateMonsterBlood=function(t){var i=l.dispatch("usingHeroControlFun","getCurDamage")+this._damage;l.dispatch("usingHeroControlFun","isCriticalHit")?(i*=2,l.dispatch("createDamageTex",t.node,i,{x:0,y:20},"criticalHit")):l.dispatch("createDamageTex",t.node,i,{x:0,y:20}),t.node.getComponent("Monster").updateBlood(-i,this._backDis)},o.updateBossBlood=function(t){var i=l.dispatch("usingHeroControlFun","getCurDamage")+this._damage;l.dispatch("createDamageTex",t.node,i,{x:0,y:20});var e=t.node.parent.components[0];if(!e)throw"script is not init";e.updateBlood(-i)},o.isStopRun=function(t){return u.stopAll&&!this.isTouching(t)},o.recoveryToPool=function(){g.putToPool(this._weaponName,this.node)},o.updateCanAttackTimes=function(){this._canAttackTimes--,this._canAttackTimes<=0&&this.recoveryToPool()},e}(h))||p);e._RF.pop()}}}));

System.register("chunks:///_virtual/weaponManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./globalData.ts","./globalFun.ts","./PoolManager.ts","./Queue.ts"],(function(e){var t,o,a,r,i,n,s,l,d,u,h,p,c,g,f,v,m,P,w,b,S,y;return{setters:[function(e){t=e.applyDecoratedDescriptor,o=e.inheritsLoose,a=e.initializerDefineProperty,r=e.assertThisInitialized,i=e.createForOfIteratorHelperLoose},function(e){n=e.cclegacy,s=e._decorator,l=e.JsonAsset,d=e.Node,u=e.Material,h=e.NodePool,p=e.find,c=e.Vec2,g=e.Sprite,f=e.instantiate,v=e.Component,m=e.Label},function(e){P=e.em},function(e){w=e.ggd},function(e){b=e.glf},function(e){S=e.plm},function(e){y=e.Queue}],execute:function(){var _,F,D,W,C,L,T,B,k,H,M;n._RF.push({},"a567cNLrvhBJYPPuiBF6V0Q","weaponManager",void 0);var O=s.ccclass,U=s.property;e("weaponManager",(_=O("WeaponManager"),F=U(l),D=U(d),W=U(u),C=U(u),_((B=t((T=function(e){function t(){for(var t,o=arguments.length,i=new Array(o),n=0;n<o;n++)i[n]=arguments[n];return t=e.call.apply(e,[this].concat(i))||this,a(t,"weaponDataJson",B,r(t)),a(t,"btnNodes",k,r(t)),a(t,"defaultMaterial",H,r(t)),a(t,"guardUltimateSkillMaterial",M,r(t)),t._spellPrefab=void 0,t._swordPrefab=void 0,t._dartsPrefab=void 0,t._swordRainPrefab=void 0,t._justOneSwordDivideWorldPrefab=void 0,t._iceConePrefab=void 0,t._moveLikeFirePrefab=void 0,t._thousandsSwordToTombPrefab=void 0,t._fireBloomPrefab=void 0,t._hellFirePrefab=void 0,t._thousandsSwordToTombQueue=new y,t._fireBloomQueue=new y,t._hellFireQueue=new y,t._swordLv=0,t._guardLv=0,t._spellLv=0,t._dartsLv=0,t._rewardConfig=null,t._weaponData={},t}o(t,e);var n=t.prototype;return n.onDestroy=function(){P.remove("updateSelectWeapon"),P.remove("getWeaponDataByIdOrName"),P.remove("usingWeaponManagerFun"),P.remove("getWeaponManagerProperty")},n.onLoad=function(){P.add("updateSelectWeapon",this.updateSelectWeapon.bind(this)),P.add("getWeaponDataByIdOrName",this.getWeaponDataByIdOrName.bind(this)),P.add("usingWeaponManagerFun",this.usingWeaponManagerFun.bind(this)),P.add("getWeaponManagerProperty",this.getWeaponManagerProperty.bind(this)),this.initWeaponData(),this.initWeaponConfig(),this.dynamicLoadPrefabs(),this.startUsingWeapon()},n.startUsingWeapon=function(){this._swordLv=1,this.isUsingSword(!0)},n.usingMaxLvWeapon=function(){this._swordLv=9,this._guardLv=3,this._spellLv=9,this._dartsLv=9,this.isUsingSword(!0),this.isUsingDarts(!0),this.isUsingGuard(!0),this.isUsingSpell(!0)},n.initWeaponData=function(){var e=this;this.weaponDataJson.json.forEach((function(t){var o=t.id,a=t.name;e._weaponData[o]=t,e._weaponData[a]=t}))},n.initWeaponConfig=function(){this._rewardConfig=["restoreHP","addMoveSpeed","addCriticalHitRate","sword","guard","spell","darts"]},n.dynamicLoadPrefabs=function(){this.loadPrefab("sword"),this.loadPrefab("darts"),this.loadPrefab("spell"),this.loadPrefab("thousandsSwordToTomb"),this.loadPrefab("justOneSwordDivideWorld"),this.loadPrefab("swordRain"),this.loadPrefab("iceCone"),this.loadPrefab("fireBloom"),this.loadPrefab("hellFire"),this.loadPrefab("moveLikeFire")},n.loadPrefab=function(e,t){var o=this;void 0===t&&(t=null);var a="_"+e+"Prefab";P.dispatch("loadTheDirResources","/prefabs/hero/weapon/"+e,(function(r){t?t(r):(o[a]=r,S.addPoolToPools(e,new h,o[a]))}))},n.isUsingSpell=function(e){if(console.log("初始化护符"),p("spellPar",this.node).active=e,e){var t=this.getWeaponDataByIdOrName("spell").total[this._spellLv-1];t+=P.dispatch("getHeroControlProperty","_bonusBulletTotal"),this.openSpell(t)}},n.openSpell=function(e,t){var o=this;if(void 0===t&&(t=100),t<=10)return console.log("半径过小");for(var a=p("spellPar",this.node),r=0;r<a.children.length;r++){var i=a.children[r];S.putToPool("spell",i),r--}for(var n=2*Math.PI/e,s=360/e,l=[],d=0;d<e;d++){var u=d*n,c=Math.cos(u)*t,g=Math.sin(u)*t;l.push([c,g])}for(var f=function(e){var t=l[e],a=S.getFromPool("spell");a?o.initSpell(a,t,e*s):o.loadPrefab("spell",(function(r){o._spellPrefab=r,S.addPoolToPools("spell",new h,o._spellPrefab),a=S.getFromPool("spell"),o.initSpell(a,t,e*s)}))},v=0;v<l.length;v++)f(v);this.unschedule(this.spellParRotate),this.schedule(this.spellParRotate,1/60)},n.initSpell=function(e,t,o){var a=this.getWeaponDataByIdOrName("spell");e.parent=p("spellPar",this.node),e.setPosition(t[0],t[1],0),e.angle=o,e.getComponent("Spell").init(a,this._spellLv)},n.spellParRotate=function(){if(!w.stopAll){p("spellPar",this.node).angle+=3}},n.isOpenSpellUltimateSkill=function(e){if(e){this.usingSpellUltimateSkill();var t=this.getWeaponDataByIdOrName("spell").USInterval;this.schedule(this.usingSpellUltimateSkill,t)}else this.unschedule(this.usingSpellUltimateSkill)},n.usingSpellUltimateSkill=function(){var e=this;if(!w.stopAll){console.log("释放护符大招");for(var t=150,o=p("spellPar",this.node),a=this.getWeaponDataByIdOrName("spell"),r=1/60,i=2*Math.PI/16,n=[],s=0;s<16;s++){var l=s*i,d=Math.cos(l)*t,u=Math.sin(l)*t;n.push([d,u])}for(var h=function(){var i=n[c],s=S.getFromPool("spell");s.getComponent("Spell").init(a,e._spellLv),s.parent=o,s.setPosition(i[0],i[1],0);var l=22.5*c;s.angle=l;var d=120;e.schedule((function o(){if(--d<=0&&(console.log("times over , disappear"),e.unschedule(o),S.putToPool("spell",s)),w.stopAll)d++;else{var a=s.getPosition();s.setPosition(a.x+i[0]/t*3,a.y+i[1]/t*3,0)}}),r)},c=0;c<n.length;c++)h();this.unschedule(this.spellParRotate),this.schedule(this.spellParRotate,r)}},n.isUsingGuard=function(e){var t=p("guard",this.node);if(t.active=e,e){var o=this.getWeaponDataByIdOrName("guard");console.log("guard",o);var a=o.total[this._guardLv-1];t.setScale(a,a),t.getComponent("Guard").init(o,this._guardLv),t.active=!0}},n.isOpenGuardUltimateSkill=function(e){},n.isUsingSword=function(e){if(e){this.schedule(this.createSword,.5)}else this.unschedule(this.createSword)},n.createSword=function(){var e=this;if(!w.stopAll){var t=this.getWeaponDataByIdOrName("sword").total[this._swordLv-1];if(!(t+=P.dispatch("getHeroControlProperty","_bonusBulletTotal")))throw"total err,total is "+t;var o=P.dispatch("getHeroControlProperty","_curDirection");if(0!=o.x||0!=o.y)for(var a=this.getFlySwordInitPos(t),r=function(t){var o=S.getFromPool("sword");o?e.initSword(o,a[t]):e.loadPrefab("sword",(function(r){e._swordPrefab=r,S.addPoolToPools("sword",new h,e._swordPrefab),o=S.getFromPool("sword"),e.initSword(o,a[t])}))},i=0;i<t;i++)r(i)}},n.initSword=function(e,t){var o=this.getWeaponDataByIdOrName("sword");e.setPosition(0,0,0);var a=p("Canvas/bulletLayer");e.parent=a;var r=this.getFlyDir(P.dispatch("getHeroControlProperty","_curDirection")),i=P.dispatch("getHeroWorldPos");i.x+=t.x,i.y+=t.y,e.setWorldPosition(i),e.getComponent("Sword").init(o,this._swordLv,r)},n.getFlySwordInitPos=function(e){var t=[];console.log();for(var o=0;o<e;o++){var a=o%3,r={x:0==a?0:1==a?30:-30,y:30*(o/3|0)};t.push(r)}return t},n.usingSwordUltimateSkill=function(){if(!w.stopAll){console.log("释放剑大招");for(var e=b.getCirclePos(50,20),t=this.getWeaponDataByIdOrName("sword"),o=0;o<20;o++){var a=S.getFromPool("sword");a.setPosition(0,0,0);var r=p("Canvas/bulletLayer");a.parent=r;var i=e[o],n={x:i[0]/50,y:i[1]/50},s=this.getFlyDir(n),l=P.dispatch("getHeroWorldPos");l.x+=i[0],l.y+=i[1],a.setWorldPosition(l),a.getComponent("Sword").init(t,this._swordLv,s)}}},n.isOpenSwordUltimateSkill=function(e){if(e){var t=this.getWeaponDataByIdOrName("sword").USInterval;this.schedule(this.usingSwordUltimateSkill,t)}else this.unschedule(this.usingSwordUltimateSkill)},n.isUsingDarts=function(e){if(e){this.schedule(this.createDarts,1)}else this.unschedule(this.createDarts)},n.createDarts=function(){var e=this;if(!w.stopAll){var t=this.getWeaponDataByIdOrName("darts").total[this._dartsLv-1];if(!(t+=P.dispatch("getHeroControlProperty","_bonusBulletTotal")))throw"total err,total is "+t;var o=P.dispatch("getHeroControlProperty","_curDirection");if(0!=o.x||0!=o.y)for(var a=o,r=this.getFlyDirArr(a,t),i=function(t){var o=S.getFromPool("darts");o?e.initDarts(o,r[t],t):e.loadPrefab("darts",(function(a){e._dartsPrefab=a,S.addPoolToPools("darts",new h,e._dartsPrefab),o=S.getFromPool("darts"),o=f(a),e.initDarts(o,r[t],t)}))},n=0;n<t;n++)i(n)}},n.initDarts=function(e,t,o){var a=this.getWeaponDataByIdOrName("darts");e.setPosition(0,0,0);var r=p("Canvas/bulletLayer");e.parent=r;var i=new c(50*t.x*(Math.floor(o/4)+1),50*t.y*(Math.floor(o/4)+1)),n=P.dispatch("getHeroWorldPos");n.x+=i.x,n.y+=i.y,e.setWorldPosition(n),this._dartsLv==a.maxLevel?e.getComponent("Darts").init(a,this._dartsLv,t,!0,1):e.getComponent("Darts").init(a,this._dartsLv,t)},n.isOpenDartsUltimateSkill=function(e){console.log("飞镖可分裂")},n.getFlyDir=function(e){return new c(e.x,e.y)},n.getFlyDirArr=function(e,t){for(var o=[],a=0;a<t;a++)o.push(this.getRotationDir(e,90*a));return o},n.getRotationDir=function(e,t){var o=t*Math.PI/180,a=e.x,r=e.y,i=a*Math.cos(o)-r*Math.sin(o),n=a*Math.sin(o)+r*Math.cos(o);return new c(i,n)},n.getUpgradeReward=function(e,t){p("GameUILayer/selectWeapon",this.node.parent).active=!1;for(var o,a=i(this.btnNodes);!(o=a()).done;){o.value.getComponent(g).spriteFrame=null}switch(w.stopAll=p("GameUILayer/passRewardLayer",this.node.parent).active,t){case"restoreHP":this.restoreHP();break;case"addMoveSpeed":P.dispatch("usingHeroControlFun","updateBonusMoveSpeed",30);break;case"addCriticalHitRate":P.dispatch("usingHeroControlFun","updateBonusCriticalHitRate",5);break;default:if(this.isHasWeaponByName(t)){this.upgradeWeaponByWeaponName(t);break}throw"type error,type is "+t}P.dispatch("usingHeroControlFun","resumeGame")},n.updateSelectWeapon=function(){var e=this;console.log("打开并刷新武器选择界面 还没写");var t=this.btnNodes.length,o=0,a=[];if(this._rewardConfig.length<t)throw"this._rewardConfig.length is err,this._rewardConfig is "+this._rewardConfig;for(;t!=o;){var r=this._rewardConfig[Math.random()*this._rewardConfig.length|0];a.indexOf(r)<0&&(a.push(r),o++)}console.log("randomArr",a);for(var i=function(){var t=e.btnNodes[n],o=a[n],r=t.getComponent(g);P.dispatch("loadTheDirResources","images/weapons/"+o+"/spriteFrame",(function(e){return r.spriteFrame=e})),b.createButton(e.node,t,"WeaponManager","getUpgradeReward",o);var i=t.children[0].getComponent(m);e.updateUpgradeWeaponDescription(i,o)},n=0;n<this.btnNodes.length;n++)i();if(console.log("open auto script",P.dispatch("getHeroControlProperty","_openAutoScript")),P.dispatch("getHeroControlProperty","_openAutoScript")){var s=a[Math.random()*a.length|0];console.log("getUpgradeReward name",s),this.getUpgradeReward(null,s)}},n.updateUpgradeWeaponDescription=function(e,t){switch(t){case"restoreHP":e.string="血量拉满";break;case"addMoveSpeed":e.string="增加30移速";break;case"addCriticalHitRate":e.string="增加5%暴击率";break;default:if(this.isHasWeaponByName(t)){e.string=this.getUpgradeWeaponDescription(t);break}throw"type error,type is "+t}},n.getUpgradeWeaponDescription=function(e){var t=this.getWeaponDataByIdOrName(e),o=this["_"+t.name+"Lv"]+1;if(1==o)return t.minLvTex;if(o==t.maxLevel)return t.maxLvTex;var a="\n";return t.damage[o-2]!=t.damage[o-1]&&(a+="技能伤害提升\n"),t.duration.length>0&&t.duration[o-2]!=t.duration[o-1]&&(a+="技能持续时间增强\n"),t.moveSpeed.length>0&&t.moveSpeed[o-2]!=t.moveSpeed[o-1]&&(a+="技能飞行速度增快\n"),t.canAttackTimes.length>0&&t.canAttackTimes[o-2]!=t.canAttackTimes[o-1]&&(a+="技能穿透次数增加\n"),t.backDis.length>0&&t.backDis[o-2]!=t.backDis[o-1]&&(a+="技能击退效果增强\n"),t.attackInterval.length>0&&t.attackInterval[o-2]!=t.attackInterval[o-1]&&(a+="技能攻击频率增加\n"),a},n.upgradeWeaponByWeaponName=function(e){var t=this.getWeaponDataByIdOrName(e);if(!t)throw"data is error,current data is "+t;if(this["_"+e+"Lv"]!=t.maxLevel){this["_"+e+"Lv"]++;var o=this.getNewStringFirstLetterToUpperCase(e);if(this["isUsing"+o](!0),this["_"+e+"Lv"]==t.maxLevel){this.deleteFillLevelWeaponFromRewardConfig(e);var a="isOpen"+o+"UltimateSkill";console.log("string",a),this[a](!0)}}},n.getNewStringFirstLetterToUpperCase=function(e){return e[0].toUpperCase()+e.substring(1)},n.deleteFillLevelWeaponFromRewardConfig=function(e){var t=this._rewardConfig.indexOf(e);if(!(t>-1))throw"weapon name is error,wn is "+e;this._rewardConfig.splice(t,1)},n.restoreHP=function(){P.dispatch("usingHeroControlFun","updateBloodProgress",999999)},n.getWeaponDes=function(){return"飞剑术等级："+this._swordLv+"\n"+("防护罩等级："+this._guardLv+"\n")+("旋转护符等级："+this._spellLv+"\n")+("六角镖等级："+this._dartsLv+"\n")},n.getWeaponDataByIdOrName=function(e){if(this._weaponData.hasOwnProperty(e))return this._weaponData[e];throw e+" of _weaponData is null"},n.isHasWeaponByName=function(e){return this._weaponData.hasOwnProperty(e)},n.usingWeaponManagerFun=function(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),a=1;a<t;a++)o[a-1]=arguments[a];if(this[e]&&"function"==typeof this[e])return this[e].apply(this,o);throw e+" is not fun or undefined"},n.getWeaponManagerProperty=function(e){if(this.hasOwnProperty(e))return this[e];throw"hero control 中不存在属性："+e},n.usingSkillSwordRain=function(){var e=this;if(!w.stopAll){this.schedule((function(){for(var t=function(t){var o=S.getFromPool("swordRain");o?e.initSwordRain(o,80*t-160):e.loadPrefab("swordRain",(function(a){e._swordRainPrefab=a,S.addPoolToPools("swordRain",new h,e._swordRainPrefab),o=S.getFromPool("swordRain"),e.initSwordRain(o,80*t-160)}))},o=0;o<5;o++)t(o)}),.2,5,0)}},n.initSwordRain=function(e,t){var o=P.dispatch("usingHeroBasePropertyFun","getSkillBookDataByIdOrName","剑雨术"),a={name:o.name2,duration:o.duration,damage:o.baseDamage};e.setPosition(0,0,0);var r=p("Canvas/bulletLayer");e.parent=r;var i=P.dispatch("getHeroWorldPos");i.x+=t,i.y+=500,e.setWorldPosition(i),e.getComponent("SwordRain").init(a)},n.usingSkillJustOneSwordDivideWorld=function(){var e=this;console.log("通过头的朝向获取方向，还没写"),this._justOneSwordDivideWorldPrefab?this.initJustOneSwordDivideWorld():this.loadPrefab("justOneSwordDivideWorld",(function(t){e._justOneSwordDivideWorldPrefab=t,e.initJustOneSwordDivideWorld()}))},n.initJustOneSwordDivideWorld=function(){var e=this,t=P.dispatch("usingHeroBasePropertyFun","getSkillBookDataByIdOrName","一剑隔世"),o={name:t.name2,duration:t.duration,damage:t.baseDamage},a=f(this._justOneSwordDivideWorldPrefab),r=p("Canvas/bulletLayer");a.parent=r;var i=P.dispatch("getHeroWorldPos");a.setWorldPosition(i),a.getComponent("JustOneSwordDivideWorld").init(o);var n=0,s=function t(){a.angle+=30,(n+=30)>=360&&(e.unschedule(t),a.getComponent("JustOneSwordDivideWorld").recoveryToPool())};this.scheduleOnce((function(){a.getChildByName("collectPower").active=!1,e.schedule(s,1/60)}),1.5)},n.usingSkillThousandsSwordToTomb=function(){for(var e=this,t=0;t<30;t++){var o=S.getFromPool("thousandsSwordToTomb");o?(this._thousandsSwordToTombQueue.enqueue(o),0===t&&this.schedule(this.createThousandsSwordToTomb,.3)):this.loadPrefab("thousandsSwordToTomb",(function(t){e._thousandsSwordToTombPrefab=t,S.addPoolToPools("thousandsSwordToTomb",new h,e._thousandsSwordToTombPrefab);var o=S.getFromPool("thousandsSwordToTomb");e._thousandsSwordToTombQueue.enqueue(o)}))}},n.createThousandsSwordToTomb=function(){if(!w.stopAll){var e=this._thousandsSwordToTombQueue.dequeue();e?this.initThousandsSwordToTomb(e):this.unschedule(this.createThousandsSwordToTomb)}},n.initThousandsSwordToTomb=function(e){var t=P.dispatch("usingHeroBasePropertyFun","getSkillBookDataByIdOrName","万剑归冢"),o={damage:t.baseDamage,duration:t.duration,moveDistance:1e3,name:t.name2},a=p("Canvas/bulletLayer");e.parent=a,e.getComponent("ThousandsSwordToTomb").init(o)},n.usingSkillIceCone=function(){for(var e=this,t=b.getCirclePos(20,20),o=function(){var o=S.getFromPool("iceCone"),r=t[a],i={x:r[0]/20,y:r[1]/20};o?e.initIceCone(o,i,r):e.loadPrefab("iceCone",(function(t){e._iceConePrefab=t,S.addPoolToPools("iceCone",new h,e._iceConePrefab);var o=S.getFromPool("iceCone");e.initIceCone(o,i,r)}))},a=0;a<20;a++)o()},n.initIceCone=function(e,t,o){var a=P.dispatch("usingHeroBasePropertyFun","getSkillBookDataByIdOrName","冰锥术"),r={damage:a.baseDamage,duration:a.duration,moveSpeed:600,canAttackTimes:1,name:a.name2},i=p("Canvas/bulletLayer"),n=P.dispatch("getHeroWorldPos");e.parent=i,e.setWorldPosition(n.x+o[0],n.y+o[1],n.z),e.getComponent("IceCone").init(r,t)},n.usingSkillFireBloom=function(){for(var e=this,t=0;t<60;t++){var o=S.getFromPool("fireBloom");o?(this._fireBloomQueue.enqueue(o),0===t&&this.schedule(this.createFireBloom,.2)):this.loadPrefab("fireBloom",(function(t){e._fireBloomPrefab=t,S.addPoolToPools("fireBloom",new h,e._fireBloomPrefab);var o=S.getFromPool("fireBloom");e._fireBloomQueue.enqueue(o)}))}},n.createFireBloom=function(){if(!w.stopAll){var e=this._fireBloomQueue.dequeue();if(e){var t=P.dispatch("usingHeroControlFun","getRandomPosNearHero"),o=p("Canvas/bulletLayer");e.parent=o,e.setWorldPosition(t.x,t.y,0),e.getComponent("FireBloom").init()}else this.unschedule(this.createFireBloom)}},n.usingSkillHellFire=function(){for(var e=this,t=0;t<20;t++){var o=S.getFromPool("hellFire");o?(this._hellFireQueue.enqueue(o),0===t&&this.schedule(this.createHellFire,1)):this.loadPrefab("hellFire",(function(t){e._hellFirePrefab=t,S.addPoolToPools("hellFire",new h,e._fireBloomPrefab);var o=S.getFromPool("hellFire");e._hellFireQueue.enqueue(o)}))}},n.createHellFire=function(){if(!w.stopAll){var e=this._hellFireQueue.dequeue();if(e){var t=P.dispatch("getHeroWorldPos"),o=p("Canvas/bulletLayer");e.parent=o,e.setWorldPosition(t.x,t.y+50,0),e.getComponent("HellFire").init()}else this.unschedule(this.createHellFire)}},n.usingSkillMoveLikeFire=function(){this.schedule(this.createMoveLikeFire,.2)},n.createMoveLikeFire=function(){var e=this;if(!w.stopAll){var t=S.getFromPool("moveLikeFire");if(t){var o=P.dispatch("getHeroWorldPos"),a=p("Canvas/bulletLayer");t.parent=a,t.setWorldPosition(o.x,o.y,0),t.getComponent("MoveLikeFire").init()}else this.loadPrefab("moveLikeFire",(function(t){e._moveLikeFirePrefab=t,S.addPoolToPools("moveLikeFire",new h,e._moveLikeFirePrefab);var o=S.getFromPool("moveLikeFire"),a=P.dispatch("getHeroWorldPos"),r=p("Canvas/bulletLayer");o.parent=r,o.setWorldPosition(a.x,a.y,0),o.getComponent("MoveLikeFire").init()}))}},t}(v)).prototype,"weaponDataJson",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=t(T.prototype,"btnNodes",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),H=t(T.prototype,"defaultMaterial",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=t(T.prototype,"guardUltimateSkillMaterial",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=T))||L));n._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});